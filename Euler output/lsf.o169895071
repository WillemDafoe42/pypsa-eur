INFO:pypsa.io:Imported network elec_s300_200_ec_lcopt_1H-noex.nc has buses, carriers, generators, lines, loads, storage_units
INFO:pypsa.io:Imported network elec_s300_200_ec_lcopt_1H-noex.nc has buses, carriers, generators, lines, loads, storage_units
INFO:numexpr.utils:Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
INFO:numexpr.utils:Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
carrier
CCGT          18120.910000
OCGT           8044.269704
biomass         839.020000
coal          28069.379795
lignite       20833.500000
nuclear       15788.438693
offwind-ac     1125.369769
offwind-dc     3359.069844
oil            3696.400000
onwind        47837.387673
ror            2907.579410
solar         43394.372511
Name: p_nom, dtype: float64
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.86s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Using license file /cluster/apps/nss/gurobi/9.1.1/x86_64/gurobi.lic
Set parameter TokenServer to value lic-gurobi.ethz.ch
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-l19mj8r_.lp
Reading time = 0.13 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0x8a0005e1
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [2e+00, 1e+01]
  RHS range        [4e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57098 rows and 22090 columns
Presolve time: 0.06s
Presolved: 3886 rows, 4767 columns, 23491 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.828e+04
 Factor NZ  : 6.435e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.205e+06 (less than 1 second per iteration)
 Threads    : 30

Barrier performed 0 iterations in 0.26 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with primal simplex
Solved in 5052 iterations and 0.26 seconds
Optimal objective  2.143996066e+07
INFO:pypsa.linopf:Optimization successful. Objective value: 2.14e+07
solve_redispatch_network.py:711: DeprecationWarning:

The default dtype for empty Series will be 'object' instead of 'float64' in a future version. Specify a dtype explicitly to silence this warning.

solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


all




all


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 3.26s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-yfct985o.lp
Reading time = 0.29 seconds
obj: 167880 rows, 80305 columns, 282380 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 167880 rows, 80305 columns and 282380 nonzeros
Model fingerprint: 0x227604cb
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [2e+00, 1e+01]
  RHS range        [4e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 154750 rows and 35722 columns
Presolve time: 0.18s
Presolved: 13130 rows, 44583 columns, 91727 nonzeros

Ordering time: 0.67s

Barrier statistics:
 AA' NZ     : 5.223e+04
 Factor NZ  : 8.292e+05 (roughly 30 MBytes of memory)
 Factor Ops : 1.610e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.72830557e+12 -2.04608906e+12  5.27e+04 1.80e-11  9.66e+08     1s
   1   3.74145688e+11 -1.23602168e+12  5.19e+03 2.17e-10  1.05e+08     1s
   2   3.86947010e+10 -3.50707331e+11  4.53e+02 2.33e-10  1.12e+07     1s
   3   9.73945587e+09 -4.67111459e+10  4.32e+01 2.04e-10  1.21e+06     1s
   4   5.79355213e+09 -2.10920352e+10  7.63e+00 1.52e-10  3.86e+05     1s
   5   2.78201416e+09 -1.10219866e+10  3.70e+00 5.12e-10  1.86e+05     1s
   6   4.22701214e+08 -1.91200339e+09  7.18e-01 7.49e-10  2.87e+04     1s
   7   2.33622621e+07 -5.04858948e+08  2.35e-03 2.47e-10  5.93e+03     1s
   8   1.87950540e+07 -2.08341302e+08  1.36e-03 1.30e-10  2.55e+03     1s
   9   1.03180942e+07 -5.67719548e+07  4.09e-04 1.30e-10  7.53e+02     1s
  10   7.12603578e+06 -2.37623071e+07  2.38e-04 1.01e-10  3.46e+02     1s
  11   2.95483541e+06 -5.76239016e+06  6.67e-05 7.15e-11  9.78e+01     1s
  12   1.68662094e+06 -2.25959133e+06  3.11e-05 5.82e-11  4.43e+01     2s
  13   1.00595525e+06 -6.66329450e+05  1.39e-05 2.91e-11  1.88e+01     2s
  14   7.62766017e+05 -1.27834737e+05  8.29e-06 5.82e-11  9.99e+00     2s
  15   5.25960614e+05  1.68218499e+05  3.09e-06 5.82e-11  4.01e+00     2s
  16   4.53693001e+05  2.75581086e+05  1.66e-06 2.91e-11  2.00e+00     2s
  17   4.11986989e+05  3.18896687e+05  8.70e-07 2.91e-11  1.04e+00     2s
  18   3.79718020e+05  3.47500887e+05  2.87e-07 5.82e-11  3.61e-01     2s
  19   3.71235016e+05  3.52598491e+05  1.47e-07 2.91e-11  2.09e-01     2s
  20   3.69987960e+05  3.54171549e+05  1.26e-07 2.91e-11  1.77e-01     2s
  21   3.67928342e+05  3.56475552e+05  9.18e-08 2.91e-11  1.28e-01     2s
  22   3.65693629e+05  3.58340058e+05  1.85e-07 2.91e-11  8.25e-02     2s
  23   3.64012758e+05  3.59814899e+05  5.98e-08 2.91e-11  4.71e-02     2s
  24   3.63220104e+05  3.60397550e+05  1.83e-07 2.91e-11  3.17e-02     2s
  25   3.63171760e+05  3.60746494e+05  1.73e-07 2.91e-11  2.72e-02     2s
  26   3.62931379e+05  3.61049130e+05  1.62e-07 2.91e-11  2.11e-02     2s
  27   3.62598545e+05  3.61723999e+05  8.10e-08 2.91e-11  9.81e-03     2s
  28   3.62574485e+05  3.62006976e+05  8.20e-08 2.91e-11  6.36e-03     2s
  29   3.62430916e+05  3.62184446e+05  8.12e-08 5.82e-11  2.76e-03     2s
  30   3.62362769e+05  3.62212915e+05  1.28e-07 2.91e-11  1.68e-03     2s
  31   3.62336061e+05  3.62241884e+05  1.51e-07 2.91e-11  1.06e-03     2s
  32   3.62323579e+05  3.62261405e+05  1.97e-07 2.91e-11  6.97e-04     2s
  33   3.62311918e+05  3.62281694e+05  1.43e-07 5.82e-11  3.39e-04     2s
  34   3.62300344e+05  3.62296035e+05  1.74e-07 2.91e-11  4.83e-05     2s
  35   3.62299599e+05  3.62299456e+05  1.80e-07 5.82e-11  1.60e-06     2s
  36   3.62299531e+05  3.62299527e+05  8.81e-09 2.91e-11  4.18e-08     2s
  37   3.62299528e+05  3.62299528e+05  1.71e-09 5.82e-11  1.34e-10     2s

Barrier solved model in 37 iterations and 2.41 seconds
Optimal objective 3.62299528e+05

Crossover log...

     673 DPushes remaining with DInf 0.0000000e+00                 2s
       0 DPushes remaining with DInf 0.0000000e+00                 3s

    1680 PPushes remaining with PInf 0.0000000e+00                 3s
       0 PPushes remaining with PInf 2.0000000e-06                 3s

  Push phase complete: Pinf 2.0000000e-06, Dinf 3.7416470e-10      3s

Iteration    Objective       Primal Inf.    Dual Inf.      Time
    2356    3.6229953e+05   1.000000e-06   0.000000e+00      3s
Extra simplex iterations after uncrush: 73
    2430    3.6229953e+05   0.000000e+00   0.000000e+00      3s

Solved with barrier
Solved in 2430 iterations and 2.98 seconds
Optimal objective  3.622995284e+05
INFO:pypsa.linopf:Optimization successful. Objective value: 3.62e+05
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.78s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-93q7bkg1.lp
Reading time = 0.11 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0x6feb4249
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [2e+00, 1e+01]
  RHS range        [4e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57048 rows and 22036 columns
Presolve time: 0.06s
Presolved: 3936 rows, 4821 columns, 23595 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.833e+04
 Factor NZ  : 6.453e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.199e+06 (less than 1 second per iteration)
 Threads    : 30

Barrier performed 0 iterations in 0.25 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with primal simplex
Solved in 4875 iterations and 0.25 seconds
Optimal objective  1.804025883e+07
INFO:pypsa.linopf:Optimization successful. Objective value: 1.80e+07
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


all




all


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 3.24s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-fdfbv0_a.lp
Reading time = 0.30 seconds
obj: 167880 rows, 80305 columns, 282380 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 167880 rows, 80305 columns and 282380 nonzeros
Model fingerprint: 0xb8ad6bfc
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [2e+00, 1e+01]
  RHS range        [4e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 154248 rows and 35507 columns
Presolve time: 0.16s
Presolved: 13632 rows, 44798 columns, 92444 nonzeros

Ordering time: 0.63s

Barrier statistics:
 AA' NZ     : 5.273e+04
 Factor NZ  : 8.364e+05 (roughly 30 MBytes of memory)
 Factor Ops : 1.557e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.72334540e+12 -2.04932606e+12  5.27e+04 1.80e-11  9.65e+08     1s
   1   3.74755584e+11 -1.23383109e+12  5.33e+03 1.93e-10  1.08e+08     1s
   2   3.31961494e+10 -3.73644551e+11  3.95e+02 2.04e-10  1.06e+07     1s
   3   8.79538073e+09 -5.07808892e+10  3.65e+01 2.04e-09  1.15e+06     1s
   4   5.62346188e+09 -2.13364904e+10  8.53e+00 9.31e-10  3.93e+05     1s
   5   2.04491476e+09 -1.54887503e+10  3.22e+00 1.17e-09  2.26e+05     1s
   6   3.36324857e+08 -3.16583080e+09  6.59e-01 1.14e-09  4.17e+04     1s
   7   2.57689421e+07 -5.89975678e+08  1.70e-03 2.76e-10  6.88e+03     1s
   8   2.23088137e+07 -2.80721933e+08  1.18e-03 3.04e-10  3.38e+03     1s
   9   1.23056487e+07 -8.51384438e+07  2.62e-04 3.04e-10  1.09e+03     1s
  10   8.15693100e+06 -3.09885363e+07  1.38e-04 1.30e-10  4.37e+02     2s
  11   4.12318380e+06 -1.35733614e+07  5.07e-05 1.01e-10  1.98e+02     2s
  12   2.39887363e+06 -4.27009125e+06  1.81e-05 5.82e-11  7.44e+01     2s
  13   1.65742388e+06 -1.61395751e+06  6.44e-06 5.82e-11  3.65e+01     2s
  14   1.54507338e+06 -5.83846792e+05  4.91e-06 5.82e-11  2.38e+01     2s
  15   1.27996637e+06  3.66848431e+05  1.44e-06 5.82e-11  1.02e+01     2s
  16   1.24335743e+06  4.97997771e+05  1.04e-06 2.91e-11  8.32e+00     2s
  17   1.17378675e+06  8.72060864e+05  2.96e-07 5.82e-11  3.37e+00     2s
  18   1.14007637e+06  1.06235730e+06  5.07e-08 5.82e-11  8.67e-01     2s
  19   1.12895612e+06  1.10241832e+06  1.42e-08 5.82e-11  2.96e-01     2s
  20   1.12550751e+06  1.11159759e+06  7.72e-09 2.91e-11  1.55e-01     2s
  21   1.12436905e+06  1.11554338e+06  6.72e-09 2.91e-11  9.85e-02     2s
  22   1.12384745e+06  1.11829476e+06  1.19e-08 5.82e-11  6.20e-02     2s
  23   1.12288885e+06  1.11945958e+06  7.01e-08 2.91e-11  3.83e-02     2s
  24   1.12243063e+06  1.12048658e+06  7.75e-08 2.91e-11  2.17e-02     2s
  25   1.12227616e+06  1.12070121e+06  5.03e-08 2.91e-11  1.76e-02     2s
  26   1.12213109e+06  1.12105686e+06  8.17e-08 2.91e-11  1.20e-02     2s
  27   1.12205266e+06  1.12124567e+06  1.94e-07 2.91e-11  9.01e-03     2s
  28   1.12181541e+06  1.12128709e+06  2.66e-07 2.91e-11  5.90e-03     2s
  29   1.12172151e+06  1.12137970e+06  2.74e-07 2.91e-11  3.81e-03     3s
  30   1.12164671e+06  1.12146198e+06  2.14e-07 5.82e-11  2.06e-03     3s
  31   1.12159839e+06  1.12149155e+06  2.40e-07 2.91e-11  1.19e-03     3s
  32   1.12157154e+06  1.12150607e+06  1.29e-07 2.91e-11  7.31e-04     3s
  33   1.12155849e+06  1.12151311e+06  4.91e-07 2.91e-11  5.06e-04     3s
  34   1.12154691e+06  1.12151685e+06  4.56e-06 2.91e-11  3.35e-04     3s
  35   1.12153981e+06  1.12152255e+06  5.39e-06 5.82e-11  1.93e-04     3s
  36   1.12153425e+06  1.12152421e+06  4.21e-06 2.91e-11  1.12e-04     3s
  37   1.12152874e+06  1.12152558e+06  9.00e-06 2.91e-11  3.53e-05     3s
  38   1.12152674e+06  1.12152617e+06  3.48e-06 5.82e-11  6.47e-06     3s
  39   1.12152623e+06  1.12152624e+06  3.36e-06 2.91e-11  7.48e-08     3s
  40   1.12152624e+06  1.12152624e+06  3.81e-07 5.82e-11  8.08e-09     3s

Barrier solved model in 40 iterations and 3.13 seconds
Optimal objective 1.12152624e+06

Crossover log...

    3350 DPushes remaining with DInf 0.0000000e+00                 3s
       0 DPushes remaining with DInf 0.0000000e+00                 4s

     400 PPushes remaining with PInf 0.0000000e+00                 4s
       0 PPushes remaining with PInf 0.0000000e+00                 4s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.1206360e-09      4s

Iteration    Objective       Primal Inf.    Dual Inf.      Time
    3753    1.1215262e+06   0.000000e+00   0.000000e+00      4s

Solved with barrier
Solved in 3753 iterations and 3.88 seconds
Optimal objective  1.121526243e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 1.12e+06
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.79s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-kywwdecy.lp
Reading time = 0.12 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0x293a9fa6
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [2e+00, 1e+01]
  RHS range        [4e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57048 rows and 22035 columns
Presolve time: 0.05s
Presolved: 3936 rows, 4822 columns, 23596 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.833e+04
 Factor NZ  : 6.453e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.199e+06 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   5.57688016e+07 -2.23125074e+09  2.04e+04 1.14e-13  9.77e+05     0s
   1   3.17826291e+07 -1.05630489e+09  2.35e+03 3.41e-13  1.68e+05     0s
   2   2.67003585e+07 -1.44119320e+08  2.35e+02 2.84e-13  2.00e+04     0s
   3   2.50766130e+07  7.79425188e+06  2.39e+01 2.27e-13  1.89e+03     0s
   4   2.47132432e+07  2.00227797e+07  4.39e+00 7.96e-13  4.93e+02     0s
   5   2.45614289e+07  2.19215930e+07  1.62e+00 4.55e-13  2.75e+02     0s

Barrier performed 5 iterations in 0.20 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with primal simplex
Solved in 5097 iterations and 0.20 seconds
Optimal objective  2.437006807e+07
INFO:pypsa.linopf:Optimization successful. Objective value: 2.44e+07
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


all




all


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 3.43s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-3dn9mmgy.lp
Reading time = 0.34 seconds
obj: 167880 rows, 80305 columns, 282380 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 167880 rows, 80305 columns and 282380 nonzeros
Model fingerprint: 0x35b61fb4
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [2e+00, 1e+01]
  RHS range        [4e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 154248 rows and 34315 columns
Presolve time: 0.20s
Presolved: 13632 rows, 45990 columns, 93636 nonzeros

Ordering time: 0.49s

Barrier statistics:
 AA' NZ     : 5.273e+04
 Factor NZ  : 8.364e+05 (roughly 30 MBytes of memory)
 Factor Ops : 1.557e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.72243161e+12 -1.96764197e+12  5.66e+04 1.20e+04  9.29e+08     1s
   1   3.84117070e+11 -1.20388254e+12  6.07e+03 5.49e+02  1.08e+08     1s
   2   3.38754187e+10 -3.73843065e+11  4.39e+02 2.04e-10  1.04e+07     1s
   3   1.02187402e+10 -5.00247371e+10  5.48e+01 4.13e-09  1.31e+06     1s
   4   4.86682261e+09 -1.86465143e+10  1.68e+01 8.44e-10  4.17e+05     1s
   5   1.47933552e+09 -6.13353413e+09  5.45e+00 1.75e-10  1.19e+05     1s
   6   2.69881612e+08 -2.47804109e+09  1.03e+00 1.34e-10  3.42e+04     1s
   7   1.65648581e+08 -7.83087465e+08  6.16e-01 1.59e-10  1.16e+04     1s
   8   9.54069506e+07 -4.08804689e+08  3.20e-01 1.30e-10  5.94e+03     1s
   9   4.78054141e+07 -2.25043106e+08  1.33e-01 1.01e-10  3.11e+03     1s
  10   3.51794996e+07 -1.21585408e+08  8.88e-02 1.01e-10  1.78e+03     1s
  11   1.56403007e+07 -5.88526432e+07  2.61e-02 1.30e-10  8.25e+02     1s
  12   1.18082403e+07 -3.67765930e+07  1.67e-02 1.01e-10  5.36e+02     1s
  13   6.91326325e+06 -9.84087703e+06  5.88e-03 1.01e-10  1.84e+02     1s
  14   5.38572470e+06 -3.91011844e+06  3.21e-03 7.15e-11  1.02e+02     2s
  15   4.30944418e+06 -1.15617524e+06  1.53e-03 5.70e-11  5.96e+01     2s
  16   3.89671287e+06  2.42620998e+05  9.59e-04 4.24e-11  3.98e+01     2s
  17   3.65271355e+06  1.70616487e+06  6.44e-04 2.91e-11  2.12e+01     2s
  18   3.46710688e+06  2.25460625e+06  4.17e-04 2.91e-11  1.32e+01     2s
  19   3.34785340e+06  2.34786819e+06  2.80e-04 2.91e-11  1.09e+01     2s
  20   3.27339713e+06  2.55616137e+06  1.96e-04 2.91e-11  7.80e+00     2s
  21   3.21085057e+06  2.84297012e+06  1.28e-04 5.82e-11  4.00e+00     2s
  22   3.14836921e+06  2.98673450e+06  6.55e-05 2.91e-11  1.76e+00     2s
  23   3.11242245e+06  3.04182809e+06  3.21e-05 5.82e-11  7.68e-01     2s
  24   3.09178446e+06  3.05844746e+06  1.47e-05 2.91e-11  3.63e-01     2s
  25   3.08271523e+06  3.06474043e+06  7.55e-06 2.91e-11  1.95e-01     2s
  26   3.07829563e+06  3.06922154e+06  4.18e-06 2.91e-11  9.87e-02     2s
  27   3.07574129e+06  3.07132817e+06  2.29e-06 2.91e-11  4.80e-02     2s
  28   3.07337196e+06  3.07207259e+06  5.80e-07 2.91e-11  1.41e-02     2s
  29   3.07279913e+06  3.07235422e+06  1.81e-07 2.91e-11  4.84e-03     2s
  30   3.07258736e+06  3.07249153e+06  4.32e-08 2.91e-11  1.04e-03     2s
  31   3.07254675e+06  3.07250631e+06  2.52e-08 2.91e-11  4.40e-04     2s
  32   3.07252228e+06  3.07251478e+06  4.11e-07 5.82e-11  8.16e-05     2s
  33   3.07251806e+06  3.07251669e+06  7.81e-08 2.91e-11  1.49e-05     2s
  34   3.07251712e+06  3.07251709e+06  8.06e-09 5.82e-11  2.89e-07     2s
  35   3.07251711e+06  3.07251711e+06  1.16e-09 8.73e-11  2.48e-08     3s
  36   3.07251711e+06  3.07251711e+06  2.32e-09 5.82e-11  3.32e-09     3s

Barrier solved model in 36 iterations and 2.64 seconds
Optimal objective 3.07251711e+06

Crossover log...

    2437 DPushes remaining with DInf 0.0000000e+00                 3s
       0 DPushes remaining with DInf 0.0000000e+00                 3s

     442 PPushes remaining with PInf 7.0000000e-06                 3s
       0 PPushes remaining with PInf 7.0000000e-06                 3s

  Push phase complete: Pinf 7.0000000e-06, Dinf 3.0325298e-10      3s

Iteration    Objective       Primal Inf.    Dual Inf.      Time
    2882    3.0725171e+06   6.000000e-06   0.000000e+00      3s
Extra simplex iterations after uncrush: 25
    2911    3.0725171e+06   0.000000e+00   0.000000e+00      3s

Solved with barrier
Solved in 2911 iterations and 2.93 seconds
Optimal objective  3.072517107e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 3.07e+06
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.76s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-bswy5x32.lp
Reading time = 0.11 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0x69ca2654
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [2e+00, 1e+01]
  RHS range        [4e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57048 rows and 22036 columns
Presolve time: 0.11s
Presolved: 3936 rows, 4821 columns, 23595 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.833e+04
 Factor NZ  : 6.453e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.199e+06 (less than 1 second per iteration)
 Threads    : 30

Barrier performed 0 iterations in 0.25 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with dual simplex
Solved in 2829 iterations and 0.25 seconds
Optimal objective  2.777861522e+07
INFO:pypsa.linopf:Optimization successful. Objective value: 2.78e+07
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


all




all


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 3.24s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-123meqm2.lp
Reading time = 0.30 seconds
obj: 167880 rows, 80305 columns, 282380 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 167880 rows, 80305 columns and 282380 nonzeros
Model fingerprint: 0x57e7017c
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [2e+00, 1e+01]
  RHS range        [4e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 154262 rows and 35730 columns
Presolve time: 0.15s
Presolved: 13618 rows, 44575 columns, 92207 nonzeros

Ordering time: 0.35s

Barrier statistics:
 AA' NZ     : 5.272e+04
 Factor NZ  : 8.351e+05 (roughly 30 MBytes of memory)
 Factor Ops : 1.617e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.71663872e+12 -2.02501892e+12  5.15e+04 2.78e-11  9.66e+08     1s
   1   3.63669202e+11 -1.24621177e+12  5.19e+03 2.11e-10  1.08e+08     1s
   2   3.38434398e+10 -3.81064965e+11  3.85e+02 2.04e-10  1.06e+07     1s
   3   1.01140956e+10 -4.36041307e+10  3.29e+01 7.86e-10  1.04e+06     1s
   4   5.30656334e+09 -1.65194248e+10  9.84e+00 1.16e-09  3.49e+05     1s
   5   2.84334759e+09 -8.18237570e+09  5.08e+00 1.88e-10  1.63e+05     1s
   6   4.19386745e+08 -3.31509305e+09  9.62e-01 2.40e-10  4.68e+04     1s
   7   1.74539424e+08 -1.40147028e+09  3.92e-01 1.59e-10  1.88e+04     1s
   8   6.82453305e+07 -5.06708400e+08  1.09e-01 1.51e-10  6.63e+03     1s
   9   3.90975372e+07 -2.58576689e+08  4.75e-02 1.30e-10  3.39e+03     1s
  10   3.12587881e+07 -1.11775088e+08  3.40e-02 1.01e-10  1.63e+03     1s
  11   1.54901552e+07 -4.22488152e+07  1.06e-02 1.02e-10  6.53e+02     1s
  12   1.29390731e+07 -2.35146744e+07  7.88e-03 1.02e-10  4.12e+02     1s
  13   8.88185118e+06 -1.28115204e+07  3.97e-03 1.02e-10  2.44e+02     1s
  14   7.27997053e+06 -5.67498989e+06  2.61e-03 7.15e-11  1.46e+02     1s
  15   6.25805323e+06  7.99283873e+04  1.82e-03 4.95e-11  6.95e+01     2s
  16   4.98071662e+06  6.37011288e+05  8.95e-04 4.95e-11  4.88e+01     2s
  17   4.33387610e+06  1.90084024e+06  4.46e-04 2.91e-11  2.73e+01     2s
  18   3.82209092e+06  2.99690405e+06  9.78e-05 5.82e-11  9.26e+00     2s
  19   3.71641828e+06  3.34682666e+06  3.94e-05 5.82e-11  4.15e+00     2s
  20   3.66529186e+06  3.50371108e+06  1.56e-05 5.82e-11  1.81e+00     2s
  21   3.64294097e+06  3.55598938e+06  6.64e-06 2.91e-11  9.75e-01     2s
  22   3.63319430e+06  3.58845223e+06  3.20e-06 2.91e-11  5.02e-01     2s
  23   3.62786520e+06  3.60688438e+06  1.56e-06 2.91e-11  2.35e-01     2s
  24   3.62432174e+06  3.61389391e+06  5.82e-07 2.91e-11  1.17e-01     2s
  25   3.62306961e+06  3.61851100e+06  2.74e-07 2.91e-11  5.11e-02     2s
  26   3.62218532e+06  3.62038805e+06  7.86e-08 2.91e-11  2.02e-02     2s
  27   3.62201218e+06  3.62095839e+06  4.89e-08 2.91e-11  1.18e-02     2s
  28   3.62182097e+06  3.62130936e+06  2.67e-08 2.91e-11  5.74e-03     2s
  29   3.62177814e+06  3.62159159e+06  1.05e-08 5.82e-11  2.09e-03     2s
  30   3.62176136e+06  3.62172740e+06  1.99e-08 5.82e-11  3.81e-04     2s
  31   3.62175731e+06  3.62174719e+06  1.51e-08 5.82e-11  1.14e-04     2s
  32   3.62175587e+06  3.62175282e+06  1.97e-08 2.91e-11  3.43e-05     3s
  33   3.62175570e+06  3.62175507e+06  6.56e-09 5.82e-11  7.13e-06     3s
  34   3.62175564e+06  3.62175553e+06  3.44e-09 5.82e-11  1.14e-06     3s
  35   3.62175560e+06  3.62175559e+06  3.30e-09 5.82e-11  6.69e-08     3s
  36   3.62175559e+06  3.62175559e+06  3.43e-09 5.82e-11  1.35e-08     3s
  37   3.62175559e+06  3.62175559e+06  1.70e-09 2.91e-11  3.72e-09     3s

Barrier solved model in 37 iterations and 2.88 seconds
Optimal objective 3.62175559e+06

Crossover log...

    1712 DPushes remaining with DInf 0.0000000e+00                 3s

Solved with dual simplex
Solved in 13712 iterations and 3.20 seconds
Optimal objective  3.621755593e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 3.62e+06
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.75s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-846v5efk.lp
Reading time = 0.11 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0x87ee401a
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [2e+00, 1e+01]
  RHS range        [4e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57048 rows and 22031 columns
Presolve time: 0.05s
Presolved: 3936 rows, 4826 columns, 23600 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.833e+04
 Factor NZ  : 6.453e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.199e+06 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   4.04451408e+07 -1.92993269e+09  2.06e+04 5.68e-14  8.50e+05     0s
   1   2.23337465e+07 -9.20756371e+08  2.11e+03 2.84e-13  1.40e+05     0s

Barrier performed 1 iterations in 0.21 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with dual simplex
Solved in 2703 iterations and 0.21 seconds
Optimal objective  1.789941164e+07
INFO:pypsa.linopf:Optimization successful. Objective value: 1.79e+07
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


all




all


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 3.22s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-bso8pwby.lp
Reading time = 0.29 seconds
obj: 167880 rows, 80305 columns, 282380 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 167880 rows, 80305 columns and 282380 nonzeros
Model fingerprint: 0xc573a4aa
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [2e+00, 1e+01]
  RHS range        [4e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 154254 rows and 34666 columns
Presolve time: 0.15s
Presolved: 13626 rows, 45639 columns, 93279 nonzeros

Ordering time: 0.46s

Barrier statistics:
 AA' NZ     : 5.273e+04
 Factor NZ  : 8.425e+05 (roughly 30 MBytes of memory)
 Factor Ops : 1.606e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.71490466e+12 -1.98178915e+12  5.67e+04 1.08e+04  9.44e+08     1s
   1   3.79638038e+11 -1.22265077e+12  6.05e+03 2.04e-10  1.10e+08     1s
   2   3.36008833e+10 -3.80689155e+11  4.34e+02 2.04e-10  1.05e+07     1s
   3   1.03218748e+10 -5.35526641e+10  4.98e+01 6.98e-10  1.30e+06     1s
   4   5.30763016e+09 -1.87187691e+10  1.63e+01 2.04e-10  4.17e+05     1s
   5   2.20633265e+09 -7.58587683e+09  7.03e+00 1.75e-10  1.55e+05     1s
   6   5.57910140e+08 -3.81208084e+09  1.98e+00 1.59e-10  5.76e+04     1s
   7   1.99623104e+08 -1.53713575e+09  7.11e-01 1.59e-10  2.10e+04     1s
   8   1.54702742e+08 -9.39078949e+08  5.26e-01 1.30e-10  1.31e+04     1s
   9   6.08299627e+07 -3.82868941e+08  1.41e-01 1.30e-10  5.04e+03     1s
  10   3.83642248e+07 -2.13778581e+08  6.37e-02 1.01e-10  2.82e+03     1s
  11   2.53879961e+07 -1.02562703e+08  2.80e-02 1.01e-10  1.42e+03     1s
  12   2.11307378e+07 -5.65619226e+07  1.96e-02 1.30e-10  8.60e+02     1s
  13   1.62024835e+07 -2.32959902e+07  1.11e-02 1.01e-10  4.36e+02     1s
  14   1.36609996e+07 -1.20645766e+07  7.41e-03 7.15e-11  2.84e+02     1s
  15   1.20290809e+07 -2.47891371e+06  5.36e-03 5.70e-11  1.60e+02     1s
  16   1.10039843e+07  1.05463423e+06  4.08e-03 5.70e-11  1.09e+02     2s
  17   1.00318380e+07  3.22204393e+06  2.97e-03 4.24e-11  7.49e+01     2s
  18   9.14146507e+06  4.01069944e+06  1.96e-03 4.24e-11  5.64e+01     2s
  19   8.73802848e+06  5.11839209e+06  1.52e-03 2.79e-11  3.97e+01     2s
  20   8.51737439e+06  5.81681913e+06  1.28e-03 2.06e-11  2.96e+01     2s
  21   7.89262715e+06  6.28611176e+06  5.70e-04 2.06e-11  1.76e+01     2s
  22   7.75363422e+06  6.83410805e+06  4.22e-04 2.91e-11  1.01e+01     2s
  23   7.60931417e+06  6.98132642e+06  2.71e-04 1.46e-11  6.88e+00     2s
  24   7.49037282e+06  7.12679181e+06  1.50e-04 2.91e-11  3.98e+00     2s
  25   7.44963521e+06  7.21896804e+06  1.11e-04 1.46e-11  2.53e+00     2s
  26   7.41221528e+06  7.25792811e+06  7.63e-05 1.46e-11  1.69e+00     2s
  27   7.37490691e+06  7.29544195e+06  4.27e-05 1.46e-11  8.71e-01     2s
  28   7.36068940e+06  7.30651882e+06  3.05e-05 1.46e-11  5.94e-01     2s
  29   7.35253414e+06  7.31371119e+06  2.36e-05 1.46e-11  4.25e-01     2s
  30   7.34124270e+06  7.31819744e+06  1.45e-05 1.46e-11  2.53e-01     2s
  31   7.33700807e+06  7.31992583e+06  1.09e-05 2.91e-11  1.87e-01     2s
  32   7.33285967e+06  7.32130536e+06  7.71e-06 2.91e-11  1.27e-01     2s
  33   7.32903345e+06  7.32224355e+06  4.35e-06 2.91e-11  7.44e-02     2s
  34   7.32622694e+06  7.32304985e+06  1.89e-06 2.91e-11  3.48e-02     2s
  35   7.32476621e+06  7.32350071e+06  6.71e-07 2.91e-11  1.39e-02     2s
  36   7.32415236e+06  7.32373541e+06  1.77e-07 2.91e-11  4.57e-03     3s
  37   7.32397585e+06  7.32386381e+06  4.78e-08 2.91e-11  1.23e-03     3s
  38   7.32393122e+06  7.32389496e+06  1.99e-08 5.82e-11  3.97e-04     3s
  39   7.32391010e+06  7.32390326e+06  5.06e-08 5.82e-11  7.50e-05     3s
  40   7.32390657e+06  7.32390536e+06  1.12e-08 2.91e-11  1.32e-05     3s
  41   7.32390581e+06  7.32390575e+06  8.56e-10 5.82e-11  5.96e-07     3s
  42   7.32390578e+06  7.32390576e+06  3.20e-10 5.82e-11  2.23e-07     3s
  43   7.32390576e+06  7.32390576e+06  3.89e-09 8.73e-11  2.35e-08     3s
  44   7.32390576e+06  7.32390576e+06  1.40e-09 5.82e-11  6.34e-09     3s

Barrier solved model in 44 iterations and 2.91 seconds
Optimal objective 7.32390576e+06

Crossover log...

    1864 DPushes remaining with DInf 0.0000000e+00                 3s
       0 DPushes remaining with DInf 0.0000000e+00                 3s

     305 PPushes remaining with PInf 2.8000000e-05                 3s
       0 PPushes remaining with PInf 2.8000000e-05                 4s

  Push phase complete: Pinf 2.8000000e-05, Dinf 7.0992556e-10      4s

Iteration    Objective       Primal Inf.    Dual Inf.      Time
    2172    7.3239058e+06   2.300000e-05   0.000000e+00      4s
Extra simplex iterations after uncrush: 74
    2260    7.3239058e+06   0.000000e+00   0.000000e+00      4s

Solved with barrier
Solved in 2260 iterations and 3.90 seconds
Optimal objective  7.323905762e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 7.32e+06
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.74s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-u00gzn6_.lp
Reading time = 0.11 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0x781859ea
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [2e+00, 1e+01]
  RHS range        [4e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57059 rows and 22030 columns
Presolve time: 0.07s
Presolved: 3925 rows, 4827 columns, 23590 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.832e+04
 Factor NZ  : 6.462e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.206e+06 (less than 1 second per iteration)
 Threads    : 30

Barrier performed 0 iterations in 0.23 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with primal simplex
Solved in 5473 iterations and 0.23 seconds
Optimal objective  1.198702105e+07
INFO:pypsa.linopf:Optimization successful. Objective value: 1.20e+07
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


all




all


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 3.23s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-erbcg6hg.lp
Reading time = 0.29 seconds
obj: 167880 rows, 80305 columns, 282380 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 167880 rows, 80305 columns and 282380 nonzeros
Model fingerprint: 0xa9fd3faa
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [2e+00, 1e+01]
  RHS range        [1e-06, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 154276 rows and 34904 columns
Presolve time: 0.18s
Presolved: 13604 rows, 45401 columns, 93019 nonzeros

Ordering time: 0.56s

Barrier statistics:
 AA' NZ     : 5.271e+04
 Factor NZ  : 8.476e+05 (roughly 30 MBytes of memory)
 Factor Ops : 1.656e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.71979523e+12 -1.98268148e+12  5.80e+04 1.08e+04  9.29e+08     1s
   1   3.76645469e+11 -1.20279844e+12  6.21e+03 2.41e+02  1.08e+08     1s
   2   3.31622542e+10 -3.75199197e+11  4.45e+02 2.33e-10  1.04e+07     1s
   3   1.02747684e+10 -5.69800478e+10  5.79e+01 1.75e-10  1.40e+06     1s
   4   6.56069740e+09 -2.00828938e+10  2.07e+01 2.91e-10  4.82e+05     1s
   5   2.95604448e+09 -8.21916014e+09  9.54e+00 2.33e-10  1.88e+05     1s
   6   9.07228502e+08 -4.15009667e+09  3.31e+00 1.75e-10  7.24e+04     1s
   7   2.42409703e+08 -1.25659740e+09  8.90e-01 1.56e-10  1.88e+04     1s
   8   1.07889794e+08 -4.74982761e+08  3.32e-01 1.36e-10  6.92e+03     1s
   9   5.43266615e+07 -1.41682514e+08  1.23e-01 1.27e-10  2.27e+03     2s
  10   4.04104813e+07 -8.97980005e+07  7.86e-02 1.27e-10  1.49e+03     2s
  11   2.74414873e+07 -4.03854039e+07  4.03e-02 9.81e-11  7.69e+02     2s
  12   2.28075097e+07 -2.02517858e+07  2.84e-02 9.81e-11  4.86e+02     2s
  13   1.82927551e+07 -6.68274519e+06  1.75e-02 9.81e-11  2.81e+02     2s
  14   1.61318740e+07  1.01452044e+06  1.25e-02 7.79e-11  1.69e+02     2s
  15   1.42891002e+07  5.65211640e+06  8.53e-03 7.79e-11  9.65e+01     2s
  16   1.32609412e+07  7.44209062e+06  6.26e-03 5.44e-11  6.48e+01     2s
  17   1.28746211e+07  7.94523614e+06  5.42e-03 4.88e-11  5.48e+01     2s
  18   1.18022055e+07  8.90203907e+06  3.31e-03 3.98e-11  3.22e+01     2s
  19   1.11788023e+07  9.27252136e+06  1.89e-03 3.98e-11  2.11e+01     2s
  20   1.10680865e+07  9.42426058e+06  1.65e-03 3.98e-11  1.82e+01     2s
  21   1.09156054e+07  9.59769441e+06  1.30e-03 3.43e-11  1.46e+01     2s
  22   1.07780896e+07  9.87537258e+06  1.01e-03 1.97e-11  9.97e+00     2s
  23   1.05312802e+07  1.00665846e+07  4.67e-04 1.80e-11  5.13e+00     2s
  24   1.05028056e+07  1.01878939e+07  4.06e-04 2.91e-11  3.47e+00     2s
  25   1.04290629e+07  1.02469878e+07  2.55e-04 1.46e-11  2.01e+00     2s
  26   1.04000900e+07  1.02561616e+07  1.96e-04 2.18e-11  1.59e+00     2s
  27   1.03819857e+07  1.02667885e+07  1.60e-04 1.46e-11  1.27e+00     2s
  28   1.03761942e+07  1.02728737e+07  1.49e-04 2.91e-11  1.14e+00     2s
  29   1.03529271e+07  1.02782701e+07  1.03e-04 1.46e-11  8.23e-01     2s
  30   1.03511069e+07  1.02849385e+07  1.00e-04 1.46e-11  7.29e-01     2s
  31   1.03385753e+07  1.02875577e+07  7.72e-05 1.46e-11  5.62e-01     2s
  32   1.03217262e+07  1.02931997e+07  4.54e-05 1.46e-11  3.14e-01     2s
  33   1.03131436e+07  1.02944786e+07  2.82e-05 1.46e-11  2.06e-01     2s
  34   1.03053289e+07  1.02968342e+07  1.25e-05 1.46e-11  9.36e-02     2s
  35   1.03037529e+07  1.02976558e+07  9.34e-06 1.46e-11  6.72e-02     2s
  36   1.03015202e+07  1.02981242e+07  4.98e-06 1.46e-11  3.74e-02     2s
  37   1.02997628e+07  1.02984976e+07  1.62e-06 2.91e-11  1.39e-02     2s
  38   1.02992014e+07  1.02987475e+07  5.60e-07 2.91e-11  5.00e-03     2s
  39   1.02989959e+07  1.02988408e+07  1.87e-07 2.91e-11  1.71e-03     3s
  40   1.02989211e+07  1.02988689e+07  9.86e-08 2.91e-11  5.75e-04     3s
  41   1.02988904e+07  1.02988847e+07  8.11e-08 5.82e-11  6.27e-05     3s
  42   1.02988875e+07  1.02988862e+07  1.90e-08 5.82e-11  1.41e-05     3s
  43   1.02988866e+07  1.02988865e+07  3.39e-09 5.82e-11  1.40e-06     3s
  44   1.02988865e+07  1.02988865e+07  4.15e-09 5.82e-11  1.89e-07     3s
  45   1.02988865e+07  1.02988865e+07  1.48e-07 5.82e-11  9.75e-08     3s

Barrier solved model in 45 iterations and 2.76 seconds
Optimal objective 1.02988865e+07

Crossover log...

    1477 DPushes remaining with DInf 0.0000000e+00                 3s
       0 DPushes remaining with DInf 0.0000000e+00                 3s

    1016 PPushes remaining with PInf 4.1000000e-05                 3s
       0 PPushes remaining with PInf 4.6000000e-05                 3s

  Push phase complete: Pinf 4.6000000e-05, Dinf 4.7959321e-10      3s

Iteration    Objective       Primal Inf.    Dual Inf.      Time
    2496    1.0298887e+07   4.000000e-05   0.000000e+00      3s
Extra simplex iterations after uncrush: 118
    2632    1.0298887e+07   0.000000e+00   0.000000e+00      3s

Solved with barrier
Solved in 2632 iterations and 3.20 seconds
Optimal objective  1.029888651e+07
INFO:pypsa.linopf:Optimization successful. Objective value: 1.03e+07
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.74s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-08wp9042.lp
Reading time = 0.11 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0x09304dfc
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [2e+00, 1e+01]
  RHS range        [4e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57048 rows and 22031 columns
Presolve time: 0.05s
Presolved: 3936 rows, 4826 columns, 23600 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.833e+04
 Factor NZ  : 6.453e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.199e+06 (less than 1 second per iteration)
 Threads    : 30

Barrier performed 0 iterations in 0.20 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with primal simplex
Solved in 4854 iterations and 0.20 seconds
Optimal objective  1.885651231e+07
INFO:pypsa.linopf:Optimization successful. Objective value: 1.89e+07
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


all




all


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 3.24s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-oevu66os.lp
Reading time = 0.29 seconds
obj: 167880 rows, 80305 columns, 282380 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 167880 rows, 80305 columns and 282380 nonzeros
Model fingerprint: 0xb2baff6f
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [2e+00, 1e+01]
  RHS range        [1e-06, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 154249 rows and 34646 columns
Presolve time: 0.16s
Presolved: 13631 rows, 45659 columns, 93304 nonzeros

Ordering time: 0.69s

Barrier statistics:
 AA' NZ     : 5.273e+04
 Factor NZ  : 8.583e+05 (roughly 30 MBytes of memory)
 Factor Ops : 1.663e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.23918235e+12 -1.98971404e+12  3.73e+04 1.13e+04  6.63e+08     1s
   1   2.88584043e+11 -1.12417493e+12  4.38e+03 3.97e+03  8.56e+07     1s
   2   3.28677426e+10 -2.83343227e+11  3.98e+02 1.75e-10  9.16e+06     1s
   3   9.77869169e+09 -3.96169977e+10  4.27e+01 4.66e-10  1.07e+06     2s
   4   4.28408325e+09 -1.53465522e+10  1.05e+01 2.91e-10  3.19e+05     2s
   5   1.53823552e+09 -6.28423473e+09  4.31e+00 1.75e-10  1.16e+05     2s
   6   3.97256652e+08 -3.26135463e+09  1.13e+00 1.30e-10  4.55e+04     2s
   7   1.68916792e+08 -1.26230018e+09  4.63e-01 1.30e-10  1.69e+04     2s
   8   8.69338679e+07 -6.06789408e+08  1.93e-01 1.30e-10  7.92e+03     2s
   9   4.69043696e+07 -2.51318423e+08  7.53e-02 1.30e-10  3.34e+03     2s
  10   3.73030563e+07 -1.77773214e+08  5.30e-02 1.01e-10  2.40e+03     2s
  11   2.78903447e+07 -8.18038138e+07  3.33e-02 1.30e-10  1.22e+03     2s
  12   2.20815496e+07 -4.95430402e+07  2.27e-02 1.01e-10  7.95e+02     2s
  13   1.80759134e+07 -2.47151013e+07  1.59e-02 1.01e-10  4.74e+02     2s
  14   1.49331200e+07 -1.35379111e+07  1.09e-02 7.15e-11  3.15e+02     2s
  15   1.21791528e+07 -5.90807274e+06  6.86e-03 1.01e-10  1.99e+02     2s
  16   1.13505149e+07 -1.41601352e+06  5.69e-03 7.79e-11  1.41e+02     2s
  17   9.39565640e+06  1.47230863e+06  3.11e-03 5.70e-11  8.71e+01     3s
  18   8.76420444e+06  3.20932753e+06  2.35e-03 4.24e-11  6.10e+01     3s
  19   8.27688882e+06  4.68290829e+06  1.75e-03 2.79e-11  3.95e+01     3s
  20   7.91258724e+06  5.45835549e+06  1.27e-03 1.97e-11  2.69e+01     3s
  21   7.66637291e+06  6.04851554e+06  9.62e-04 1.97e-11  1.77e+01     3s
  22   7.41120861e+06  6.41450524e+06  6.56e-04 1.46e-11  1.09e+01     3s
  23   7.32180163e+06  6.52405955e+06  5.46e-04 1.46e-11  8.74e+00     3s
  24   7.24385935e+06  6.60906768e+06  4.51e-04 1.46e-11  6.96e+00     3s
  25   7.11724507e+06  6.67592481e+06  2.99e-04 1.46e-11  4.84e+00     3s
  26   7.06412735e+06  6.76798142e+06  2.40e-04 1.46e-11  3.24e+00     3s
  27   7.00961876e+06  6.77045346e+06  1.76e-04 2.18e-11  2.62e+00     3s
  28   6.92085352e+06  6.79864680e+06  7.21e-05 1.46e-11  1.34e+00     3s
  29   6.89928757e+06  6.83163451e+06  4.80e-05 2.91e-11  7.41e-01     3s
  30   6.88657882e+06  6.84362726e+06  3.40e-05 2.91e-11  4.71e-01     3s
  31   6.88291773e+06  6.84561423e+06  3.00e-05 2.18e-11  4.09e-01     3s
  32   6.87599543e+06  6.84708600e+06  2.25e-05 2.91e-11  3.17e-01     3s
  33   6.87571177e+06  6.84877735e+06  2.22e-05 1.46e-11  2.95e-01     3s
  34   6.86885335e+06  6.85066935e+06  1.52e-05 2.91e-11  1.99e-01     4s
  35   6.86687747e+06  6.85182022e+06  1.30e-05 1.46e-11  1.65e-01     4s
  36   6.86185405e+06  6.85284087e+06  7.64e-06 1.46e-11  9.87e-02     4s
  37   6.85929089e+06  6.85380773e+06  5.17e-06 1.46e-11  6.01e-02     4s
  38   6.85821085e+06  6.85400821e+06  3.98e-06 1.46e-11  4.60e-02     4s
  39   6.85710533e+06  6.85411479e+06  2.76e-06 1.46e-11  3.28e-02     4s
  40   6.85670774e+06  6.85435400e+06  2.32e-06 1.46e-11  2.58e-02     4s
  41   6.85608754e+06  6.85440971e+06  1.64e-06 1.46e-11  1.84e-02     4s
  42   6.85567803e+06  6.85448048e+06  1.18e-06 1.46e-11  1.31e-02     4s
  43   6.85549552e+06  6.85453629e+06  9.85e-07 1.46e-11  1.05e-02     4s
  44   6.85528001e+06  6.85455955e+06  7.43e-07 2.18e-11  7.89e-03     4s
  45   6.85469499e+06  6.85458536e+06  2.20e-07 2.91e-11  1.20e-03     4s
  46   6.85463564e+06  6.85459885e+06  7.48e-08 2.91e-11  4.03e-04     4s
  47   6.85461854e+06  6.85460750e+06  2.29e-08 2.91e-11  1.21e-04     4s
  48   6.85461166e+06  6.85460900e+06  2.57e-09 2.91e-11  2.90e-05     4s
  49   6.85461074e+06  6.85461065e+06  9.64e-11 5.82e-11  1.04e-06     4s
  50   6.85461073e+06  6.85461070e+06  1.64e-09 5.82e-11  3.23e-07     4s
  51   6.85461072e+06  6.85461071e+06  2.17e-09 5.82e-11  4.04e-08     5s
  52   6.85461072e+06  6.85461072e+06  2.79e-09 2.91e-11  1.36e-09     5s

Barrier solved model in 52 iterations and 4.68 seconds
Optimal objective 6.85461072e+06

Crossover log...

     797 DPushes remaining with DInf 0.0000000e+00                 5s
      26 DPushes remaining with DInf 0.0000000e+00                 5s
       0 DPushes remaining with DInf 0.0000000e+00                 5s

     644 PPushes remaining with PInf 4.0000000e-06                 5s
       0 PPushes remaining with PInf 5.0000000e-06                 6s

  Push phase complete: Pinf 5.0000000e-06, Dinf 4.3166318e-10      6s

Iteration    Objective       Primal Inf.    Dual Inf.      Time
    1444    6.8546107e+06   3.000000e-06   0.000000e+00      6s
Extra simplex iterations after uncrush: 41
    1488    6.8546107e+06   0.000000e+00   0.000000e+00      6s

Solved with barrier
Solved in 1488 iterations and 5.76 seconds
Optimal objective  6.854610717e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 6.85e+06
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.74s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-zk41mk2y.lp
Reading time = 0.11 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0x24797525
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [2e+00, 1e+01]
  RHS range        [4e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57050 rows and 22028 columns
Presolve time: 0.05s
Presolved: 3934 rows, 4829 columns, 23601 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.832e+04
 Factor NZ  : 6.454e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.200e+06 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   3.50090062e+07 -9.81980581e+08  1.79e+04 5.68e-14  4.27e+05     0s
   1   1.79646515e+07 -4.60282314e+08  2.03e+03 1.71e-13  7.29e+04     0s
   2   1.52348140e+07 -5.86040236e+07  1.95e+02 5.09e-12  8.56e+03     0s

Barrier performed 2 iterations in 0.20 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with dual simplex
Solved in 2798 iterations and 0.32 seconds
Optimal objective  1.381187312e+07
INFO:pypsa.linopf:Optimization successful. Objective value: 1.38e+07
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


all




all


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 3.24s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-71ttplgs.lp
Reading time = 0.29 seconds
obj: 167880 rows, 80305 columns, 282380 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 167880 rows, 80305 columns and 282380 nonzeros
Model fingerprint: 0x2ecf8ec5
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [2e+00, 1e+01]
  RHS range        [4e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 154251 rows and 34697 columns
Presolve time: 0.20s
Presolved: 13629 rows, 45608 columns, 93251 nonzeros

Ordering time: 0.56s

Barrier statistics:
 AA' NZ     : 5.273e+04
 Factor NZ  : 8.296e+05 (roughly 30 MBytes of memory)
 Factor Ops : 1.584e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.24642596e+12 -2.02262258e+12  3.73e+04 1.40e+04  6.64e+08     1s
   1   2.90738356e+11 -1.12911717e+12  4.39e+03 5.35e+03  8.60e+07     1s
   2   3.26172882e+10 -2.80430966e+11  4.05e+02 1.87e-10  9.24e+06     1s
   3   9.24121669e+09 -4.23678092e+10  5.02e+01 3.20e-10  1.20e+06     1s
   4   5.06660781e+09 -1.65729127e+10  1.97e+01 1.59e-10  4.37e+05     1s
   5   2.34550098e+09 -6.61805506e+09  9.47e+00 5.53e-10  1.69e+05     1s
   6   2.86232375e+08 -2.48720368e+09  1.33e+00 1.75e-10  3.70e+04     1s
   7   2.81499232e+07 -8.80105006e+08  4.20e-03 1.59e-10  9.97e+03     1s
   8   2.36614136e+07 -3.82756878e+08  2.36e-03 1.88e-10  4.46e+03     2s
   9   1.79363313e+07 -1.76184042e+08  1.09e-03 1.88e-10  2.13e+03     2s
  10   1.29132447e+07 -8.07779143e+07  5.04e-04 1.30e-10  1.03e+03     2s
  11   8.30636618e+06 -3.51301468e+07  1.98e-04 1.01e-10  4.76e+02     2s
  12   6.45799721e+06 -1.58580168e+07  1.12e-04 7.15e-11  2.45e+02     2s
  13   4.99331662e+06 -7.33118115e+06  5.34e-05 5.70e-11  1.35e+02     2s
  14   4.25297836e+06 -3.09981493e+06  3.14e-05 3.51e-11  8.06e+01     2s
  15   3.80519296e+06  8.39571344e+05  1.97e-05 1.76e-11  3.25e+01     2s
  16   3.44174005e+06  1.37497990e+06  1.09e-05 1.46e-11  2.27e+01     2s
  17   3.29149820e+06  1.96157718e+06  7.52e-06 1.46e-11  1.46e+01     2s
  18   3.18213184e+06  2.33440337e+06  5.08e-06 1.46e-11  9.29e+00     2s
  19   3.15612967e+06  2.65243178e+06  4.53e-06 1.46e-11  5.52e+00     2s
  20   3.13889852e+06  2.67937479e+06  4.19e-06 1.46e-11  5.04e+00     2s
  21   3.09250164e+06  2.69641288e+06  3.25e-06 2.18e-11  4.34e+00     2s
  22   3.06643275e+06  2.77318893e+06  2.73e-06 1.46e-11  3.21e+00     2s
  23   3.03319792e+06  2.82043549e+06  2.13e-06 1.46e-11  2.33e+00     3s
  24   3.01048837e+06  2.84383252e+06  1.69e-06 1.46e-11  1.83e+00     3s
  25   3.00467054e+06  2.85660367e+06  1.58e-06 1.46e-11  1.62e+00     3s
  26   2.99744415e+06  2.86563578e+06  1.44e-06 1.46e-11  1.45e+00     3s
  27   2.95846892e+06  2.88075581e+06  6.97e-07 1.46e-11  8.52e-01     3s
  28   2.93773732e+06  2.90070458e+06  3.26e-07 1.46e-11  4.06e-01     3s
  29   2.92534626e+06  2.91198749e+06  1.15e-07 1.46e-11  1.46e-01     3s
  30   2.92191839e+06  2.91537532e+06  5.59e-08 2.91e-11  7.17e-02     3s
  31   2.92120810e+06  2.91684223e+06  4.40e-08 1.46e-11  4.79e-02     3s
  32   2.92067664e+06  2.91765229e+06  3.60e-08 1.46e-11  3.32e-02     3s
  33   2.91986933e+06  2.91796975e+06  2.98e-08 1.46e-11  2.08e-02     3s
  34   2.91956805e+06  2.91806679e+06  2.60e-08 1.46e-11  1.65e-02     3s
  35   2.91914530e+06  2.91820721e+06  4.81e-08 1.46e-11  1.03e-02     3s
  36   2.91893129e+06  2.91825725e+06  3.14e-08 1.46e-11  7.39e-03     3s
  37   2.91882656e+06  2.91834270e+06  3.04e-08 1.46e-11  5.30e-03     3s
  38   2.91866421e+06  2.91838277e+06  1.20e-07 1.46e-11  3.09e-03     3s
  39   2.91861002e+06  2.91841332e+06  1.19e-07 1.46e-11  2.16e-03     3s
  40   2.91856416e+06  2.91843902e+06  7.48e-08 1.46e-11  1.37e-03     3s
  41   2.91852617e+06  2.91845655e+06  4.43e-07 2.91e-11  7.63e-04     3s
  42   2.91851096e+06  2.91846323e+06  1.03e-06 2.91e-11  5.23e-04     3s
  43   2.91849616e+06  2.91846706e+06  7.81e-07 2.91e-11  3.19e-04     4s
  44   2.91848794e+06  2.91846989e+06  4.68e-07 2.91e-11  1.98e-04     4s
  45   2.91847964e+06  2.91847139e+06  1.24e-06 2.91e-11  9.05e-05     4s
  46   2.91847628e+06  2.91847262e+06  5.24e-07 2.91e-11  4.02e-05     4s
  47   2.91847536e+06  2.91847336e+06  4.14e-07 5.82e-11  2.19e-05     4s
  48   2.91847416e+06  2.91847381e+06  3.75e-07 5.82e-11  3.86e-06     4s
  49   2.91847410e+06  2.91847404e+06  1.44e-07 5.82e-11  6.10e-07     4s
  50   2.91847408e+06  2.91847405e+06  6.79e-08 5.82e-11  2.52e-07     4s
  51   2.91847406e+06  2.91847405e+06  1.02e-08 5.82e-11  3.77e-08     4s
  52   2.91847405e+06  2.91847405e+06  4.90e-09 5.82e-11  1.08e-08     4s
  53   2.91847405e+06  2.91847405e+06  8.99e-08 5.82e-11  4.91e-09     4s

Barrier solved model in 53 iterations and 4.09 seconds
Optimal objective 2.91847405e+06

Crossover log...

    1682 DPushes remaining with DInf 0.0000000e+00                 4s
       0 DPushes remaining with DInf 0.0000000e+00                 5s

     666 PPushes remaining with PInf 8.0000000e-06                 5s
       0 PPushes remaining with PInf 8.0000000e-06                 5s

  Push phase complete: Pinf 8.0000000e-06, Dinf 4.4791892e-10      5s

Iteration    Objective       Primal Inf.    Dual Inf.      Time
    2351    2.9184741e+06   6.000000e-06   0.000000e+00      5s
Extra simplex iterations after uncrush: 11
    2366    2.9184741e+06   0.000000e+00   0.000000e+00      5s

Solved with barrier
Solved in 2366 iterations and 5.01 seconds
Optimal objective  2.918474053e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 2.92e+06
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.74s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-nglrcgin.lp
Reading time = 0.11 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0x6f518071
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [2e+00, 2e+01]
  RHS range        [4e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57052 rows and 22001 columns
Presolve time: 0.05s
Presolved: 3932 rows, 4856 columns, 23626 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.832e+04
 Factor NZ  : 6.455e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.201e+06 (less than 1 second per iteration)
 Threads    : 30

Barrier performed 0 iterations in 0.23 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with dual simplex
Solved in 2684 iterations and 0.23 seconds
Optimal objective  8.154871161e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 8.15e+06
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


all




all


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 3.24s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-wuer51nl.lp
Reading time = 0.29 seconds
obj: 167880 rows, 80305 columns, 282380 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 167880 rows, 80305 columns and 282380 nonzeros
Model fingerprint: 0x454b171d
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [2e+00, 2e+01]
  RHS range        [4e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 154288 rows and 35792 columns
Presolve time: 0.12s
Presolved: 13592 rows, 44513 columns, 92119 nonzeros

Ordering time: 0.40s

Barrier statistics:
 AA' NZ     : 5.269e+04
 Factor NZ  : 8.476e+05 (roughly 30 MBytes of memory)
 Factor Ops : 1.643e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.24454284e+12 -2.01059152e+12  3.73e+04 1.37e+04  6.64e+08     1s
   1   2.79490500e+11 -1.13487629e+12  4.39e+03 5.98e+03  8.61e+07     1s
   2   3.20570202e+10 -2.82765777e+11  4.22e+02 2.04e-10  9.55e+06     1s
   3   8.68083846e+09 -4.26027874e+10  5.45e+01 3.20e-10  1.25e+06     1s
   4   5.50534563e+09 -1.72781701e+10  2.19e+01 2.91e-10  4.73e+05     1s
   5   2.75631539e+09 -8.57811855e+09  1.13e+01 1.36e-10  2.15e+05     1s
   6   2.56135570e+08 -1.99572995e+09  1.36e+00 1.76e-10  3.15e+04     1s
   7   2.60976932e+07 -6.84897470e+08  7.47e-03 1.07e-10  8.00e+03     1s
   8   1.95057283e+07 -1.82210242e+08  3.26e-03 1.07e-10  2.27e+03     1s
   9   9.38639809e+06 -1.09803109e+08  3.43e-04 9.46e-11  1.34e+03     1s
  10   6.97838467e+06 -5.11535107e+07  1.54e-04 7.79e-11  6.53e+02     1s
  11   5.19176727e+06 -1.77984399e+07  6.11e-05 4.48e-11  2.58e+02     1s
  12   4.39383145e+06 -1.08320377e+07  3.38e-05 3.43e-11  1.71e+02     1s
  13   3.96955893e+06 -4.39419285e+06  2.15e-05 2.70e-11  9.39e+01     1s
  14   3.56190171e+06 -1.82225808e+06  1.16e-05 1.61e-11  6.05e+01     2s
  15   3.19807057e+06  1.51060396e+06  3.85e-06 2.18e-11  1.90e+01     2s
  16   3.05695369e+06  2.27660309e+06  1.49e-06 1.46e-11  8.77e+00     2s
  17   2.99048083e+06  2.84053090e+06  5.71e-07 1.46e-11  1.68e+00     2s
  18   2.95921722e+06  2.89466807e+06  2.36e-07 2.91e-11  7.25e-01     2s
  19   2.94764865e+06  2.91553744e+06  1.30e-07 1.46e-11  3.61e-01     2s
  20   2.94383299e+06  2.91949243e+06  9.73e-08 1.46e-11  2.73e-01     2s
  21   2.93780399e+06  2.92421445e+06  4.70e-08 1.46e-11  1.53e-01     2s
  22   2.93687166e+06  2.92782801e+06  3.97e-08 2.91e-11  1.02e-01     2s
  23   2.93608805e+06  2.92894361e+06  3.36e-08 1.46e-11  8.03e-02     2s
  24   2.93459173e+06  2.93002103e+06  2.34e-08 1.46e-11  5.13e-02     2s
  25   2.93402009e+06  2.93043474e+06  2.24e-08 1.46e-11  4.03e-02     2s
  26   2.93271775e+06  2.93092570e+06  6.19e-08 1.46e-11  2.01e-02     2s
  27   2.93245208e+06  2.93109876e+06  2.98e-08 1.46e-11  1.52e-02     2s
  28   2.93232034e+06  2.93121681e+06  3.30e-08 1.46e-11  1.24e-02     2s
  29   2.93209557e+06  2.93129483e+06  3.72e-08 1.46e-11  8.99e-03     2s
  30   2.93203419e+06  2.93139556e+06  4.71e-08 1.46e-11  7.17e-03     2s
  31   2.93195844e+06  2.93147510e+06  4.25e-08 1.46e-11  5.43e-03     3s
  32   2.93178190e+06  2.93150879e+06  9.00e-08 1.46e-11  3.07e-03     3s
  33   2.93166123e+06  2.93152845e+06  5.04e-08 1.46e-11  1.49e-03     3s
  34   2.93163134e+06  2.93153925e+06  4.65e-08 2.91e-11  1.03e-03     3s
  35   2.93161246e+06  2.93154841e+06  2.29e-07 2.91e-11  7.19e-04     3s
  36   2.93159833e+06  2.93155140e+06  4.88e-07 2.91e-11  5.27e-04     3s
  37   2.93159155e+06  2.93155375e+06  3.67e-07 2.91e-11  4.25e-04     3s
  38   2.93157962e+06  2.93155599e+06  8.68e-07 2.91e-11  2.65e-04     3s
  39   2.93156681e+06  2.93155735e+06  4.27e-07 2.91e-11  1.06e-04     3s
  40   2.93156458e+06  2.93155783e+06  7.98e-07 5.82e-11  7.58e-05     3s
  41   2.93156205e+06  2.93155793e+06  4.84e-07 5.82e-11  4.63e-05     3s
  42   2.93155935e+06  2.93155796e+06  1.47e-07 5.82e-11  1.56e-05     3s
  43   2.93155816e+06  2.93155812e+06  7.16e-09 5.82e-11  4.50e-07     3s
  44   2.93155815e+06  2.93155815e+06  4.12e-09 5.82e-11  3.34e-08     3s
  45   2.93155815e+06  2.93155815e+06  4.05e-07 2.91e-11  6.43e-09     3s

Barrier solved model in 45 iterations and 3.23 seconds
Optimal objective 2.93155815e+06

Crossover log...

    1453 DPushes remaining with DInf 0.0000000e+00                 3s
       0 DPushes remaining with DInf 0.0000000e+00                 3s

    1194 PPushes remaining with PInf 2.6000000e-05                 3s

Solved with dual simplex
Solved in 13563 iterations and 3.53 seconds
Optimal objective  2.931558147e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 2.93e+06
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.75s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-do20_l3h.lp
Reading time = 0.11 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0x1ad336e8
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [3e+00, 4e+01]
  RHS range        [7e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57048 rows and 22028 columns
Presolve time: 0.05s
Presolved: 3936 rows, 4829 columns, 23603 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.833e+04
 Factor NZ  : 6.453e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.199e+06 (less than 1 second per iteration)
 Threads    : 30

Barrier performed 0 iterations in 0.34 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with dual simplex
Solved in 2817 iterations and 0.34 seconds
Optimal objective  1.341246841e+07
INFO:pypsa.linopf:Optimization successful. Objective value: 1.34e+07
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


all




all


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 3.24s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-0msxmrud.lp
Reading time = 0.29 seconds
obj: 167880 rows, 80305 columns, 282380 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 167880 rows, 80305 columns and 282380 nonzeros
Model fingerprint: 0xb998bfbb
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [3e+00, 4e+01]
  RHS range        [7e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 154249 rows and 34669 columns
Presolve time: 0.14s
Presolved: 13631 rows, 45636 columns, 93281 nonzeros

Ordering time: 0.52s

Barrier statistics:
 AA' NZ     : 5.273e+04
 Factor NZ  : 8.658e+05 (roughly 30 MBytes of memory)
 Factor Ops : 1.699e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.23411710e+12 -1.94677073e+12  3.73e+04 9.49e+03  6.63e+08     1s
   1   2.87120201e+11 -1.12782336e+12  4.41e+03 5.83e+03  8.61e+07     1s
   2   2.76830469e+10 -2.83450576e+11  3.34e+02 2.04e-10  8.19e+06     1s
   3   8.78824291e+09 -4.46522679e+10  3.74e+01 2.18e-10  1.04e+06     1s
   4   3.92787678e+09 -1.52176431e+10  1.03e+01 2.91e-10  3.04e+05     1s
   5   9.80356148e+08 -4.42021884e+09  3.22e+00 1.59e-10  7.65e+04     1s
   6   3.31417394e+08 -1.11816060e+09  1.03e+00 1.65e-10  1.87e+04     1s
   7   1.41907276e+08 -5.63882740e+08  4.01e-01 1.30e-10  8.43e+03     1s
   8   9.32250985e+07 -2.79837747e+08  2.40e-01 1.01e-10  4.36e+03     1s
   9   6.96044558e+07 -1.47403103e+08  1.76e-01 1.01e-10  2.52e+03     1s
  10   5.76294807e+07 -1.03645404e+08  1.41e-01 1.01e-10  1.87e+03     1s
  11   4.28131254e+07 -4.67573257e+07  9.87e-02 1.01e-10  1.03e+03     1s
  12   3.20264162e+07 -2.44560580e+07  6.87e-02 1.01e-10  6.46e+02     1s
  13   2.09915278e+07 -1.32560534e+07  4.06e-02 1.01e-10  3.88e+02     1s
  14   1.77503996e+07 -7.03750991e+06  3.19e-02 7.15e-11  2.80e+02     1s
  15   1.45291390e+07 -2.39662240e+06  2.39e-02 7.15e-11  1.90e+02     1s
  16   1.26796799e+07 -2.76966068e+05  1.90e-02 7.15e-11  1.45e+02     1s
  17   1.00623023e+07  2.52532685e+06  1.25e-02 6.34e-11  8.40e+01     2s
  18   8.34649647e+06  3.68864425e+06  8.24e-03 5.70e-11  5.17e+01     2s
  19   7.64910663e+06  4.04884652e+06  6.48e-03 4.24e-11  3.99e+01     2s
  20   7.00989158e+06  4.37217494e+06  4.78e-03 3.51e-11  2.91e+01     2s
  21   6.57396609e+06  4.53771535e+06  3.63e-03 2.79e-11  2.25e+01     2s
  22   6.16571193e+06  4.80282659e+06  2.57e-03 2.06e-11  1.50e+01     2s
  23   5.81187898e+06  4.92247036e+06  1.70e-03 1.46e-11  9.78e+00     2s
  24   5.58243896e+06  5.02080203e+06  1.10e-03 1.46e-11  6.17e+00     2s
  25   5.44315013e+06  5.07203759e+06  7.33e-04 2.18e-11  4.07e+00     2s
  26   5.31779935e+06  5.11785411e+06  4.30e-04 1.46e-11  2.19e+00     2s
  27   5.23869477e+06  5.13137512e+06  2.19e-04 1.46e-11  1.18e+00     2s
  28   5.19883705e+06  5.14603973e+06  1.17e-04 1.46e-11  5.79e-01     2s
  29   5.17315090e+06  5.14960453e+06  5.07e-05 1.46e-11  2.58e-01     2s
  30   5.16141439e+06  5.15143959e+06  2.09e-05 1.46e-11  1.09e-01     2s
  31   5.15568146e+06  5.15197395e+06  6.61e-06 1.46e-11  4.06e-02     2s
  32   5.15366196e+06  5.15259428e+06  1.75e-06 1.46e-11  1.17e-02     2s
  33   5.15324868e+06  5.15277702e+06  7.67e-07 1.46e-11  5.17e-03     2s
  34   5.15298537e+06  5.15287494e+06  1.77e-07 2.91e-11  1.21e-03     2s
  35   5.15291256e+06  5.15289819e+06  4.08e-08 5.82e-11  1.58e-04     2s
  36   5.15290449e+06  5.15290276e+06  1.80e-07 5.82e-11  1.89e-05     2s
  37   5.15290337e+06  5.15290316e+06  2.01e-08 5.82e-11  2.32e-06     2s
  38   5.15290325e+06  5.15290321e+06  4.68e-09 5.82e-11  4.88e-07     2s
  39   5.15290323e+06  5.15290322e+06  2.10e-09 4.37e-11  1.59e-07     3s
  40   5.15290322e+06  5.15290322e+06  3.64e-09 5.82e-11  2.06e-08     3s
  41   5.15290322e+06  5.15290322e+06  3.86e-09 5.82e-11  7.76e-09     3s

Barrier solved model in 41 iterations and 2.66 seconds
Optimal objective 5.15290322e+06

Crossover log...

    2004 DPushes remaining with DInf 0.0000000e+00                 3s
       0 DPushes remaining with DInf 0.0000000e+00                 3s

     492 PPushes remaining with PInf 1.1000000e-05                 3s
       0 PPushes remaining with PInf 2.0000000e-05                 3s

  Push phase complete: Pinf 2.0000000e-05, Dinf 4.4427001e-10      3s

Iteration    Objective       Primal Inf.    Dual Inf.      Time
    2499    5.1529032e+06   1.700000e-05   0.000000e+00      3s
Extra simplex iterations after uncrush: 36
    2547    5.1529032e+06   0.000000e+00   0.000000e+00      3s

Solved with barrier
Solved in 2547 iterations and 3.35 seconds
Optimal objective  5.152903220e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 5.15e+06
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.75s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-t2_ps1t1.lp
Reading time = 0.11 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0x9d0a84f8
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [6e+00, 4e+01]
  RHS range        [1e-02, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57049 rows and 22032 columns
Presolve time: 0.05s
Presolved: 3935 rows, 4825 columns, 23598 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.832e+04
 Factor NZ  : 6.452e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.199e+06 (less than 1 second per iteration)
 Threads    : 30

Barrier performed 0 iterations in 0.24 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with dual simplex
Solved in 2735 iterations and 0.24 seconds
Optimal objective  1.731522821e+07
INFO:pypsa.linopf:Optimization successful. Objective value: 1.73e+07
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


all




all


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 3.26s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-uhj33jsb.lp
Reading time = 0.29 seconds
obj: 167880 rows, 80305 columns, 282380 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 167880 rows, 80305 columns and 282380 nonzeros
Model fingerprint: 0xd73c5bf9
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [6e+00, 4e+01]
  RHS range        [1e-02, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 154265 rows and 34990 columns
Presolve time: 0.14s
Presolved: 13615 rows, 45315 columns, 92944 nonzeros

Ordering time: 0.60s

Barrier statistics:
 AA' NZ     : 5.272e+04
 Factor NZ  : 8.670e+05 (roughly 30 MBytes of memory)
 Factor Ops : 1.702e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.72388159e+12 -1.98015549e+12  5.67e+04 1.12e+04  9.28e+08     1s
   1   3.81762158e+11 -1.20680318e+12  6.27e+03 3.36e+02  1.12e+08     1s
   2   3.28610888e+10 -3.81729764e+11  4.39e+02 2.04e-10  1.05e+07     1s
   3   1.01078860e+10 -5.31073085e+10  5.43e+01 1.75e-10  1.33e+06     1s
   4   5.13292005e+09 -1.95795446e+10  1.78e+01 2.91e-10  4.39e+05     1s
   5   2.35932964e+09 -6.85430000e+09  8.45e+00 1.59e-10  1.56e+05     1s
   6   4.51544973e+08 -3.17161261e+09  1.89e+00 1.59e-10  4.88e+04     1s
   7   5.00968089e+07 -8.14394938e+08  7.88e-02 1.59e-10  9.71e+03     1s
   8   3.95835360e+07 -3.51545769e+08  4.74e-02 1.30e-10  4.37e+03     1s
   9   2.85465489e+07 -1.71754181e+08  2.29e-02 1.30e-10  2.23e+03     1s
  10   2.46849413e+07 -1.06391453e+08  1.72e-02 1.01e-10  1.45e+03     1s
  11   1.88533589e+07 -6.28906951e+07  9.93e-03 7.15e-11  9.05e+02     1s
  12   1.75503639e+07 -5.06436752e+07  8.56e-03 7.15e-11  7.55e+02     1s
  13   1.56347172e+07 -3.43112659e+07  6.54e-03 7.79e-11  5.52e+02     1s
  14   1.41003394e+07 -1.90783929e+07  5.10e-03 5.39e-11  3.67e+02     1s
  15   1.25659558e+07 -7.14827168e+06  3.70e-03 4.24e-11  2.18e+02     2s
  16   1.10842949e+07 -1.44994707e+06  2.45e-03 2.79e-11  1.38e+02     2s
  17   1.05113897e+07 -7.40475990e+04  2.00e-03 2.06e-11  1.17e+02     2s
  18   9.98629739e+06  3.32702002e+06  1.58e-03 2.91e-11  7.35e+01     2s
  19   9.33734459e+06  4.84221851e+06  1.09e-03 1.46e-11  4.96e+01     2s
  20   8.94041708e+06  5.92852970e+06  8.02e-04 2.91e-11  3.32e+01     2s
  21   8.71257711e+06  6.49671722e+06  6.43e-04 1.46e-11  2.45e+01     2s
  22   8.44298669e+06  7.04020805e+06  4.61e-04 1.46e-11  1.55e+01     2s
  23   8.33373036e+06  7.30084259e+06  3.99e-04 1.46e-11  1.14e+01     2s
  24   8.11022762e+06  7.44279851e+06  2.47e-04 1.46e-11  7.37e+00     2s
  25   7.89169295e+06  7.59249476e+06  1.04e-04 1.46e-11  3.30e+00     2s
  26   7.84964287e+06  7.63079349e+06  7.81e-05 1.46e-11  2.42e+00     2s
  27   7.79772736e+06  7.68165000e+06  4.65e-05 2.91e-11  1.28e+00     2s
  28   7.77585780e+06  7.69622748e+06  3.42e-05 1.46e-11  8.79e-01     2s
  29   7.74808295e+06  7.70405994e+06  1.77e-05 1.46e-11  4.86e-01     2s
  30   7.73755180e+06  7.71232534e+06  1.15e-05 1.46e-11  2.78e-01     2s
  31   7.73551831e+06  7.71334669e+06  1.04e-05 1.46e-11  2.45e-01     2s
  32   7.72749202e+06  7.71465693e+06  5.75e-06 1.46e-11  1.42e-01     2s
  33   7.72344087e+06  7.71533745e+06  3.51e-06 2.91e-11  8.94e-02     2s
  34   7.72290640e+06  7.71601480e+06  3.21e-06 1.46e-11  7.61e-02     2s
  35   7.71995532e+06  7.71643607e+06  1.57e-06 1.46e-11  3.88e-02     2s
  36   7.71833915e+06  7.71680040e+06  6.95e-07 2.91e-11  1.70e-02     2s
  37   7.71777268e+06  7.71692281e+06  3.89e-07 2.91e-11  9.38e-03     2s
  38   7.71728303e+06  7.71697645e+06  1.51e-07 2.91e-11  3.38e-03     2s
  39   7.71712655e+06  7.71701207e+06  4.27e-07 5.82e-11  1.26e-03     2s
  40   7.71706887e+06  7.71702385e+06  1.64e-07 5.82e-11  4.97e-04     2s
  41   7.71704313e+06  7.71702915e+06  5.19e-08 8.73e-11  1.54e-04     2s
  42   7.71703318e+06  7.71703053e+06  9.46e-09 5.82e-11  2.92e-05     2s
  43   7.71703113e+06  7.71703089e+06  3.17e-09 5.82e-11  2.61e-06     2s
  44   7.71703094e+06  7.71703092e+06  2.97e-10 5.82e-11  2.50e-07     2s
  45   7.71703092e+06  7.71703092e+06  1.48e-09 5.82e-11  6.76e-08     3s
  46   7.71703092e+06  7.71703092e+06  3.20e-09 5.82e-11  2.15e-08     3s
  47   7.71703092e+06  7.71703092e+06  1.15e-07 5.82e-11  2.23e-09     3s

Barrier solved model in 47 iterations and 2.66 seconds
Optimal objective 7.71703092e+06

Crossover log...

    1016 DPushes remaining with DInf 0.0000000e+00                 3s
       0 DPushes remaining with DInf 0.0000000e+00                 3s

     203 PPushes remaining with PInf 4.0000000e-06                 3s
       0 PPushes remaining with PInf 4.0000000e-06                 3s

  Push phase complete: Pinf 4.0000000e-06, Dinf 6.5658367e-10      3s

Iteration    Objective       Primal Inf.    Dual Inf.      Time
    1222    7.7170309e+06   3.000000e-06   0.000000e+00      3s
Extra simplex iterations after uncrush: 20
    1245    7.7170309e+06   0.000000e+00   0.000000e+00      3s

Solved with barrier
Solved in 1245 iterations and 3.03 seconds
Optimal objective  7.717030918e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 7.72e+06
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.8s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-o6x6go64.lp
Reading time = 0.11 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0xcd24313c
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [7e+00, 4e+01]
  RHS range        [1e-02, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57048 rows and 22034 columns
Presolve time: 0.05s
Presolved: 3936 rows, 4823 columns, 23597 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.833e+04
 Factor NZ  : 6.453e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.199e+06 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   4.99883603e+07 -1.90909181e+09  2.00e+04 5.68e-14  8.25e+05     0s
   1   2.80777628e+07 -8.94149812e+08  2.52e+03 2.84e-13  1.46e+05     0s
   2   2.33746746e+07 -1.18224994e+08  2.47e+02 2.27e-13  1.67e+04     0s
   3   2.22656004e+07  1.26277003e+07  2.75e+01 3.69e-13  1.09e+03     0s
   4   2.18836357e+07  1.86848872e+07  4.66e+00 8.53e-13  3.38e+02     0s
   5   2.17692621e+07  2.05135703e+07  2.33e+00 2.27e-13  1.32e+02     0s
   6   2.16495022e+07  2.11373351e+07  8.03e-01 1.42e-13  5.34e+01     0s
   7   2.15850250e+07  2.13707696e+07  2.37e-01 1.14e-13  2.23e+01     0s

Barrier performed 7 iterations in 0.20 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with primal simplex
Solved in 4990 iterations and 0.20 seconds
Optimal objective  2.154630316e+07
INFO:pypsa.linopf:Optimization successful. Objective value: 2.15e+07
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


all




all


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 3.22s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-dogzl3ti.lp
Reading time = 0.29 seconds
obj: 167880 rows, 80305 columns, 282380 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 167880 rows, 80305 columns and 282380 nonzeros
Model fingerprint: 0xa501df1f
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [7e+00, 4e+01]
  RHS range        [1e-02, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 154252 rows and 34657 columns
Presolve time: 0.15s
Presolved: 13628 rows, 45648 columns, 93290 nonzeros

Ordering time: 0.48s

Barrier statistics:
 AA' NZ     : 5.273e+04
 Factor NZ  : 8.508e+05 (roughly 30 MBytes of memory)
 Factor Ops : 1.670e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.72579874e+12 -1.96171349e+12  5.68e+04 1.19e+04  9.31e+08     1s
   1   3.86662301e+11 -1.20434011e+12  6.30e+03 2.17e-10  1.12e+08     1s
   2   3.34610910e+10 -3.82443213e+11  4.44e+02 2.04e-10  1.06e+07     1s
   3   9.91982012e+09 -4.78215003e+10  4.89e+01 4.13e-09  1.21e+06     1s
   4   4.63853309e+09 -1.70706877e+10  1.44e+01 1.07e-09  3.70e+05     1s
   5   1.46546074e+09 -5.58454770e+09  4.99e+00 1.73e-10  1.07e+05     1s
   6   3.94659896e+08 -1.93909705e+09  1.43e+00 1.30e-10  3.03e+04     1s
   7   3.22392930e+07 -6.50232568e+08  1.87e-02 1.30e-10  7.51e+03     1s
   8   2.71757310e+07 -3.45288898e+08  1.15e-02 1.01e-10  4.09e+03     1s
   9   1.95365648e+07 -1.86267058e+08  5.18e-03 7.15e-11  2.26e+03     1s
  10   1.66698325e+07 -1.05357974e+08  3.80e-03 7.15e-11  1.34e+03     1s
  11   1.13285940e+07 -5.63944399e+07  1.68e-03 5.70e-11  7.42e+02     1s
  12   9.53021688e+06 -2.24577811e+07  1.15e-03 4.24e-11  3.51e+02     1s
  13   6.63303030e+06 -1.16585708e+07  4.48e-04 3.51e-11  2.00e+02     1s
  14   5.77143437e+06 -5.41328363e+06  2.94e-04 2.06e-11  1.23e+02     1s
  15   4.77523038e+06 -8.34424258e+05  1.41e-04 1.46e-11  6.14e+01     1s
  16   4.23856090e+06  1.06247733e+06  7.18e-05 1.46e-11  3.48e+01     1s
  17   3.98777837e+06  2.72978908e+06  4.21e-05 2.91e-11  1.38e+01     1s
  18   3.73144969e+06  3.34867472e+06  1.49e-05 2.91e-11  4.19e+00     1s
  19   3.63897972e+06  3.45895272e+06  6.71e-06 2.91e-11  1.97e+00     1s
  20   3.59967191e+06  3.50128914e+06  3.53e-06 1.46e-11  1.08e+00     1s
  21   3.57243525e+06  3.52828530e+06  1.43e-06 2.91e-11  4.84e-01     1s
  22   3.56351677e+06  3.53865466e+06  7.95e-07 1.46e-11  2.72e-01     1s
  23   3.55837991e+06  3.54655490e+06  4.40e-07 1.46e-11  1.30e-01     1s
  24   3.55518330e+06  3.54984684e+06  2.29e-07 2.91e-11  5.85e-02     1s
  25   3.55275128e+06  3.55075308e+06  7.71e-08 2.91e-11  2.19e-02     1s
  26   3.55175993e+06  3.55120559e+06  1.77e-08 2.91e-11  6.07e-03     1s
  27   3.55160400e+06  3.55137804e+06  8.04e-09 5.82e-11  2.48e-03     1s
  28   3.55151865e+06  3.55146443e+06  6.35e-09 5.82e-11  5.94e-04     1s
  29   3.55149085e+06  3.55147558e+06  8.57e-09 5.82e-11  1.67e-04     1s
  30   3.55148287e+06  3.55148144e+06  5.04e-10 5.82e-11  1.57e-05     1s
  31   3.55148239e+06  3.55148205e+06  1.52e-09 5.82e-11  3.66e-06     1s
  32   3.55148229e+06  3.55148222e+06  3.19e-10 5.82e-11  7.89e-07     2s
  33   3.55148227e+06  3.55148226e+06  1.00e-09 5.82e-11  4.97e-08     2s
  34   3.55148227e+06  3.55148227e+06  1.10e-09 5.82e-11  3.48e-09     2s

Barrier solved model in 34 iterations and 1.60 seconds
Optimal objective 3.55148227e+06

Crossover log...

    1462 DPushes remaining with DInf 0.0000000e+00                 2s
       0 DPushes remaining with DInf 0.0000000e+00                 2s

     437 PPushes remaining with PInf 1.6000000e-05                 2s
       0 PPushes remaining with PInf 1.6000000e-05                 2s

  Push phase complete: Pinf 1.6000000e-05, Dinf 2.4011571e-10      2s

Iteration    Objective       Primal Inf.    Dual Inf.      Time
    1902    3.5514823e+06   4.000000e-06   0.000000e+00      2s
Extra simplex iterations after uncrush: 37
    1942    3.5514823e+06   0.000000e+00   0.000000e+00      2s

Solved with barrier
Solved in 1942 iterations and 2.04 seconds
Optimal objective  3.551482266e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 3.55e+06
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.78s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-wjq4e05_.lp
Reading time = 0.11 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0x209a05b2
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [7e+00, 4e+01]
  RHS range        [1e-02, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57050 rows and 22027 columns
Presolve time: 0.05s
Presolved: 3934 rows, 4830 columns, 23602 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.832e+04
 Factor NZ  : 6.450e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.199e+06 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   4.95845251e+07 -1.88283998e+09  2.14e+04 1.14e-13  8.53e+05     0s
   1   2.50382492e+07 -9.16735962e+08  2.42e+03 2.84e-13  1.46e+05     0s
   2   2.06352444e+07 -1.28963788e+08  2.41e+02 2.27e-13  1.75e+04     0s
   3   1.93973559e+07  7.21084259e+06  2.36e+01 3.64e-12  1.33e+03     0s
   4   1.90064515e+07  1.46251135e+07  4.05e+00 5.68e-13  4.59e+02     0s
   5   1.88208541e+07  1.73515623e+07  1.15e+00 5.40e-12  1.53e+02     0s
   6   1.87560198e+07  1.79603607e+07  4.26e-01 2.61e-12  8.25e+01     0s
   7   1.87296447e+07  1.84147859e+07  1.95e-01 9.09e-13  3.26e+01     0s
   8   1.87111677e+07  1.86311164e+07  2.52e-02 2.42e-13  8.29e+00     0s
   9   1.87081858e+07  1.86945672e+07  7.17e-03 5.68e-14  1.41e+00     0s
  10   1.87069868e+07  1.87068410e+07  6.78e-05 5.68e-14  1.51e-02     0s
  11   1.87069710e+07  1.87069710e+07  6.91e-10 5.68e-14  9.24e-08     0s
  12   1.87069710e+07  1.87069710e+07  5.12e-12 5.68e-14  9.24e-11     0s

Barrier solved model in 12 iterations and 0.19 seconds
Optimal objective 1.87069710e+07

Crossover log...


Solved with primal simplex
Solved in 5237 iterations and 0.22 seconds
Optimal objective  1.870697101e+07
INFO:pypsa.linopf:Optimization successful. Objective value: 1.87e+07
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


all




all


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 3.24s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-lasa7eeo.lp
Reading time = 0.29 seconds
obj: 167880 rows, 80305 columns, 282380 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 167880 rows, 80305 columns and 282380 nonzeros
Model fingerprint: 0xe3c9ac5c
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [7e+00, 4e+01]
  RHS range        [1e-06, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 154254 rows and 34755 columns
Presolve time: 0.15s
Presolved: 13626 rows, 45550 columns, 93190 nonzeros

Ordering time: 0.72s

Barrier statistics:
 AA' NZ     : 5.273e+04
 Factor NZ  : 8.220e+05 (roughly 30 MBytes of memory)
 Factor Ops : 1.605e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.23251859e+12 -1.95262599e+12  4.00e+04 9.61e+03  6.62e+08     1s
   1   2.85691618e+11 -1.12596262e+12  4.72e+03 5.36e+03  8.59e+07     1s
   2   3.12186702e+10 -2.83889158e+11  4.03e+02 1.75e-10  8.82e+06     1s
   3   9.44783593e+09 -4.22712087e+10  4.21e+01 3.78e-10  1.05e+06     1s
   4   4.25643761e+09 -1.50652460e+10  1.11e+01 1.75e-10  3.11e+05     1s
   5   1.41972697e+09 -5.74355472e+09  4.25e+00 1.59e-10  1.03e+05     1s
   6   3.82104609e+08 -2.67355307e+09  1.16e+00 1.30e-10  3.79e+04     1s
   7   3.76800223e+07 -7.23595342e+08  2.33e-02 1.30e-10  8.40e+03     1s
   8   3.08793917e+07 -3.05298133e+08  1.27e-02 1.01e-10  3.70e+03     1s
   9   2.22720719e+07 -1.42871552e+08  5.54e-03 7.15e-11  1.82e+03     1s
  10   1.87410761e+07 -9.68301073e+07  4.04e-03 7.15e-11  1.27e+03     1s
  11   1.53889171e+07 -5.97951030e+07  2.67e-03 7.15e-11  8.26e+02     1s
  12   1.40608193e+07 -4.06557414e+07  2.22e-03 5.70e-11  6.01e+02     1s
  13   1.05501093e+07 -2.33423298e+07  1.08e-03 4.24e-11  3.72e+02     1s
  14   8.99890462e+06 -1.16835963e+07  6.57e-04 3.43e-11  2.27e+02     1s
  15   8.27590539e+06 -5.96452200e+06  4.90e-04 2.70e-11  1.56e+02     1s
  16   7.44164681e+06 -2.36124474e+06  3.20e-04 1.69e-11  1.08e+02     1s
  17   6.79671247e+06  3.82331030e+05  1.98e-04 2.91e-11  7.04e+01     1s
  18   6.38222441e+06  3.03725001e+06  1.25e-04 2.91e-11  3.67e+01     1s
  19   6.04811768e+06  4.31066645e+06  6.86e-05 2.91e-11  1.91e+01     1s
  20   5.86348800e+06  4.89491056e+06  4.03e-05 2.91e-11  1.06e+01     1s
  21   5.74622373e+06  5.28233769e+06  2.33e-05 2.91e-11  5.09e+00     1s
  22   5.66294984e+06  5.38428248e+06  1.23e-05 1.46e-11  3.06e+00     2s
  23   5.63475881e+06  5.43933128e+06  8.82e-06 1.46e-11  2.15e+00     2s
  24   5.60423685e+06  5.50224466e+06  5.14e-06 2.91e-11  1.12e+00     2s
  25   5.58175579e+06  5.52722483e+06  2.58e-06 2.91e-11  5.99e-01     2s
  26   5.56954980e+06  5.54291723e+06  1.25e-06 2.91e-11  2.92e-01     2s
  27   5.56503200e+06  5.54870878e+06  7.92e-07 2.91e-11  1.79e-01     2s
  28   5.56070709e+06  5.55171749e+06  3.66e-07 1.46e-11  9.87e-02     2s
  29   5.55884558e+06  5.55402460e+06  1.90e-07 1.46e-11  5.29e-02     2s
  30   5.55806865e+06  5.55565246e+06  1.18e-07 2.91e-11  2.65e-02     2s
  31   5.55743467e+06  5.55615505e+06  6.28e-08 2.91e-11  1.40e-02     2s
  32   5.55697878e+06  5.55652170e+06  4.27e-08 2.91e-11  5.02e-03     2s
  33   5.55680665e+06  5.55661963e+06  3.21e-08 2.91e-11  2.05e-03     2s
  34   5.55674164e+06  5.55668585e+06  2.50e-08 2.91e-11  6.12e-04     2s
  35   5.55671389e+06  5.55669875e+06  1.46e-07 5.82e-11  1.66e-04     2s
  36   5.55670612e+06  5.55670096e+06  9.66e-07 5.82e-11  5.66e-05     2s
  37   5.55670324e+06  5.55670141e+06  3.27e-07 2.91e-11  2.01e-05     2s
  38   5.55670295e+06  5.55670181e+06  2.55e-07 4.37e-11  1.24e-05     2s
  39   5.55670205e+06  5.55670187e+06  4.05e-08 5.82e-11  2.02e-06     2s
  40   5.55670190e+06  5.55670187e+06  3.85e-09 5.82e-11  2.54e-07     2s
  41   5.55670188e+06  5.55670188e+06  1.03e-09 5.82e-11  6.97e-08     2s
  42   5.55670188e+06  5.55670188e+06  2.72e-09 5.82e-11  1.12e-08     2s
  43   5.55670188e+06  5.55670188e+06  6.72e-09 5.82e-11  8.92e-10     2s

Barrier solved model in 43 iterations and 2.28 seconds
Optimal objective 5.55670188e+06

Crossover log...

    1115 DPushes remaining with DInf 0.0000000e+00                 2s
       0 DPushes remaining with DInf 0.0000000e+00                 2s

     382 PPushes remaining with PInf 4.0000000e-06                 2s
       0 PPushes remaining with PInf 5.0000000e-06                 3s

  Push phase complete: Pinf 5.0000000e-06, Dinf 3.0059272e-10      3s

Iteration    Objective       Primal Inf.    Dual Inf.      Time
    1500    5.5567019e+06   3.000000e-06   0.000000e+00      3s
Extra simplex iterations after uncrush: 45
    1548    5.5567019e+06   0.000000e+00   0.000000e+00      3s

Solved with barrier
Solved in 1548 iterations and 2.82 seconds
Optimal objective  5.556701878e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 5.56e+06
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.74s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-yt2ueq8o.lp
Reading time = 0.11 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0x33a88c88
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [7e+00, 4e+01]
  RHS range        [1e-02, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57048 rows and 22020 columns
Presolve time: 0.05s
Presolved: 3936 rows, 4837 columns, 23611 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.833e+04
 Factor NZ  : 6.453e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.199e+06 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   3.85884564e+07 -8.77321914e+08  2.43e+04 5.68e-14  4.85e+05     0s

Barrier performed 0 iterations in 0.20 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with dual simplex
Solved in 2871 iterations and 0.20 seconds
Optimal objective  1.075595832e+07
INFO:pypsa.linopf:Optimization successful. Objective value: 1.08e+07
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


all




all


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 3.24s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-toj02x1g.lp
Reading time = 0.29 seconds
obj: 167880 rows, 80305 columns, 282380 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 167880 rows, 80305 columns and 282380 nonzeros
Model fingerprint: 0x6855e628
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [7e+00, 4e+01]
  RHS range        [1e-02, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 154259 rows and 35569 columns
Presolve time: 0.13s
Presolved: 13621 rows, 44736 columns, 92371 nonzeros

Ordering time: 0.40s

Barrier statistics:
 AA' NZ     : 5.272e+04
 Factor NZ  : 8.564e+05 (roughly 30 MBytes of memory)
 Factor Ops : 1.670e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.23997983e+12 -2.00897005e+12  3.73e+04 1.39e+04  6.63e+08     1s
   1   2.80572074e+11 -1.13838728e+12  4.36e+03 5.42e+03  8.57e+07     1s
   2   3.21628150e+10 -2.87183207e+11  3.98e+02 2.04e-10  9.24e+06     1s
   3   9.77069243e+09 -4.15070941e+10  4.92e+01 6.69e-10  1.17e+06     1s
   4   4.50586495e+09 -1.62745815e+10  1.34e+01 2.33e-10  3.62e+05     1s
   5   2.11830114e+09 -7.12543255e+09  6.52e+00 1.75e-10  1.49e+05     1s
   6   6.00075018e+08 -2.41223874e+09  1.94e+00 1.75e-10  4.14e+04     1s
   7   6.97002897e+07 -9.18514536e+08  1.38e-01 1.31e-10  1.13e+04     1s
   8   5.18191943e+07 -4.00282977e+08  8.19e-02 1.30e-10  5.15e+03     1s
   9   4.05024327e+07 -1.54481288e+08  5.34e-02 1.01e-10  2.21e+03     1s
  10   3.52286948e+07 -1.02427451e+08  4.25e-02 7.15e-11  1.56e+03     1s
  11   2.58569987e+07 -5.19643649e+07  2.53e-02 8.84e-11  8.78e+02     1s
  12   2.13256634e+07 -2.59548327e+07  1.84e-02 5.70e-11  5.32e+02     1s
  13   1.60934596e+07 -1.09935520e+07  1.13e-02 7.15e-11  3.04e+02     1s
  14   1.40416047e+07 -6.67924016e+06  8.55e-03 5.10e-11  2.32e+02     1s
  15   1.29798717e+07 -5.39340864e+06  7.26e-03 5.10e-11  2.06e+02     1s
  16   1.23638136e+07 -2.65828164e+06  6.49e-03 3.64e-11  1.68e+02     1s
  17   1.02026478e+07  3.93630430e+05  3.81e-03 3.64e-11  1.10e+02     1s
  18   1.00156317e+07  1.06526559e+06  3.59e-03 2.92e-11  1.00e+02     1s
  19   9.18550378e+06  3.51107923e+06  2.66e-03 1.46e-11  6.35e+01     1s
  20   8.14671484e+06  5.05504909e+06  1.45e-03 1.46e-11  3.46e+01     1s
  21   7.79572410e+06  5.49332450e+06  1.06e-03 2.91e-11  2.57e+01     1s
  22   7.53634362e+06  5.90650409e+06  7.61e-04 2.91e-11  1.82e+01     1s
  23   7.29469938e+06  6.27018432e+06  4.86e-04 1.46e-11  1.15e+01     1s
  24   7.20326892e+06  6.47462350e+06  3.85e-04 1.46e-11  8.15e+00     1s
  25   7.04509470e+06  6.63560594e+06  2.14e-04 1.46e-11  4.58e+00     1s
  26   6.99823496e+06  6.72759908e+06  1.65e-04 1.46e-11  3.03e+00     1s
  27   6.93186718e+06  6.77341799e+06  9.74e-05 1.46e-11  1.77e+00     1s
  28   6.90489705e+06  6.79307779e+06  7.22e-05 1.46e-11  1.25e+00     1s
  29   6.87139190e+06  6.80985947e+06  3.83e-05 1.46e-11  6.88e-01     1s
  30   6.85934745e+06  6.82539705e+06  2.73e-05 2.91e-11  3.80e-01     1s
  31   6.84375092e+06  6.82818461e+06  1.22e-05 2.91e-11  1.74e-01     2s
  32   6.83501388e+06  6.83018062e+06  3.45e-06 1.46e-11  5.40e-02     2s
  33   6.83261270e+06  6.83075052e+06  1.11e-06 1.46e-11  2.08e-02     2s
  34   6.83204515e+06  6.83116271e+06  5.73e-07 1.46e-11  9.86e-03     2s
  35   6.83164902e+06  6.83131744e+06  2.06e-07 1.46e-11  3.71e-03     2s
  36   6.83155965e+06  6.83137265e+06  1.25e-07 1.46e-11  2.09e-03     2s
  37   6.83145092e+06  6.83140525e+06  2.94e-08 2.91e-11  5.11e-04     2s
  38   6.83142842e+06  6.83141363e+06  1.69e-08 5.82e-11  1.65e-04     2s
  39   6.83141907e+06  6.83141669e+06  4.11e-09 5.82e-11  2.67e-05     2s
  40   6.83141738e+06  6.83141700e+06  5.85e-10 5.82e-11  4.29e-06     2s
  41   6.83141712e+06  6.83141709e+06  1.14e-09 8.73e-11  3.43e-07     2s
  42   6.83141709e+06  6.83141709e+06  5.45e-09 5.82e-11  5.84e-08     2s
  43   6.83141709e+06  6.83141709e+06  7.08e-08 5.82e-11  5.57e-09     2s

Barrier solved model in 43 iterations and 1.97 seconds
Optimal objective 6.83141709e+06

Crossover log...

    2274 DPushes remaining with DInf 0.0000000e+00                 2s
       0 DPushes remaining with DInf 0.0000000e+00                 2s

     404 PPushes remaining with PInf 7.0000000e-06                 2s
       0 PPushes remaining with PInf 2.1000000e-05                 2s

  Push phase complete: Pinf 2.1000000e-05, Dinf 4.1651835e-10      2s

Iteration    Objective       Primal Inf.    Dual Inf.      Time
    2681    6.8314171e+06   1.900000e-05   0.000000e+00      2s
Extra simplex iterations after uncrush: 33
    2724    6.8314171e+06   0.000000e+00   0.000000e+00      2s

Solved with barrier
Solved in 2724 iterations and 2.42 seconds
Optimal objective  6.831417090e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 6.83e+06
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.74s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-xemhqshw.lp
Reading time = 0.11 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0x25d5b3e0
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [7e+00, 5e+01]
  RHS range        [1e-02, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57052 rows and 22018 columns
Presolve time: 0.05s
Presolved: 3932 rows, 4839 columns, 23609 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.832e+04
 Factor NZ  : 6.455e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.201e+06 (less than 1 second per iteration)
 Threads    : 30

Barrier performed 0 iterations in 0.25 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with primal simplex
Solved in 4844 iterations and 0.25 seconds
Optimal objective  3.187042965e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 3.19e+06
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


all




all


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 3.25s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-oj10zbxq.lp
Reading time = 0.29 seconds
obj: 167880 rows, 80305 columns, 282380 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 167880 rows, 80305 columns and 282380 nonzeros
Model fingerprint: 0xe969489a
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [7e+00, 5e+01]
  RHS range        [1e-02, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 154272 rows and 35420 columns
Presolve time: 0.14s
Presolved: 13608 rows, 44885 columns, 92507 nonzeros

Ordering time: 0.50s

Barrier statistics:
 AA' NZ     : 5.271e+04
 Factor NZ  : 8.654e+05 (roughly 30 MBytes of memory)
 Factor Ops : 1.674e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.23958609e+12 -2.00412215e+12  3.46e+04 1.39e+04  6.62e+08     1s
   1   2.80973212e+11 -1.13924765e+12  4.04e+03 5.86e+03  8.55e+07     1s
   2   3.28693206e+10 -3.23523615e+11  3.90e+02 2.04e-10  9.99e+06     1s
   3   8.85583239e+09 -4.87135127e+10  5.07e+01 2.91e-10  1.32e+06     1s
   4   5.39149359e+09 -1.88756799e+10  1.83e+01 2.33e-10  4.62e+05     1s
   5   3.13613943e+09 -9.70627515e+09  1.09e+01 1.24e-10  2.35e+05     1s
   6   4.57541628e+08 -2.92363769e+09  1.78e+00 2.90e-10  4.71e+04     1s
   7   3.61501817e+07 -9.88629089e+08  2.52e-11 1.47e-10  1.14e+04     2s
   8   2.99106846e+07 -3.93884453e+08  1.65e-11 2.05e-10  4.72e+03     2s
   9   1.78477926e+07 -1.18433571e+08  1.93e-11 1.18e-10  1.52e+03     2s
  10   1.36364881e+07 -5.71672607e+07  2.23e-11 8.84e-11  7.89e+02     2s
  11   9.41650105e+06 -2.28965770e+07  2.32e-11 4.48e-11  3.60e+02     2s
  12   8.08068778e+06 -9.23073593e+06  2.01e-11 3.02e-11  1.93e+02     2s
  13   6.13853030e+06 -7.54235841e+05  3.91e-11 1.57e-11  7.68e+01     2s
  14   5.54693576e+06  1.95585017e+06  5.21e-11 1.46e-11  4.00e+01     2s
  15   5.10672985e+06  3.74889160e+06  4.67e-11 2.91e-11  1.51e+01     2s
  16   4.97107451e+06  4.32250367e+06  1.57e-10 2.91e-11  7.22e+00     2s

Barrier performed 16 iterations in 2.25 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with dual simplex
Solved in 13429 iterations and 2.25 seconds
Optimal objective  4.861113273e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 4.86e+06
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.74s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-qs2sp9a6.lp
Reading time = 0.11 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0x8d90b3d8
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [7e+00, 5e+01]
  RHS range        [1e-02, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57048 rows and 22014 columns
Presolve time: 0.05s
Presolved: 3936 rows, 4843 columns, 23617 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.833e+04
 Factor NZ  : 6.453e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.199e+06 (less than 1 second per iteration)
 Threads    : 30

Barrier performed 0 iterations in 0.24 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with primal simplex
Solved in 5046 iterations and 0.24 seconds
Optimal objective  2.990452480e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 2.99e+06
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


all




all


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 3.25s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-bj1tp8e6.lp
Reading time = 0.29 seconds
obj: 167880 rows, 80305 columns, 282380 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 167880 rows, 80305 columns and 282380 nonzeros
Model fingerprint: 0x5d54cc99
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [7e+00, 5e+01]
  RHS range        [1e-02, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 154250 rows and 35541 columns
Presolve time: 0.16s
Presolved: 13630 rows, 44764 columns, 92408 nonzeros

Ordering time: 0.39s

Barrier statistics:
 AA' NZ     : 5.273e+04
 Factor NZ  : 8.460e+05 (roughly 30 MBytes of memory)
 Factor Ops : 1.659e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.24068402e+12 -2.01058742e+12  3.46e+04 1.39e+04  6.62e+08     1s
   1   2.79757075e+11 -1.13545661e+12  4.05e+03 5.82e+03  8.55e+07     1s
   2   2.54571765e+10 -2.84245997e+11  3.06e+02 6.98e-10  8.15e+06     1s
   3   7.39865330e+09 -4.48710662e+10  4.20e+01 1.75e-10  1.13e+06     1s
   4   3.43301761e+09 -1.60618626e+10  1.36e+01 1.46e-10  3.53e+05     1s
   5   6.29379650e+08 -4.62264124e+09  2.78e+00 2.33e-10  7.64e+04     1s
   6   3.56907057e+07 -1.16021100e+09  2.01e-02 1.18e-10  1.34e+04     1s
   7   2.84570526e+07 -4.99947691e+08  7.82e-03 8.84e-11  5.91e+03     1s
   8   1.96017013e+07 -1.91597494e+08  2.50e-03 5.93e-11  2.36e+03     1s
   9   1.16488328e+07 -7.72806890e+07  4.87e-04 4.48e-11  9.93e+02     1s
  10   9.25312954e+06 -3.47412906e+07  2.74e-04 4.48e-11  4.91e+02     1s
  11   7.03376715e+06 -1.63262471e+07  1.19e-04 2.30e-11  2.61e+02     1s
  12   5.79003557e+06 -4.02941172e+06  5.86e-05 1.46e-11  1.10e+02     1s
  13   4.74860646e+06  1.19452424e+06  1.70e-05 2.18e-11  3.97e+01     1s
  14   4.39996766e+06  2.96074538e+06  6.42e-06 1.46e-11  1.61e+01     1s
  15   4.22247919e+06  3.87380282e+06  1.89e-06 2.18e-11  3.89e+00     1s
  16   4.17112655e+06  4.02064038e+06  7.58e-07 1.46e-11  1.68e+00     1s
  17   4.14210491e+06  4.09107185e+06  1.64e-07 2.18e-11  5.70e-01     1s
  18   4.13338702e+06  4.12270967e+06  2.78e-08 2.18e-11  1.19e-01     1s
  19   4.13162749e+06  4.12592853e+06  1.16e-08 1.46e-11  6.37e-02     1s
  20   4.13105711e+06  4.12694448e+06  7.27e-09 1.46e-11  4.59e-02     1s
  21   4.13074146e+06  4.12853626e+06  5.01e-09 1.46e-11  2.46e-02     1s
  22   4.13048587e+06  4.12893532e+06  4.35e-09 1.46e-11  1.73e-02     1s
  23   4.13035874e+06  4.12951979e+06  3.25e-09 1.46e-11  9.37e-03     1s
  24   4.13029858e+06  4.12969160e+06  9.70e-09 1.46e-11  6.78e-03     1s
  25   4.13024953e+06  4.12970065e+06  8.38e-09 1.46e-11  6.13e-03     1s
  26   4.13023355e+06  4.12975593e+06  1.16e-08 1.46e-11  5.33e-03     1s
  27   4.13008504e+06  4.12978559e+06  9.11e-09 1.46e-11  3.34e-03     1s
  28   4.13003217e+06  4.12989157e+06  1.49e-08 2.91e-11  1.57e-03     1s
  29   4.12999827e+06  4.12991369e+06  2.14e-08 2.18e-11  9.45e-04     2s
  30   4.12997948e+06  4.12991496e+06  1.50e-08 1.46e-11  7.21e-04     2s
  31   4.12996823e+06  4.12992671e+06  1.23e-08 2.91e-11  4.64e-04     2s
  32   4.12994921e+06  4.12993056e+06  4.60e-08 2.91e-11  2.08e-04     2s
  33   4.12994279e+06  4.12993379e+06  7.42e-08 2.91e-11  1.00e-04     2s
  34   4.12994104e+06  4.12993388e+06  5.37e-08 2.91e-11  7.99e-05     2s
  35   4.12993840e+06  4.12993538e+06  2.41e-08 2.91e-11  3.37e-05     2s
  36   4.12993797e+06  4.12993592e+06  1.88e-08 2.91e-11  2.29e-05     2s
  37   4.12993749e+06  4.12993619e+06  1.28e-08 5.82e-11  1.45e-05     2s
  38   4.12993746e+06  4.12993631e+06  1.24e-08 5.82e-11  1.28e-05     2s
  39   4.12993646e+06  4.12993641e+06  4.06e-09 2.91e-11  5.37e-07     2s
  40   4.12993644e+06  4.12993644e+06  1.18e-09 5.82e-11  1.18e-08     2s
  41   4.12993644e+06  4.12993644e+06  4.54e-09 8.73e-11  1.58e-09     2s

Barrier solved model in 41 iterations and 1.89 seconds
Optimal objective 4.12993644e+06

Crossover log...

    2091 DPushes remaining with DInf 0.0000000e+00                 2s
       0 DPushes remaining with DInf 0.0000000e+00                 2s

    1953 PPushes remaining with PInf 8.0000000e-06                 2s

Solved with dual simplex
Solved in 13620 iterations and 2.42 seconds
Optimal objective  4.129936439e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 4.13e+06
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.75s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-gurkcbes.lp
Reading time = 0.11 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0x50bc06ee
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [5e+00, 5e+01]
  RHS range        [1e-02, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57048 rows and 22007 columns
Presolve time: 0.05s
Presolved: 3936 rows, 4850 columns, 23624 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.833e+04
 Factor NZ  : 6.453e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.199e+06 (less than 1 second per iteration)
 Threads    : 30

Barrier performed 0 iterations in 0.21 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with primal simplex
Solved in 5418 iterations and 0.21 seconds
Optimal objective  8.934248665e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 8.93e+06
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


all




all


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 3.24s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-82wq82dx.lp
Reading time = 0.29 seconds
obj: 167880 rows, 80305 columns, 282380 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 167880 rows, 80305 columns and 282380 nonzeros
Model fingerprint: 0x5ed7f54f
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [5e+00, 5e+01]
  RHS range        [1e-02, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 154248 rows and 34830 columns
Presolve time: 0.13s
Presolved: 13632 rows, 45475 columns, 93121 nonzeros

Ordering time: 0.44s

Barrier statistics:
 AA' NZ     : 5.273e+04
 Factor NZ  : 8.364e+05 (roughly 30 MBytes of memory)
 Factor Ops : 1.557e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.23262263e+12 -1.96492024e+12  4.09e+04 1.40e+04  6.62e+08     1s
   1   2.85206587e+11 -1.13617681e+12  4.79e+03 5.25e+03  8.55e+07     1s
   2   2.74704389e+10 -2.86112148e+11  3.63e+02 3.49e-10  8.16e+06     1s
   3   8.82491952e+09 -4.60284535e+10  4.24e+01 2.04e-10  1.07e+06     1s
   4   3.96274356e+09 -1.53648284e+10  1.12e+01 1.75e-10  3.05e+05     1s
   5   1.43739203e+09 -5.62278297e+09  4.23e+00 1.46e-10  9.95e+04     1s
   6   4.04452975e+08 -1.86661780e+09  1.21e+00 1.18e-10  2.85e+04     1s
   7   4.27311993e+07 -6.79266306e+08  3.14e-02 1.18e-10  7.99e+03     1s
   8   3.65465086e+07 -2.81264754e+08  1.96e-02 6.34e-11  3.51e+03     1s
   9   2.87405020e+07 -1.57118544e+08  9.93e-03 8.84e-11  2.05e+03     1s
  10   2.67947217e+07 -9.46855598e+07  8.62e-03 5.93e-11  1.34e+03     1s
  11   2.25343437e+07 -6.14911839e+07  5.93e-03 4.48e-11  9.25e+02     1s
  12   1.99680501e+07 -3.18109394e+07  4.53e-03 3.43e-11  5.70e+02     1s
  13   1.68552901e+07 -1.40514542e+07  2.97e-03 4.48e-11  3.40e+02     1s
  14   1.46760575e+07 -5.36659552e+06  1.94e-03 3.02e-11  2.21e+02     1s
  15   1.39034768e+07 -1.68896893e+06  1.60e-03 3.02e-11  1.72e+02     1s
  16   1.27788790e+07  2.16068261e+06  1.12e-03 1.46e-11  1.17e+02     1s
  17   1.22978609e+07  4.43384341e+06  9.27e-04 1.61e-11  8.65e+01     1s
  18   1.11774269e+07  6.96230375e+06  5.05e-04 1.46e-11  4.64e+01     1s
  19   1.05742987e+07  8.45516312e+06  3.16e-04 2.91e-11  2.33e+01     1s
  20   1.02730236e+07  8.94785096e+06  2.05e-04 2.91e-11  1.46e+01     1s
  21   1.00856595e+07  9.30599154e+06  1.38e-04 1.46e-11  8.57e+00     1s
  22   1.00231399e+07  9.43042729e+06  1.16e-04 2.91e-11  6.52e+00     1s
  23   9.94071837e+06  9.50946383e+06  8.79e-05 1.46e-11  4.74e+00     1s
  24   9.84427315e+06  9.56857092e+06  5.52e-05 2.91e-11  3.03e+00     1s
  25   9.81458028e+06  9.61018106e+06  4.53e-05 1.46e-11  2.25e+00     1s
  26   9.75880356e+06  9.62406374e+06  2.77e-05 1.46e-11  1.48e+00     1s
  27   9.74619353e+06  9.63689469e+06  2.35e-05 2.91e-11  1.20e+00     1s
  28   9.73114007e+06  9.64216446e+06  1.88e-05 1.46e-11  9.78e-01     1s
  29   9.72135805e+06  9.65619021e+06  1.57e-05 1.46e-11  7.17e-01     1s
  30   9.68946435e+06  9.66264141e+06  5.01e-06 1.46e-11  2.95e-01     1s
  31   9.68377999e+06  9.66939309e+06  3.16e-06 1.46e-11  1.58e-01     1s
  32   9.68065676e+06  9.67104977e+06  2.18e-06 1.46e-11  1.06e-01     1s
  33   9.67952255e+06  9.67150367e+06  1.83e-06 1.46e-11  8.82e-02     1s
  34   9.67879572e+06  9.67160977e+06  1.61e-06 2.18e-11  7.90e-02     2s
  35   9.67726206e+06  9.67268347e+06  1.14e-06 1.46e-11  5.03e-02     2s
  36   9.67616676e+06  9.67287708e+06  8.04e-07 1.46e-11  3.62e-02     2s
  37   9.67485743e+06  9.67318469e+06  4.12e-07 1.46e-11  1.84e-02     2s
  38   9.67453256e+06  9.67329971e+06  3.16e-07 1.46e-11  1.36e-02     2s
  39   9.67438520e+06  9.67333267e+06  2.72e-07 1.46e-11  1.16e-02     2s
  40   9.67397791e+06  9.67335150e+06  1.51e-07 1.46e-11  6.89e-03     2s
  41   9.67388638e+06  9.67341900e+06  1.25e-07 1.46e-11  5.14e-03     2s
  42   9.67368755e+06  9.67343886e+06  1.53e-07 1.46e-11  2.73e-03     2s
  43   9.67364489e+06  9.67345276e+06  1.67e-07 2.91e-11  2.11e-03     2s
  44   9.67356716e+06  9.67345487e+06  1.39e-07 2.91e-11  1.23e-03     2s
  45   9.67350133e+06  9.67345780e+06  2.38e-07 2.91e-11  4.79e-04     2s
  46   9.67346997e+06  9.67345948e+06  9.94e-08 4.37e-11  1.15e-04     2s
  47   9.67346215e+06  9.67346096e+06  1.41e-07 5.82e-11  1.31e-05     2s
  48   9.67346126e+06  9.67346123e+06  1.03e-07 5.82e-11  2.97e-07     2s
  49   9.67346124e+06  9.67346124e+06  6.59e-09 2.91e-11  1.51e-08     2s
  50   9.67346124e+06  9.67346124e+06  5.33e-09 5.82e-11  3.71e-09     2s

Barrier solved model in 50 iterations and 1.89 seconds
Optimal objective 9.67346124e+06

Crossover log...

    1404 DPushes remaining with DInf 0.0000000e+00                 2s
       0 DPushes remaining with DInf 0.0000000e+00                 2s

     505 PPushes remaining with PInf 1.7000000e-05                 2s
       0 PPushes remaining with PInf 1.8000000e-05                 2s

  Push phase complete: Pinf 1.8000000e-05, Dinf 4.4691803e-10      2s

Iteration    Objective       Primal Inf.    Dual Inf.      Time
    1912    9.6734612e+06   1.200000e-05   0.000000e+00      2s
Extra simplex iterations after uncrush: 30
    1950    9.6734612e+06   0.000000e+00   0.000000e+00      2s

Solved with barrier
Solved in 1950 iterations and 2.48 seconds
Optimal objective  9.673461242e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 9.67e+06
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.78s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-ofj3qjpw.lp
Reading time = 0.11 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0xef9712c1
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [5e+00, 3e+01]
  RHS range        [9e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57049 rows and 22031 columns
Presolve time: 0.05s
Presolved: 3935 rows, 4826 columns, 23599 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.832e+04
 Factor NZ  : 6.452e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.199e+06 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   4.19099735e+07 -2.14275110e+09  1.99e+04 5.68e-14  9.21e+05     0s
   1   2.32059633e+07 -1.00625115e+09  2.44e+03 2.84e-13  1.61e+05     0s
   2   1.98546702e+07 -1.37477523e+08  2.45e+02 1.43e-11  1.86e+04     0s
   3   1.88058433e+07  6.37791652e+06  2.60e+01 1.17e-11  1.38e+03     0s
   4   1.84138351e+07  1.58837543e+07  4.95e+00 6.25e-13  2.68e+02     0s
   5   1.82781439e+07  1.75173878e+07  1.52e+00 1.28e-13  7.96e+01     0s
   6   1.82106413e+07  1.79359753e+07  3.11e-01 2.27e-13  2.85e+01     0s
   7   1.81962801e+07  1.80892172e+07  7.24e-02 5.68e-14  1.11e+01     0s
   8   1.81919292e+07  1.81821418e+07  8.23e-03 6.07e-14  1.02e+00     0s
   9   1.81911760e+07  1.81907416e+07  1.52e-03 1.14e-13  4.53e-02     0s
  10   1.81910020e+07  1.81910006e+07  2.47e-11 1.14e-13  1.44e-04     0s
  11   1.81910018e+07  1.81910018e+07  2.70e-09 5.68e-14  1.80e-06     0s

Barrier performed 11 iterations in 0.21 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with primal simplex
Solved in 5017 iterations and 0.21 seconds
Optimal objective  1.819100180e+07
INFO:pypsa.linopf:Optimization successful. Objective value: 1.82e+07
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


all




all


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 3.23s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-xnatmyc9.lp
Reading time = 0.30 seconds
obj: 167880 rows, 80305 columns, 282380 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 167880 rows, 80305 columns and 282380 nonzeros
Model fingerprint: 0x7a8f64f7
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [5e+00, 3e+01]
  RHS range        [9e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 154262 rows and 34384 columns
Presolve time: 0.16s
Presolved: 13618 rows, 45921 columns, 93553 nonzeros

Ordering time: 0.54s

Barrier statistics:
 AA' NZ     : 5.272e+04
 Factor NZ  : 8.486e+05 (roughly 30 MBytes of memory)
 Factor Ops : 1.643e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.72086698e+12 -1.97968890e+12  5.65e+04 1.15e+04  9.27e+08     1s
   1   3.83491500e+11 -1.20553482e+12  6.05e+03 3.66e+02  1.08e+08     1s
   2   3.39149907e+10 -3.75513414e+11  4.39e+02 2.04e-10  1.04e+07     1s
   3   1.01804339e+10 -4.64339904e+10  5.08e+01 1.75e-10  1.21e+06     1s
   4   4.58412020e+09 -1.77634185e+10  1.34e+01 2.47e-10  3.68e+05     1s
   5   1.55330998e+09 -6.13010143e+09  4.92e+00 2.33e-10  1.13e+05     1s
   6   4.39338426e+08 -2.66065624e+09  1.44e+00 1.75e-10  3.92e+04     1s
   7   7.14857679e+07 -7.51710520e+08  1.41e-01 1.36e-10  9.22e+03     1s
   8   5.29987373e+07 -3.27534853e+08  8.65e-02 1.30e-10  4.23e+03     1s
   9   3.29789328e+07 -1.62313068e+08  3.80e-02 1.30e-10  2.15e+03     1s
  10   2.72642659e+07 -1.03888444e+08  2.77e-02 1.30e-10  1.44e+03     1s
  11   2.01196825e+07 -6.77196748e+07  1.61e-02 1.01e-10  9.63e+02     1s
  12   1.83725290e+07 -4.77082429e+07  1.38e-02 7.79e-11  7.24e+02     1s
  13   1.39805104e+07 -1.86319424e+07  8.27e-03 7.15e-11  3.57e+02     1s
  14   1.07866836e+07 -9.69400906e+06  4.47e-03 5.70e-11  2.24e+02     1s
  15   9.62740165e+06 -4.56157783e+06  3.22e-03 4.24e-11  1.55e+02     1s
  16   9.19109370e+06 -2.01157319e+06  2.77e-03 2.79e-11  1.22e+02     1s
  17   8.45325196e+06  9.03304358e+05  2.05e-03 2.06e-11  8.23e+01     1s
  18   7.79905827e+06  3.38240400e+06  1.43e-03 2.91e-11  4.81e+01     1s
  19   7.09726299e+06  4.75761565e+06  8.03e-04 1.46e-11  2.55e+01     1s
  20   6.78842356e+06  5.27209643e+06  5.47e-04 2.18e-11  1.65e+01     1s
  21   6.64802030e+06  5.64002771e+06  4.27e-04 2.91e-11  1.10e+01     1s
  22   6.51782181e+06  5.81462231e+06  3.19e-04 1.46e-11  7.66e+00     1s
  23   6.43822719e+06  5.90035869e+06  2.53e-04 1.46e-11  5.86e+00     1s
  24   6.40028561e+06  5.94924441e+06  2.23e-04 2.91e-11  4.91e+00     1s
  25   6.25358477e+06  6.02791841e+06  1.08e-04 1.46e-11  2.46e+00     1s
  26   6.21708561e+06  6.05425874e+06  8.29e-05 2.91e-11  1.77e+00     2s
  27   6.18945352e+06  6.06882446e+06  6.07e-05 2.91e-11  1.31e+00     2s
  28   6.16442540e+06  6.08204423e+06  4.08e-05 2.91e-11  8.97e-01     2s
  29   6.14214106e+06  6.09537885e+06  2.36e-05 1.46e-11  5.09e-01     2s
  30   6.12404343e+06  6.10313553e+06  9.84e-06 2.91e-11  2.28e-01     2s
  31   6.12004310e+06  6.10652056e+06  6.99e-06 2.91e-11  1.47e-01     2s
  32   6.11301013e+06  6.10914514e+06  1.98e-06 2.91e-11  4.21e-02     2s
  33   6.11186631e+06  6.10949374e+06  1.20e-06 2.91e-11  2.58e-02     2s
  34   6.11046113e+06  6.10993204e+06  2.63e-07 5.82e-11  5.76e-03     2s
  35   6.11015841e+06  6.10999754e+06  8.50e-08 2.91e-11  1.75e-03     2s
  36   6.11008903e+06  6.11003022e+06  4.28e-08 5.82e-11  6.40e-04     2s
  37   6.11006839e+06  6.11003559e+06  4.55e-08 5.82e-11  3.57e-04     2s
  38   6.11005345e+06  6.11003900e+06  9.47e-08 5.82e-11  1.57e-04     2s
  39   6.11005093e+06  6.11003925e+06  7.65e-08 5.82e-11  1.27e-04     2s
  40   6.11004778e+06  6.11004003e+06  5.37e-08 5.82e-11  8.44e-05     2s
  41   6.11004067e+06  6.11004029e+06  1.44e-09 5.82e-11  4.10e-06     2s
  42   6.11004040e+06  6.11004034e+06  1.88e-09 5.82e-11  6.41e-07     2s
  43   6.11004036e+06  6.11004035e+06  2.51e-09 5.82e-11  9.14e-08     2s
  44   6.11004035e+06  6.11004035e+06  5.94e-09 5.82e-11  5.77e-09     2s

Barrier solved model in 44 iterations and 2.23 seconds
Optimal objective 6.11004035e+06

Crossover log...

    1348 DPushes remaining with DInf 0.0000000e+00                 2s
       0 DPushes remaining with DInf 0.0000000e+00                 2s

     424 PPushes remaining with PInf 4.8000000e-05                 2s
       0 PPushes remaining with PInf 5.1000000e-05                 3s

  Push phase complete: Pinf 5.1000000e-05, Dinf 5.0211288e-10      3s

Iteration    Objective       Primal Inf.    Dual Inf.      Time
    1775    6.1100404e+06   4.500000e-05   0.000000e+00      3s
Extra simplex iterations after uncrush: 51
    1848    6.1100404e+06   0.000000e+00   0.000000e+00      3s

Solved with barrier
Solved in 1848 iterations and 2.81 seconds
Optimal objective  6.110040350e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 6.11e+06
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.74s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-deh2t4nf.lp
Reading time = 0.11 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0xe1a2562c
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [5e+00, 3e+01]
  RHS range        [9e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57048 rows and 22035 columns
Presolve time: 0.05s
Presolved: 3936 rows, 4822 columns, 23596 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.833e+04
 Factor NZ  : 6.453e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.199e+06 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   5.86430600e+07 -2.11555047e+09  2.14e+04 1.14e-13  9.64e+05     0s

Barrier performed 0 iterations in 0.19 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with primal simplex
Solved in 5114 iterations and 0.20 seconds
Optimal objective  2.577535069e+07
INFO:pypsa.linopf:Optimization successful. Objective value: 2.58e+07
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


all




all


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 3.25s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-6kf9qhpi.lp
Reading time = 0.29 seconds
obj: 167880 rows, 80305 columns, 282380 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 167880 rows, 80305 columns and 282380 nonzeros
Model fingerprint: 0xbe784f0c
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [5e+00, 3e+01]
  RHS range        [9e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 154263 rows and 34545 columns
Presolve time: 0.15s
Presolved: 13617 rows, 45760 columns, 93391 nonzeros

Ordering time: 0.67s

Barrier statistics:
 AA' NZ     : 5.272e+04
 Factor NZ  : 8.651e+05 (roughly 30 MBytes of memory)
 Factor Ops : 1.723e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.72808087e+12 -1.97174740e+12  5.68e+04 1.14e+04  9.31e+08     1s
   1   3.82664617e+11 -1.20592454e+12  6.08e+03 3.37e+00  1.09e+08     1s
   2   3.36217150e+10 -3.75070200e+11  4.35e+02 2.04e-10  1.04e+07     1s
   3   9.96077428e+09 -4.47322837e+10  4.68e+01 6.11e-10  1.15e+06     1s
   4   4.78538508e+09 -1.65556644e+10  1.44e+01 2.33e-10  3.68e+05     1s
   5   2.27172751e+09 -5.94900172e+09  6.77e+00 1.75e-10  1.32e+05     1s
   6   4.11983566e+08 -2.40136225e+09  1.38e+00 1.88e-10  3.61e+04     1s
   7   1.67535743e+08 -7.84258788e+08  4.94e-01 1.59e-10  1.14e+04     1s
   8   9.79822477e+07 -4.01170101e+08  2.64e-01 1.59e-10  5.79e+03     1s
   9   4.71378400e+07 -2.27806825e+08  1.08e-01 1.01e-10  3.11e+03     1s
  10   3.21138539e+07 -9.89272520e+07  6.73e-02 1.11e-10  1.47e+03     2s
  11   1.18383815e+07 -4.95830833e+07  1.60e-02 1.01e-10  6.77e+02     2s
  12   8.44985900e+06 -2.75124630e+07  9.82e-03 7.15e-11  3.95e+02     2s
  13   5.63348596e+06 -1.04673759e+07  5.05e-03 7.15e-11  1.77e+02     2s
  14   4.46708929e+06 -6.59677601e+06  3.31e-03 4.97e-11  1.21e+02     2s
  15   2.97877225e+06 -1.88163367e+06  1.29e-03 2.91e-11  5.32e+01     2s
  16   2.50560708e+06 -9.89858109e+03  7.31e-04 2.91e-11  2.75e+01     2s
  17   2.15068590e+06  9.39583886e+05  3.41e-04 2.18e-11  1.32e+01     2s
  18   1.90412906e+06  1.45483537e+06  9.20e-05 2.91e-11  4.91e+00     2s
  19   1.84048234e+06  1.64852362e+06  3.72e-05 2.91e-11  2.10e+00     2s
  20   1.81535804e+06  1.71850291e+06  1.87e-05 2.91e-11  1.06e+00     2s
  21   1.80657821e+06  1.73622754e+06  1.29e-05 2.91e-11  7.69e-01     2s
  22   1.79940609e+06  1.76285844e+06  8.41e-06 1.46e-11  3.99e-01     2s
  23   1.79145023e+06  1.76779190e+06  3.84e-06 1.46e-11  2.59e-01     2s
  24   1.78711469e+06  1.77818405e+06  1.50e-06 2.91e-11  9.76e-02     2s
  25   1.78534477e+06  1.78093232e+06  6.90e-07 5.82e-11  4.82e-02     2s
  26   1.78450855e+06  1.78285021e+06  3.25e-07 2.91e-11  1.81e-02     2s
  27   1.78419156e+06  1.78313734e+06  1.94e-07 2.91e-11  1.15e-02     2s
  28   1.78393748e+06  1.78336623e+06  9.01e-08 2.91e-11  6.24e-03     2s
  29   1.78382022e+06  1.78349444e+06  8.66e-08 5.82e-11  3.56e-03     2s
  30   1.78373517e+06  1.78364304e+06  2.07e-08 5.82e-11  1.01e-03     3s
  31   1.78371193e+06  1.78368393e+06  1.47e-08 2.91e-11  3.06e-04     3s
  32   1.78370309e+06  1.78369316e+06  3.70e-08 5.82e-11  1.09e-04     3s
  33   1.78370009e+06  1.78369501e+06  2.68e-08 2.91e-11  5.55e-05     3s

Barrier performed 33 iterations in 2.64 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with dual simplex
Solved in 13776 iterations and 2.65 seconds
Optimal objective  1.783698968e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 1.78e+06
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.75s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-d7uu7v6z.lp
Reading time = 0.11 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0x5e2c919a
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [4e+00, 3e+01]
  RHS range        [9e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57049 rows and 22036 columns
Presolve time: 0.05s
Presolved: 3935 rows, 4821 columns, 23594 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.832e+04
 Factor NZ  : 6.452e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.199e+06 (less than 1 second per iteration)
 Threads    : 30

Barrier performed 0 iterations in 0.19 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with dual simplex
Solved in 2682 iterations and 0.19 seconds
Optimal objective  2.433207575e+07
INFO:pypsa.linopf:Optimization successful. Objective value: 2.43e+07
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


all




all


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 3.23s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-zi6jxwdw.lp
Reading time = 0.29 seconds
obj: 167880 rows, 80305 columns, 282380 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 167880 rows, 80305 columns and 282380 nonzeros
Model fingerprint: 0x7906f53f
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [4e+00, 3e+01]
  RHS range        [9e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 154250 rows and 34014 columns
Presolve time: 0.14s
Presolved: 13630 rows, 46291 columns, 93935 nonzeros

Ordering time: 0.50s

Barrier statistics:
 AA' NZ     : 5.273e+04
 Factor NZ  : 8.620e+05 (roughly 30 MBytes of memory)
 Factor Ops : 1.660e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.23689625e+12 -1.95425886e+12  4.00e+04 9.50e+03  6.62e+08     1s
   1   2.93670996e+11 -1.12506431e+12  4.75e+03 5.13e+03  8.62e+07     1s
   2   3.32062791e+10 -2.85349983e+11  4.27e+02 1.81e-10  9.14e+06     1s
   3   9.17290337e+09 -4.05255308e+10  3.69e+01 4.66e-10  9.67e+05     1s
   4   3.88523356e+09 -1.42073702e+10  8.83e+00 1.75e-10  2.73e+05     1s
   5   1.25650955e+09 -5.83349009e+09  3.13e+00 1.59e-10  9.48e+04     1s
   6   3.26291118e+08 -2.09962702e+09  8.64e-01 1.59e-10  2.88e+04     1s
   7   8.44830720e+07 -7.21613482e+08  1.54e-01 1.59e-10  8.95e+03     1s
   8   5.98264887e+07 -3.50239884e+08  9.59e-02 1.30e-10  4.52e+03     1s
   9   4.01045001e+07 -2.02563472e+08  5.53e-02 1.01e-10  2.66e+03     1s
  10   3.12271629e+07 -9.80337469e+07  3.93e-02 1.01e-10  1.41e+03     1s
  11   1.86444122e+07 -5.68626772e+07  1.86e-02 1.01e-10  8.22e+02     1s
  12   1.26202012e+07 -2.63498407e+07  1.04e-02 1.01e-10  4.23e+02     1s
  13   6.74428301e+06 -1.05545460e+07  3.42e-03 5.70e-11  1.87e+02     1s
  14   4.93865678e+06 -5.05638790e+06  1.81e-03 5.70e-11  1.08e+02     1s
  15   3.56674097e+06 -5.19837293e+05  6.77e-04 2.91e-11  4.42e+01     1s
  16   3.13507725e+06  1.01738421e+06  3.65e-04 2.91e-11  2.29e+01     1s
  17   2.71163034e+06  1.71689750e+06  7.90e-05 1.46e-11  1.07e+01     1s
  18   2.60048053e+06  2.25736503e+06  1.65e-05 2.91e-11  3.71e+00     2s
  19   2.57262393e+06  2.39405714e+06  4.96e-06 1.46e-11  1.93e+00     2s
  20   2.56415232e+06  2.47432539e+06  2.72e-06 2.91e-11  9.70e-01     2s
  21   2.55508004e+06  2.51742144e+06  8.69e-07 1.46e-11  4.07e-01     2s
  22   2.55209006e+06  2.53800299e+06  4.54e-07 2.91e-11  1.52e-01     2s
  23   2.54935853e+06  2.54457670e+06  1.26e-07 2.91e-11  5.17e-02     2s
  24   2.54836014e+06  2.54683835e+06  2.38e-08 2.91e-11  1.64e-02     2s
  25   2.54818803e+06  2.54755407e+06  1.21e-08 2.91e-11  6.85e-03     2s
  26   2.54807243e+06  2.54793972e+06  1.13e-08 4.37e-11  1.43e-03     2s
  27   2.54805423e+06  2.54800559e+06  1.67e-08 2.91e-11  5.25e-04     2s
  28   2.54804522e+06  2.54803638e+06  1.19e-08 2.91e-11  9.55e-05     2s
  29   2.54804311e+06  2.54804110e+06  1.63e-07 2.91e-11  2.17e-05     2s
  30   2.54804235e+06  2.54804207e+06  1.57e-07 8.73e-11  3.04e-06     2s
  31   2.54804231e+06  2.54804227e+06  2.48e-07 5.82e-11  4.77e-07     2s
  32   2.54804231e+06  2.54804231e+06  2.54e-07 8.73e-11  1.00e-08     2s

Barrier solved model in 32 iterations and 2.06 seconds
Optimal objective 2.54804231e+06

Crossover log...

    1771 DPushes remaining with DInf 0.0000000e+00                 2s
       0 DPushes remaining with DInf 0.0000000e+00                 2s

     396 PPushes remaining with PInf 0.0000000e+00                 2s
       0 PPushes remaining with PInf 0.0000000e+00                 2s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.1248071e-10      2s

Iteration    Objective       Primal Inf.    Dual Inf.      Time
    2170    2.5480423e+06   0.000000e+00   0.000000e+00      2s

Solved with barrier
Solved in 2170 iterations and 2.42 seconds
Optimal objective  2.548042309e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 2.55e+06
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.78s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-jfyd_ek6.lp
Reading time = 0.11 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0x0db93897
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [4e+00, 3e+01]
  RHS range        [8e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57048 rows and 22036 columns
Presolve time: 0.05s
Presolved: 3936 rows, 4821 columns, 23595 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.833e+04
 Factor NZ  : 6.453e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.199e+06 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   5.74986106e+07 -2.10928108e+09  2.04e+04 1.14e-13  9.28e+05     0s
   1   3.34509793e+07 -9.96564367e+08  2.07e+03 2.84e-13  1.53e+05     0s
   2   2.87338390e+07 -1.30254293e+08  2.28e+02 2.84e-13  1.86e+04     0s
   3   2.71837362e+07  5.56209806e+06  2.22e+01 1.51e-11  2.33e+03     0s
   4   2.68426091e+07  2.18305929e+07  2.80e+00 3.78e-12  5.24e+02     0s
   5   2.66762523e+07  2.49570006e+07  1.02e+00 1.17e-12  1.79e+02     0s
   6   2.65539676e+07  2.60582068e+07  2.74e-01 3.12e-13  5.15e+01     0s
   7   2.65205528e+07  2.63430840e+07  7.26e-02 9.77e-14  1.84e+01     0s
   8   2.65098486e+07  2.64828116e+07  4.93e-03 5.95e-14  2.80e+00     0s

Barrier performed 8 iterations in 0.20 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with primal simplex
Solved in 5212 iterations and 0.20 seconds
Optimal objective  2.650861745e+07
INFO:pypsa.linopf:Optimization successful. Objective value: 2.65e+07
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


all




all


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 3.24s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-4qffdba7.lp
Reading time = 0.29 seconds
obj: 167880 rows, 80305 columns, 282380 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 167880 rows, 80305 columns and 282380 nonzeros
Model fingerprint: 0xe028cf90
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [4e+00, 3e+01]
  RHS range        [8e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 154257 rows and 34131 columns
Presolve time: 0.15s
Presolved: 13623 rows, 46174 columns, 93811 nonzeros

Ordering time: 0.67s

Barrier statistics:
 AA' NZ     : 5.272e+04
 Factor NZ  : 8.220e+05 (roughly 30 MBytes of memory)
 Factor Ops : 1.521e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.72260870e+12 -1.97872766e+12  5.66e+04 9.64e+03  9.27e+08     1s
   1   3.94285705e+11 -1.20355123e+12  6.37e+03 2.10e+02  1.13e+08     1s
   2   3.32690228e+10 -3.84285279e+11  4.37e+02 1.88e-10  1.05e+07     1s
   3   9.65195685e+09 -4.89340956e+10  4.46e+01 5.24e-10  1.16e+06     1s
   4   4.77287770e+09 -1.76661384e+10  1.43e+01 2.33e-10  3.77e+05     1s
   5   1.54813027e+09 -5.77879574e+09  5.03e+00 1.75e-10  1.11e+05     1s
   6   3.57498131e+08 -2.04300011e+09  1.24e+00 1.59e-10  3.04e+04     1s
   7   5.99145339e+07 -7.67553476e+08  1.12e-01 1.59e-10  9.18e+03     1s
   8   3.84827749e+07 -3.70251570e+08  5.50e-02 1.30e-10  4.49e+03     1s
   9   2.34830134e+07 -1.61178385e+08  2.41e-02 1.30e-10  2.02e+03     1s
  10   1.54122552e+07 -8.29335919e+07  1.28e-02 7.15e-11  1.07e+03     1s
  11   8.56315230e+06 -4.54426561e+07  4.89e-03 1.01e-10  5.86e+02     1s
  12   5.94241386e+06 -1.95961494e+07  2.59e-03 5.70e-11  2.77e+02     1s
  13   3.40306567e+06 -7.32401065e+06  7.14e-04 3.51e-11  1.16e+02     1s
  14   2.52443035e+06 -2.24216739e+06  2.84e-04 2.91e-11  5.16e+01     1s
  15   2.09209262e+06 -9.57462163e+04  1.11e-04 1.46e-11  2.37e+01     1s
  16   1.98517209e+06  6.91280084e+05  7.61e-05 2.91e-11  1.40e+01     1s
  17   1.84451150e+06  1.16062614e+06  3.42e-05 2.91e-11  7.41e+00     1s
  18   1.73455922e+06  1.48566687e+06  5.05e-06 5.82e-11  2.70e+00     2s
  19   1.71387851e+06  1.60182944e+06  1.79e-06 2.91e-11  1.21e+00     2s
  20   1.70410764e+06  1.64686125e+06  7.57e-07 2.91e-11  6.20e-01     2s
  21   1.69856214e+06  1.66954862e+06  2.84e-07 2.91e-11  3.14e-01     2s
  22   1.69532069e+06  1.68288051e+06  8.22e-08 2.91e-11  1.35e-01     2s
  23   1.69456875e+06  1.68928281e+06  4.63e-08 2.91e-11  5.72e-02     2s
  24   1.69388123e+06  1.69116577e+06  2.04e-08 2.91e-11  2.94e-02     2s
  25   1.69355170e+06  1.69246616e+06  2.39e-08 2.91e-11  1.18e-02     2s
  26   1.69347020e+06  1.69291963e+06  4.35e-08 2.91e-11  5.96e-03     2s
  27   1.69343083e+06  1.69304473e+06  2.85e-08 2.91e-11  4.18e-03     2s
  28   1.69338338e+06  1.69326761e+06  8.29e-08 2.91e-11  1.25e-03     2s
  29   1.69336975e+06  1.69331890e+06  2.89e-08 2.91e-11  5.51e-04     2s
  30   1.69336375e+06  1.69335148e+06  2.95e-08 5.82e-11  1.33e-04     2s
  31   1.69336225e+06  1.69335869e+06  3.59e-08 2.91e-11  3.86e-05     2s
  32   1.69336169e+06  1.69336149e+06  7.28e-09 5.82e-11  2.11e-06     2s
  33   1.69336157e+06  1.69336152e+06  2.32e-09 5.82e-11  5.95e-07     2s
  34   1.69336153e+06  1.69336152e+06  1.23e-08 5.82e-11  1.20e-07     2s
  35   1.69336152e+06  1.69336152e+06  2.13e-07 5.82e-11  2.16e-08     2s
  36   1.69336152e+06  1.69336152e+06  2.84e-08 5.82e-11  2.70e-09     2s

Barrier solved model in 36 iterations and 2.28 seconds
Optimal objective 1.69336152e+06

Crossover log...

    1563 DPushes remaining with DInf 0.0000000e+00                 2s
       0 DPushes remaining with DInf 0.0000000e+00                 3s

     426 PPushes remaining with PInf 1.9000000e-05                 3s
       0 PPushes remaining with PInf 1.9000000e-05                 3s

  Push phase complete: Pinf 1.9000000e-05, Dinf 2.5279512e-10      3s

Iteration    Objective       Primal Inf.    Dual Inf.      Time
    1992    1.6933615e+06   3.000000e-06   0.000000e+00      3s
Extra simplex iterations after uncrush: 37
    2032    1.6933615e+06   0.000000e+00   0.000000e+00      3s

Solved with barrier
Solved in 2032 iterations and 2.84 seconds
Optimal objective  1.693361519e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 1.69e+06
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.74s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-b1xi4km4.lp
Reading time = 0.10 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0xa0b5ff0a
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [4e+00, 3e+01]
  RHS range        [8e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57048 rows and 22035 columns
Presolve time: 0.05s
Presolved: 3936 rows, 4822 columns, 23596 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.833e+04
 Factor NZ  : 6.453e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.199e+06 (less than 1 second per iteration)
 Threads    : 30

Barrier performed 0 iterations in 0.20 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with primal simplex
Solved in 4742 iterations and 0.20 seconds
Optimal objective  1.928384494e+07
INFO:pypsa.linopf:Optimization successful. Objective value: 1.93e+07
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


all




all


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 3.23s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-onwatbqy.lp
Reading time = 0.29 seconds
obj: 167880 rows, 80305 columns, 282380 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 167880 rows, 80305 columns and 282380 nonzeros
Model fingerprint: 0x9894a833
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [4e+00, 3e+01]
  RHS range        [1e-06, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 154256 rows and 35246 columns
Presolve time: 0.16s
Presolved: 13624 rows, 45059 columns, 92697 nonzeros

Ordering time: 0.80s

Barrier statistics:
 AA' NZ     : 5.273e+04
 Factor NZ  : 8.517e+05 (roughly 30 MBytes of memory)
 Factor Ops : 1.639e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.73252607e+12 -2.05111841e+12  5.68e+04 1.13e+04  9.44e+08     1s
   1   3.87414624e+11 -1.21865526e+12  6.47e+03 2.11e-10  1.16e+08     1s
   2   3.18879866e+10 -3.90095627e+11  4.39e+02 2.04e-10  1.07e+07     2s
   3   9.09789710e+09 -4.97065660e+10  4.68e+01 1.25e-09  1.22e+06     2s
   4   5.93184443e+09 -1.81117954e+10  1.69e+01 4.66e-10  4.28e+05     2s
   5   2.64389035e+09 -8.67666965e+09  7.97e+00 3.20e-10  1.83e+05     2s
   6   4.63732473e+08 -2.61598810e+09  1.68e+00 2.91e-10  4.13e+04     2s
   7   3.81807032e+07 -7.18275904e+08  4.36e-02 1.88e-10  8.48e+03     2s
   8   2.74336291e+07 -3.17004153e+08  2.03e-02 1.59e-10  3.84e+03     2s
   9   1.68197391e+07 -1.41227226e+08  6.18e-03 1.01e-10  1.76e+03     2s
  10   1.09789363e+07 -5.35324452e+07  2.50e-03 1.01e-10  7.17e+02     2s
  11   5.83870327e+06 -1.83765982e+07  6.33e-04 5.70e-11  2.69e+02     2s
  12   4.37622246e+06 -6.65275150e+06  2.96e-04 4.97e-11  1.22e+02     2s
  13   3.34241697e+06 -1.71488532e+06  9.26e-05 2.42e-11  5.61e+01     2s
  14   3.08302782e+06  2.65065348e+05  5.55e-05 1.46e-11  3.13e+01     2s
  15   2.76419458e+06  1.53449200e+06  1.52e-05 2.91e-11  1.36e+01     2s
  16   2.69305978e+06  1.98507424e+06  8.74e-06 1.46e-11  7.86e+00     2s
  17   2.65452575e+06  2.25606840e+06  5.73e-06 1.46e-11  4.42e+00     2s
  18   2.59999555e+06  2.43290662e+06  1.89e-06 2.91e-11  1.85e+00     2s

Barrier performed 18 iterations in 2.41 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with dual simplex
Solved in 13391 iterations and 2.41 seconds
Optimal objective  2.556824494e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 2.56e+06
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.76s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-tw8i69us.lp
Reading time = 0.11 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0xac78a863
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [2e+00, 2e+01]
  RHS range        [5e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57048 rows and 22024 columns
Presolve time: 0.05s
Presolved: 3936 rows, 4833 columns, 23607 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.833e+04
 Factor NZ  : 6.453e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.199e+06 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   4.27141698e+07 -2.03386365e+09  2.12e+04 1.14e-13  9.14e+05     0s
   1   2.22291521e+07 -9.88034690e+08  2.37e+03 2.84e-13  1.55e+05     0s

Barrier performed 1 iterations in 0.18 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with dual simplex
Solved in 2721 iterations and 0.20 seconds
Optimal objective  1.717764501e+07
INFO:pypsa.linopf:Optimization successful. Objective value: 1.72e+07
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


all




all


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 3.22s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-d280yxua.lp
Reading time = 0.29 seconds
obj: 167880 rows, 80305 columns, 282380 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 167880 rows, 80305 columns and 282380 nonzeros
Model fingerprint: 0x0a131906
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [2e+00, 2e+01]
  RHS range        [5e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 154248 rows and 34790 columns
Presolve time: 0.14s
Presolved: 13632 rows, 45515 columns, 93161 nonzeros

Ordering time: 0.53s

Barrier statistics:
 AA' NZ     : 5.273e+04
 Factor NZ  : 8.364e+05 (roughly 30 MBytes of memory)
 Factor Ops : 1.557e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.73028598e+12 -1.99836336e+12  5.29e+04 1.11e+04  9.30e+08     1s
   1   3.82970832e+11 -1.19847317e+12  5.72e+03 4.14e+02  1.10e+08     1s
   2   3.25111875e+10 -3.70212809e+11  4.08e+02 2.04e-10  1.04e+07     1s
   3   8.65367263e+09 -4.54204629e+10  4.06e+01 1.75e-10  1.11e+06     1s
   4   4.08260046e+09 -1.57545917e+10  1.26e+01 2.62e-10  3.43e+05     1s
   5   8.87331574e+08 -5.06865978e+09  3.22e+00 2.33e-10  8.64e+04     1s
   6   4.17128514e+07 -1.01342852e+09  7.88e-02 1.65e-10  1.18e+04     1s
   7   2.65146474e+07 -5.01568333e+08  2.58e-02 1.01e-10  5.85e+03     1s
   8   2.17033987e+07 -2.57808208e+08  1.76e-02 1.01e-10  3.09e+03     1s
   9   1.33634484e+07 -8.26830868e+07  7.02e-03 1.30e-10  1.06e+03     1s
  10   9.82836996e+06 -3.56183081e+07  4.16e-03 7.15e-11  5.00e+02     1s
  11   5.15945402e+06 -1.52519329e+07  1.10e-03 7.15e-11  2.24e+02     1s
  12   3.97448697e+06 -6.38843343e+06  5.81e-04 4.24e-11  1.14e+02     1s
  13   3.09890384e+06 -2.44017359e+06  2.66e-04 3.51e-11  6.09e+01     1s
  14   2.95826944e+06 -1.29930225e+06  2.21e-04 2.91e-11  4.68e+01     1s
  15   2.58853212e+06 -2.00883717e+05  1.10e-04 1.69e-11  3.06e+01     1s
  16   2.45906936e+06  7.06959210e+05  7.56e-05 1.46e-11  1.92e+01     1s
  17   2.29298448e+06  1.39519529e+06  3.47e-05 1.46e-11  9.86e+00     2s
  18   2.15474350e+06  1.98298572e+06  5.22e-06 2.18e-11  1.89e+00     2s
  19   2.13149086e+06  2.05990578e+06  2.45e-06 2.91e-11  7.86e-01     2s
  20   2.11933471e+06  2.08998502e+06  1.18e-06 1.46e-11  3.22e-01     2s
  21   2.11413956e+06  2.09825461e+06  6.96e-07 1.46e-11  1.75e-01     2s
  22   2.11170816e+06  2.10156975e+06  4.79e-07 1.46e-11  1.11e-01     2s
  23   2.10943543e+06  2.10346539e+06  2.81e-07 1.46e-11  6.56e-02     2s
  24   2.10727286e+06  2.10491467e+06  1.01e-07 1.46e-11  2.59e-02     2s
  25   2.10686403e+06  2.10555586e+06  6.86e-08 2.91e-11  1.44e-02     2s
  26   2.10612828e+06  2.10586423e+06  1.81e-08 2.91e-11  2.90e-03     2s
  27   2.10601472e+06  2.10592626e+06  5.13e-09 2.91e-11  9.72e-04     2s
  28   2.10597937e+06  2.10596170e+06  4.09e-09 2.91e-11  1.94e-04     2s
  29   2.10597279e+06  2.10596833e+06  2.08e-09 2.91e-11  4.90e-05     2s
  30   2.10597059e+06  2.10597029e+06  2.05e-09 5.82e-11  3.30e-06     2s
  31   2.10597057e+06  2.10597056e+06  2.02e-09 8.73e-11  1.30e-07     2s
  32   2.10597057e+06  2.10597057e+06  2.78e-09 8.73e-11  1.52e-08     2s
  33   2.10597057e+06  2.10597057e+06  1.23e-09 2.91e-11  4.36e-09     2s

Barrier solved model in 33 iterations and 1.93 seconds
Optimal objective 2.10597057e+06

Crossover log...

    1964 DPushes remaining with DInf 0.0000000e+00                 2s
       0 DPushes remaining with DInf 0.0000000e+00                 2s

     367 PPushes remaining with PInf 1.1000000e-05                 2s
       0 PPushes remaining with PInf 1.4000000e-05                 2s

  Push phase complete: Pinf 1.4000000e-05, Dinf 4.8933618e-10      2s

Iteration    Objective       Primal Inf.    Dual Inf.      Time
    2334    2.1059706e+06   1.300000e-05   0.000000e+00      2s
Extra simplex iterations after uncrush: 51
    2398    2.1059706e+06   0.000000e+00   0.000000e+00      2s

Solved with barrier
Solved in 2398 iterations and 2.19 seconds
Optimal objective  2.105970568e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 2.11e+06
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.78s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-qwv8laeu.lp
Reading time = 0.11 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0x709d253f
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [2e+00, 1e+01]
  RHS range        [4e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57048 rows and 22035 columns
Presolve time: 0.05s
Presolved: 3936 rows, 4822 columns, 23596 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.833e+04
 Factor NZ  : 6.453e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.199e+06 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   5.46843600e+07 -2.03379616e+09  1.96e+04 1.14e-13  8.65e+05     0s
   1   3.16476491e+07 -9.36458400e+08  2.06e+03 3.41e-13  1.43e+05     0s
   2   2.69115009e+07 -1.14173349e+08  2.26e+02 2.84e-12  1.66e+04     0s
   3   2.56144078e+07  1.15201765e+07  2.25e+01 4.12e-13  1.55e+03     0s
   4   2.52879223e+07  2.10275770e+07  3.90e+00 1.02e-12  4.48e+02     0s
   5   2.51636513e+07  2.28320339e+07  1.79e+00 5.97e-13  2.43e+02     0s
   6   2.50636674e+07  2.40966100e+07  5.63e-01 1.85e-13  1.01e+02     0s
   7   2.50368140e+07  2.46642075e+07  4.12e-01 8.90e-14  3.87e+01     0s
   8   2.49459689e+07  2.47856305e+07  4.83e-02 5.68e-14  1.66e+01     0s

Barrier performed 8 iterations in 0.20 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with primal simplex
Solved in 4950 iterations and 0.20 seconds
Optimal objective  2.492696321e+07
INFO:pypsa.linopf:Optimization successful. Objective value: 2.49e+07
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


all




all


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 3.22s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-p7dl5bwc.lp
Reading time = 0.30 seconds
obj: 167880 rows, 80305 columns, 282380 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 167880 rows, 80305 columns and 282380 nonzeros
Model fingerprint: 0x82d161fd
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [2e+00, 1e+01]
  RHS range        [4e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 154248 rows and 34757 columns
Presolve time: 0.14s
Presolved: 13632 rows, 45548 columns, 93194 nonzeros

Ordering time: 0.62s

Barrier statistics:
 AA' NZ     : 5.273e+04
 Factor NZ  : 8.364e+05 (roughly 30 MBytes of memory)
 Factor Ops : 1.557e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.71806998e+12 -2.01783365e+12  5.64e+04 1.80e-11  9.63e+08     1s
   1   3.69148251e+11 -1.24118008e+12  5.52e+03 2.11e-10  1.04e+08     1s
   2   3.41616664e+10 -3.74155542e+11  4.15e+02 2.91e-10  1.04e+07     1s
   3   9.86050365e+09 -4.53386582e+10  3.63e+01 5.27e-09  1.05e+06     1s
   4   5.32101071e+09 -1.75885342e+10  1.18e+01 1.47e-09  3.65e+05     1s
   5   1.95392989e+09 -6.84343049e+09  4.54e+00 6.69e-10  1.26e+05     1s
   6   3.75526321e+08 -2.88748821e+09  9.85e-01 2.91e-10  3.97e+04     2s
   7   2.09894504e+08 -7.16223128e+08  5.23e-01 1.88e-10  1.11e+04     2s
   8   8.37999986e+07 -3.61860191e+08  1.75e-01 1.30e-10  5.11e+03     2s
   9   4.20094700e+07 -1.52152616e+08  7.08e-02 1.30e-10  2.19e+03     2s
  10   2.23888147e+07 -5.91365263e+07  3.05e-02 1.30e-10  9.12e+02     2s
  11   1.29736184e+07 -2.64784275e+07  1.42e-02 1.01e-10  4.39e+02     2s
  12   7.41206391e+06 -1.06995724e+07  5.72e-03 1.01e-10  2.00e+02     2s
  13   5.16121761e+06 -2.40054269e+06  2.70e-03 7.15e-11  8.33e+01     2s
  14   4.24569784e+06 -1.20709122e+05  1.59e-03 5.82e-11  4.81e+01     2s
  15   3.42474099e+06  1.33312683e+06  6.18e-04 3.51e-11  2.30e+01     2s
  16   3.18490010e+06  2.16037132e+06  3.58e-04 2.91e-11  1.13e+01     2s
  17   3.01427039e+06  2.46755756e+06  1.83e-04 5.82e-11  6.00e+00     2s
  18   2.89612878e+06  2.71268692e+06  6.80e-05 5.82e-11  2.01e+00     2s
  19   2.85939439e+06  2.76028259e+06  3.67e-05 2.91e-11  1.09e+00     2s
  20   2.84829448e+06  2.77113107e+06  2.77e-05 2.91e-11  8.47e-01     2s
  21   2.84118913e+06  2.78976974e+06  2.21e-05 2.91e-11  5.65e-01     2s
  22   2.82849870e+06  2.79754742e+06  1.23e-05 2.91e-11  3.40e-01     3s
  23   2.82063423e+06  2.80369679e+06  6.40e-06 5.82e-11  1.86e-01     3s
  24   2.81368214e+06  2.80697255e+06  1.40e-06 2.91e-11  7.37e-02     3s
  25   2.81258652e+06  2.80917895e+06  6.81e-07 2.91e-11  3.74e-02     3s
  26   2.81214916e+06  2.81017767e+06  4.01e-07 2.91e-11  2.16e-02     3s
  27   2.81208590e+06  2.81093980e+06  3.63e-07 5.82e-11  1.26e-02     3s
  28   2.81164605e+06  2.81118456e+06  1.40e-07 2.91e-11  5.07e-03     3s
  29   2.81155391e+06  2.81130665e+06  8.64e-08 2.91e-11  2.71e-03     3s
  30   2.81149935e+06  2.81142829e+06  3.92e-08 2.91e-11  7.80e-04     3s
  31   2.81148494e+06  2.81145371e+06  4.72e-08 2.91e-11  3.43e-04     3s
  32   2.81147218e+06  2.81146353e+06  6.24e-08 5.82e-11  9.50e-05     3s
  33   2.81146944e+06  2.81146683e+06  2.10e-08 5.82e-11  2.86e-05     3s
  34   2.81146817e+06  2.81146780e+06  1.69e-09 5.82e-11  4.07e-06     3s
  35   2.81146804e+06  2.81146802e+06  9.35e-10 5.82e-11  3.07e-07     3s
  36   2.81146803e+06  2.81146803e+06  1.29e-09 5.82e-11  4.97e-08     3s
  37   2.81146803e+06  2.81146803e+06  2.02e-09 5.82e-11  2.19e-08     3s
  38   2.81146803e+06  2.81146803e+06  2.66e-09 5.82e-11  9.40e-09     3s

Barrier solved model in 38 iterations and 3.28 seconds
Optimal objective 2.81146803e+06

Crossover log...

    2253 DPushes remaining with DInf 0.0000000e+00                 3s
       0 DPushes remaining with DInf 0.0000000e+00                 4s

     465 PPushes remaining with PInf 2.5000000e-05                 4s
       0 PPushes remaining with PInf 2.7041667e-05                 4s

  Push phase complete: Pinf 2.7041667e-05, Dinf 3.3568825e-10      4s

Iteration    Objective       Primal Inf.    Dual Inf.      Time
    2721    2.8114680e+06   7.041667e-06   0.000000e+00      4s
Extra simplex iterations after uncrush: 50
    2778    2.8114680e+06   0.000000e+00   0.000000e+00      4s

Solved with barrier
Solved in 2778 iterations and 3.92 seconds
Optimal objective  2.811468032e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 2.81e+06
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.75s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-a_rvm3i_.lp
Reading time = 0.11 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0x766b8d27
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [2e+00, 1e+01]
  RHS range        [4e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57048 rows and 22034 columns
Presolve time: 0.05s
Presolved: 3936 rows, 4823 columns, 23597 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.833e+04
 Factor NZ  : 6.453e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.199e+06 (less than 1 second per iteration)
 Threads    : 30

Barrier performed 0 iterations in 0.21 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with primal simplex
Solved in 5388 iterations and 0.21 seconds
Optimal objective  2.114000389e+07
INFO:pypsa.linopf:Optimization successful. Objective value: 2.11e+07
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


all




all


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 3.25s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-u6f1r3__.lp
Reading time = 0.29 seconds
obj: 167880 rows, 80305 columns, 282380 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 167880 rows, 80305 columns and 282380 nonzeros
Model fingerprint: 0xe9b986e0
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [2e+00, 1e+01]
  RHS range        [1e-06, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 154256 rows and 34483 columns
Presolve time: 0.14s
Presolved: 13624 rows, 45822 columns, 93460 nonzeros

Ordering time: 0.50s

Barrier statistics:
 AA' NZ     : 5.273e+04
 Factor NZ  : 8.446e+05 (roughly 30 MBytes of memory)
 Factor Ops : 1.638e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.71852110e+12 -1.94689429e+12  5.66e+04 1.14e+04  9.28e+08     1s
   1   3.81351067e+11 -1.19754689e+12  6.07e+03 2.04e-10  1.08e+08     1s
   2   3.39365978e+10 -3.74598370e+11  4.43e+02 3.49e-10  1.05e+07     1s
   3   9.85538643e+09 -5.09074135e+10  5.11e+01 5.82e-10  1.26e+06     1s
   4   4.97426393e+09 -1.81716976e+10  1.74e+01 5.82e-10  4.14e+05     1s
   5   1.81601350e+09 -6.30096858e+09  6.74e+00 4.37e-10  1.32e+05     1s
   6   3.62902968e+08 -2.41449418e+09  1.45e+00 1.59e-10  3.60e+04     1s
   7   2.17544108e+08 -7.38745551e+08  8.07e-01 1.59e-10  1.21e+04     1s
   8   1.23648660e+08 -4.10749668e+08  4.26e-01 1.30e-10  6.45e+03     1s
   9   5.40137504e+07 -1.95986561e+08  1.59e-01 1.30e-10  2.89e+03     1s
  10   3.30621680e+07 -9.82991137e+07  8.60e-02 1.01e-10  1.50e+03     1s
  11   1.25024922e+07 -4.87821666e+07  1.93e-02 1.01e-10  6.79e+02     2s
  12   8.60187943e+06 -2.39653926e+07  1.02e-02 1.01e-10  3.59e+02     2s
  13   5.09051109e+06 -8.66189025e+06  3.19e-03 1.01e-10  1.51e+02     2s
  14   4.01027034e+06 -2.28743013e+06  1.45e-03 7.15e-11  6.89e+01     2s
  15   3.32415155e+06  7.82175420e+05  5.21e-04 4.24e-11  2.78e+01     2s
  16   3.06832972e+06  1.92548878e+06  2.29e-04 2.91e-11  1.25e+01     2s
  17   2.92542091e+06  2.52796588e+06  9.16e-05 1.46e-11  4.34e+00     2s
  18   2.84129467e+06  2.73175965e+06  2.48e-05 1.46e-11  1.20e+00     2s
  19   2.82170993e+06  2.77045433e+06  1.28e-05 1.46e-11  5.59e-01     2s
  20   2.80886733e+06  2.78343033e+06  5.62e-06 1.46e-11  2.78e-01     2s
  21   2.80335808e+06  2.79070791e+06  2.78e-06 1.46e-11  1.38e-01     2s
  22   2.80003423e+06  2.79369191e+06  1.18e-06 1.46e-11  6.92e-02     2s
  23   2.79850086e+06  2.79578281e+06  4.74e-07 2.91e-11  2.97e-02     2s
  24   2.79783633e+06  2.79686061e+06  1.84e-07 2.91e-11  1.06e-02     2s
  25   2.79757783e+06  2.79719016e+06  7.70e-08 5.82e-11  4.23e-03     2s
  26   2.79745866e+06  2.79734553e+06  8.21e-08 2.91e-11  1.23e-03     2s
  27   2.79742502e+06  2.79736361e+06  8.26e-08 2.91e-11  6.70e-04     2s
  28   2.79739045e+06  2.79737343e+06  1.50e-07 5.82e-11  1.86e-04     2s
  29   2.79738519e+06  2.79737776e+06  7.10e-08 5.82e-11  8.10e-05     2s
  30   2.79738048e+06  2.79738018e+06  1.73e-09 5.82e-11  3.25e-06     2s
  31   2.79738033e+06  2.79738030e+06  2.58e-10 5.82e-11  3.05e-07     2s
  32   2.79738030e+06  2.79738030e+06  1.52e-09 5.82e-11  3.87e-08     2s
  33   2.79738030e+06  2.79738030e+06  1.18e-07 5.82e-11  3.26e-09     3s

Barrier solved model in 33 iterations and 2.54 seconds
Optimal objective 2.79738030e+06

Crossover log...

    1912 DPushes remaining with DInf 0.0000000e+00                 3s
       0 DPushes remaining with DInf 0.0000000e+00                 3s

     311 PPushes remaining with PInf 8.0000000e-06                 3s
       0 PPushes remaining with PInf 8.0000000e-06                 3s

  Push phase complete: Pinf 8.0000000e-06, Dinf 4.3715364e-10      3s

Iteration    Objective       Primal Inf.    Dual Inf.      Time
    2226    2.7973803e+06   3.000000e-06   0.000000e+00      3s
Extra simplex iterations after uncrush: 19
    2246    2.7973803e+06   0.000000e+00   0.000000e+00      3s

Solved with barrier
Solved in 2246 iterations and 3.30 seconds
Optimal objective  2.797380299e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 2.80e+06
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.75s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-4wr9lg_9.lp
Reading time = 0.11 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0x4f74145b
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [2e+00, 1e+01]
  RHS range        [4e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57050 rows and 22031 columns
Presolve time: 0.05s
Presolved: 3934 rows, 4826 columns, 23598 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.832e+04
 Factor NZ  : 6.450e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.199e+06 (less than 1 second per iteration)
 Threads    : 30

Barrier performed 0 iterations in 0.21 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with primal simplex
Solved in 5403 iterations and 0.21 seconds
Optimal objective  1.936930145e+07
INFO:pypsa.linopf:Optimization successful. Objective value: 1.94e+07
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


all




all


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 3.25s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-_ymdlu1h.lp
Reading time = 0.29 seconds
obj: 167880 rows, 80305 columns, 282380 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 167880 rows, 80305 columns and 282380 nonzeros
Model fingerprint: 0xa31c4a58
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [2e+00, 1e+01]
  RHS range        [4e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 154257 rows and 34683 columns
Presolve time: 0.19s
Presolved: 13623 rows, 45622 columns, 93259 nonzeros

Ordering time: 0.23s

Barrier statistics:
 AA' NZ     : 5.272e+04
 Factor NZ  : 8.334e+05 (roughly 30 MBytes of memory)
 Factor Ops : 1.578e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.23598055e+12 -1.95963052e+12  4.00e+04 9.51e+03  6.63e+08     1s
   1   2.87429518e+11 -1.16552905e+12  4.73e+03 4.14e+03  8.65e+07     1s
   2   3.13123030e+10 -2.87440926e+11  4.14e+02 1.88e-10  9.01e+06     1s
   3   9.27120402e+09 -3.91317383e+10  4.10e+01 4.07e-10  1.01e+06     1s
   4   3.89296535e+09 -1.43587990e+10  9.26e+00 1.75e-10  2.84e+05     1s
   5   1.55871348e+09 -6.18502641e+09  3.93e+00 2.33e-10  1.09e+05     1s
   6   3.35724785e+08 -2.77518431e+09  8.81e-01 1.88e-10  3.76e+04     1s
   7   1.77275361e+08 -1.12077648e+09  4.35e-01 1.59e-10  1.52e+04     1s
   8   7.47314866e+07 -4.65467532e+08  1.41e-01 1.30e-10  6.11e+03     1s
   9   5.64733002e+07 -2.11657856e+08  9.63e-02 1.59e-10  3.02e+03     1s
  10   4.41036397e+07 -1.25829602e+08  6.85e-02 1.01e-10  1.91e+03     1s
  11   2.89698181e+07 -6.21624609e+07  3.77e-02 1.01e-10  1.02e+03     1s
  12   2.41979964e+07 -4.13947807e+07  2.91e-02 1.30e-10  7.32e+02     1s
  13   1.82787408e+07 -2.11094361e+07  1.94e-02 7.79e-11  4.38e+02     1s
  14   1.58126520e+07 -1.37094292e+07  1.55e-02 7.15e-11  3.28e+02     1s
  15   1.38788634e+07 -8.00359838e+06  1.27e-02 7.15e-11  2.43e+02     1s
  16   8.71920878e+06 -2.34785968e+06  4.52e-03 7.15e-11  1.22e+02     1s
  17   7.60473515e+06  1.02779622e+06  3.01e-03 7.15e-11  7.24e+01     1s
  18   6.85799454e+06  3.15566420e+06  1.98e-03 4.24e-11  4.07e+01     1s
  19   6.49973636e+06  4.11934548e+06  1.50e-03 2.91e-11  2.62e+01     1s
  20   5.96371320e+06  4.44377706e+06  8.30e-04 2.91e-11  1.67e+01     1s
  21   5.88583529e+06  4.65429183e+06  7.29e-04 2.18e-11  1.35e+01     1s
  22   5.59184115e+06  4.83721753e+06  3.57e-04 2.18e-11  8.28e+00     1s
  23   5.48364677e+06  5.04154890e+06  2.23e-04 2.91e-11  4.85e+00     1s
  24   5.40994970e+06  5.11964835e+06  1.35e-04 1.46e-11  3.18e+00     1s
  25   5.37340173e+06  5.17890066e+06  9.38e-05 1.46e-11  2.13e+00     1s
  26   5.34418347e+06  5.23446964e+06  6.14e-05 1.46e-11  1.20e+00     1s
  27   5.31786040e+06  5.26097722e+06  3.33e-05 1.46e-11  6.24e-01     1s
  28   5.30130505e+06  5.27352654e+06  1.61e-05 2.18e-11  3.05e-01     1s
  29   5.29178600e+06  5.28066154e+06  6.60e-06 2.91e-11  1.22e-01     1s
  30   5.28859875e+06  5.28298127e+06  3.60e-06 2.91e-11  6.16e-02     1s
  31   5.28636912e+06  5.28383827e+06  1.56e-06 2.91e-11  2.77e-02     1s
  32   5.28543877e+06  5.28426722e+06  7.20e-07 2.91e-11  1.28e-02     1s
  33   5.28495723e+06  5.28445885e+06  2.90e-07 1.46e-11  5.46e-03     1s
  34   5.28473245e+06  5.28456078e+06  9.80e-08 2.91e-11  1.88e-03     1s
  35   5.28463847e+06  5.28459677e+06  6.49e-08 2.91e-11  4.57e-04     1s
  36   5.28462234e+06  5.28460950e+06  3.25e-08 2.91e-11  1.41e-04     1s
  37   5.28461531e+06  5.28461418e+06  2.74e-07 5.82e-11  1.23e-05     1s
  38   5.28461449e+06  5.28461433e+06  3.12e-08 5.82e-11  1.72e-06     2s
  39   5.28461438e+06  5.28461437e+06  5.19e-09 5.82e-11  1.49e-07     2s
  40   5.28461437e+06  5.28461437e+06  1.68e-09 2.91e-11  1.08e-08     2s
  41   5.28461437e+06  5.28461437e+06  2.40e-09 5.82e-11  8.99e-10     2s

Barrier solved model in 41 iterations and 1.66 seconds
Optimal objective 5.28461437e+06

Crossover log...

    1083 DPushes remaining with DInf 0.0000000e+00                 2s
       0 DPushes remaining with DInf 0.0000000e+00                 2s

     236 PPushes remaining with PInf 6.0000000e-06                 2s
       0 PPushes remaining with PInf 6.0000000e-06                 2s

  Push phase complete: Pinf 6.0000000e-06, Dinf 5.6179439e-10      2s

Iteration    Objective       Primal Inf.    Dual Inf.      Time
    1322    5.2846144e+06   6.000000e-06   0.000000e+00      2s
Extra simplex iterations after uncrush: 24
    1349    5.2846144e+06   0.000000e+00   0.000000e+00      2s

Solved with barrier
Solved in 1349 iterations and 2.25 seconds
Optimal objective  5.284614368e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 5.28e+06
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.79s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-s56igbto.lp
Reading time = 0.12 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0x6120f054
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [2e+00, 2e+01]
  RHS range        [5e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57048 rows and 22035 columns
Presolve time: 0.05s
Presolved: 3936 rows, 4822 columns, 23596 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.833e+04
 Factor NZ  : 6.453e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.199e+06 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   4.10032220e+07 -2.03286322e+09  2.13e+04 1.14e-13  9.19e+05     0s
   1   2.30648103e+07 -9.90148504e+08  2.44e+03 2.84e-13  1.58e+05     0s
   2   2.02303683e+07 -1.26161522e+08  2.22e+02 1.88e-12  1.71e+04     0s
   3   1.91717809e+07  8.19764870e+06  2.45e+01 5.68e-13  1.22e+03     0s
   4   1.87583609e+07  1.42944743e+07  3.68e+00 2.27e-13  4.69e+02     0s
   5   1.86406686e+07  1.69148662e+07  1.60e+00 1.71e-13  1.80e+02     0s
   6   1.85356367e+07  1.79106377e+07  5.55e-01 2.27e-13  6.50e+01     0s
   7   1.84728669e+07  1.82234288e+07  1.72e-01 9.95e-14  2.59e+01     0s
   8   1.84393939e+07  1.83717774e+07  2.28e-02 4.93e-14  7.02e+00     0s
   9   1.84323904e+07  1.84151656e+07  4.34e-03 5.68e-14  1.79e+00     0s

Barrier performed 9 iterations in 0.20 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with primal simplex
Solved in 4897 iterations and 0.20 seconds
Optimal objective  1.843024802e+07
INFO:pypsa.linopf:Optimization successful. Objective value: 1.84e+07
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


all




all


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 3.24s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-31sm_vlv.lp
Reading time = 0.30 seconds
obj: 167880 rows, 80305 columns, 282380 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 167880 rows, 80305 columns and 282380 nonzeros
Model fingerprint: 0x975cf6b2
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [2e+00, 2e+01]
  RHS range        [5e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 154250 rows and 34426 columns
Presolve time: 0.14s
Presolved: 13630 rows, 45879 columns, 93523 nonzeros

Ordering time: 0.66s

Barrier statistics:
 AA' NZ     : 5.273e+04
 Factor NZ  : 8.336e+05 (roughly 30 MBytes of memory)
 Factor Ops : 1.578e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.24471574e+12 -2.01723489e+12  4.00e+04 1.11e+04  6.64e+08     1s
   1   2.92795278e+11 -1.12559156e+12  4.76e+03 5.36e+03  8.65e+07     1s
   2   3.30206670e+10 -2.83869317e+11  4.32e+02 2.04e-10  9.22e+06     1s
   3   9.13981994e+09 -4.17498008e+10  4.34e+01 9.31e-10  1.06e+06     1s
   4   4.31040050e+09 -1.54190438e+10  1.33e+01 2.04e-10  3.35e+05     1s
   5   1.44284436e+09 -5.01278619e+09  4.48e+00 1.59e-10  9.59e+04     2s
   6   3.66972568e+08 -1.49295220e+09  1.20e+00 1.59e-10  2.38e+04     2s
   7   6.99590010e+07 -6.53281181e+08  1.59e-01 1.30e-10  8.16e+03     2s
   8   4.40176286e+07 -2.76746082e+08  8.12e-02 1.30e-10  3.58e+03     2s
   9   1.98549481e+07 -1.02931949e+08  2.25e-02 1.01e-10  1.35e+03     2s
  10   1.10732112e+07 -4.62803540e+07  8.92e-03 1.01e-10  6.29e+02     2s
  11   6.12852608e+06 -1.98634194e+07  3.16e-03 1.01e-10  2.84e+02     2s
  12   4.19515612e+06 -7.72495199e+06  1.38e-03 8.61e-11  1.30e+02     2s
  13   2.79376841e+06 -1.18418704e+06  3.38e-04 3.51e-11  4.34e+01     2s
  14   2.58994545e+06  4.20417971e+05  2.22e-04 2.91e-11  2.37e+01     2s
  15   2.27706065e+06  1.27456138e+06  5.62e-05 2.18e-11  1.09e+01     2s
  16   2.21674945e+06  1.75001212e+06  3.06e-05 2.91e-11  5.09e+00     2s
  17   2.14751455e+06  2.02617432e+06  5.91e-06 2.91e-11  1.32e+00     2s
  18   2.12525459e+06  2.09589861e+06  1.47e-06 2.91e-11  3.20e-01     2s
  19   2.12058839e+06  2.10701834e+06  8.50e-07 2.91e-11  1.48e-01     2s
  20   2.11908634e+06  2.11010097e+06  6.68e-07 5.82e-11  9.79e-02     2s
  21   2.11592417e+06  2.11174061e+06  2.97e-07 5.82e-11  4.56e-02     2s
  22   2.11510344e+06  2.11232796e+06  2.04e-07 2.91e-11  3.02e-02     2s
  23   2.11447117e+06  2.11263677e+06  1.33e-07 2.91e-11  2.00e-02     2s
  24   2.11382421e+06  2.11289274e+06  6.70e-08 2.91e-11  1.02e-02     2s
  25   2.11359081e+06  2.11300312e+06  1.60e-07 2.91e-11  6.40e-03     2s
  26   2.11348397e+06  2.11317563e+06  1.00e-07 2.91e-11  3.36e-03     3s
  27   2.11336742e+06  2.11320867e+06  2.27e-07 2.91e-11  1.73e-03     3s
  28   2.11330494e+06  2.11325955e+06  6.77e-08 5.82e-11  4.95e-04     3s
  29   2.11328706e+06  2.11326672e+06  4.71e-08 2.91e-11  2.22e-04     3s
  30   2.11327635e+06  2.11327138e+06  4.86e-08 5.82e-11  5.42e-05     3s
  31   2.11327368e+06  2.11327271e+06  4.32e-08 2.91e-11  1.06e-05     3s
  32   2.11327309e+06  2.11327308e+06  9.36e-10 5.82e-11  1.58e-07     3s
  33   2.11327309e+06  2.11327309e+06  1.03e-09 5.82e-11  8.27e-09     3s

Barrier solved model in 33 iterations and 2.83 seconds
Optimal objective 2.11327309e+06

Crossover log...

    3022 DPushes remaining with DInf 0.0000000e+00                 3s
       0 DPushes remaining with DInf 0.0000000e+00                 3s

     494 PPushes remaining with PInf 0.0000000e+00                 3s
       0 PPushes remaining with PInf 0.0000000e+00                 3s

  Push phase complete: Pinf 0.0000000e+00, Dinf 5.7258487e-10      3s

Iteration    Objective       Primal Inf.    Dual Inf.      Time
    3519    2.1132731e+06   0.000000e+00   0.000000e+00      3s

Solved with barrier
Solved in 3519 iterations and 3.39 seconds
Optimal objective  2.113273087e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 2.11e+06
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.74s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-s6j2q1rw.lp
Reading time = 0.11 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0xd4ed44ab
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [3e+00, 2e+01]
  RHS range        [5e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57049 rows and 22010 columns
Presolve time: 0.05s
Presolved: 3935 rows, 4847 columns, 23620 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.832e+04
 Factor NZ  : 6.452e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.199e+06 (less than 1 second per iteration)
 Threads    : 30

Barrier performed 0 iterations in 0.19 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with primal simplex
Solved in 5366 iterations and 0.19 seconds
Optimal objective  9.493265208e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 9.49e+06
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


all




all


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 3.24s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-vvya_ova.lp
Reading time = 0.29 seconds
obj: 167880 rows, 80305 columns, 282380 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 167880 rows, 80305 columns and 282380 nonzeros
Model fingerprint: 0x0aeb3566
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [3e+00, 2e+01]
  RHS range        [5e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 154251 rows and 35587 columns
Presolve time: 0.14s
Presolved: 13629 rows, 44718 columns, 92361 nonzeros

Ordering time: 0.57s

Barrier statistics:
 AA' NZ     : 5.273e+04
 Factor NZ  : 8.473e+05 (roughly 30 MBytes of memory)
 Factor Ops : 1.681e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.24266518e+12 -1.99486946e+12  3.36e+04 1.39e+04  6.63e+08     1s
   1   2.79879895e+11 -1.13667681e+12  3.93e+03 6.02e+03  8.55e+07     1s
   2   2.67598818e+10 -2.83305396e+11  2.99e+02 2.33e-10  8.19e+06     1s
   3   8.84785892e+09 -4.57296403e+10  4.53e+01 1.46e-09  1.22e+06     1s
   4   4.20337854e+09 -1.72213477e+10  1.48e+01 1.46e-10  3.97e+05     1s
   5   2.29414759e+09 -9.73826390e+09  8.00e+00 1.75e-10  2.02e+05     1s
   6   4.29427108e+08 -2.19421450e+09  1.71e+00 1.75e-10  3.72e+04     1s
   7   4.97065176e+07 -8.58173098e+08  9.34e-02 1.27e-10  1.04e+04     1s
   8   3.54700339e+07 -3.87188685e+08  4.76e-02 9.81e-11  4.80e+03     1s
   9   2.33878289e+07 -1.39520101e+08  2.14e-02 1.27e-10  1.84e+03     1s
  10   1.57704886e+07 -8.15475982e+07  1.08e-02 9.81e-11  1.09e+03     1s
  11   1.07459827e+07 -3.53113848e+07  5.79e-03 9.81e-11  5.17e+02     1s
  12   7.96782363e+06 -2.14034750e+07  3.50e-03 5.44e-11  3.29e+02     1s
  13   6.16109509e+06 -6.84912264e+06  2.19e-03 5.44e-11  1.46e+02     2s
  14   4.98003340e+06 -1.70863807e+06  1.38e-03 3.02e-11  7.49e+01     2s
  15   3.75392018e+06  3.24812985e+05  5.98e-04 1.93e-11  3.84e+01     2s
  16   3.13045779e+06  2.01831685e+06  2.26e-04 2.18e-11  1.24e+01     2s
  17   2.96098024e+06  2.41983180e+06  1.31e-04 2.18e-11  6.05e+00     2s
  18   2.83136809e+06  2.55158507e+06  6.12e-05 1.46e-11  3.13e+00     2s
  19   2.77319276e+06  2.62130441e+06  3.14e-05 1.46e-11  1.70e+00     2s
  20   2.74905595e+06  2.65948599e+06  1.96e-05 1.46e-11  1.00e+00     2s
  21   2.73179548e+06  2.67833883e+06  1.15e-05 1.46e-11  5.98e-01     2s
  22   2.71418026e+06  2.68632256e+06  3.59e-06 1.46e-11  3.11e-01     2s
  23   2.70972014e+06  2.69478819e+06  1.71e-06 1.46e-11  1.67e-01     2s
  24   2.70633786e+06  2.70052569e+06  3.71e-07 1.46e-11  6.50e-02     2s
  25   2.70585098e+06  2.70351229e+06  2.24e-07 1.46e-11  2.62e-02     2s
  26   2.70542794e+06  2.70430517e+06  1.08e-07 1.46e-11  1.26e-02     2s
  27   2.70531144e+06  2.70445905e+06  7.81e-08 1.46e-11  9.53e-03     2s
  28   2.70520793e+06  2.70475699e+06  5.04e-08 1.46e-11  5.04e-03     2s
  29   2.70515375e+06  2.70484282e+06  4.20e-08 1.46e-11  3.48e-03     2s
  30   2.70509761e+06  2.70490946e+06  4.17e-08 1.46e-11  2.10e-03     2s
  31   2.70505734e+06  2.70495210e+06  3.21e-08 1.46e-11  1.18e-03     2s
  32   2.70503988e+06  2.70498150e+06  3.62e-08 1.46e-11  6.53e-04     2s
  33   2.70502059e+06  2.70500425e+06  4.39e-08 2.91e-11  1.83e-04     2s
  34   2.70501058e+06  2.70500766e+06  2.46e-07 5.82e-11  3.27e-05     3s
  35   2.70500878e+06  2.70500821e+06  4.24e-08 5.82e-11  6.38e-06     3s
  36   2.70500832e+06  2.70500829e+06  3.87e-09 5.82e-11  3.22e-07     3s
  37   2.70500830e+06  2.70500830e+06  1.89e-09 5.82e-11  2.17e-08     3s
  38   2.70500830e+06  2.70500830e+06  2.19e-09 5.82e-11  4.12e-09     3s

Barrier solved model in 38 iterations and 2.72 seconds
Optimal objective 2.70500830e+06

Crossover log...


Solved with dual simplex
Solved in 12708 iterations and 2.80 seconds
Optimal objective  2.705008302e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 2.71e+06
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.74s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-a22he84o.lp
Reading time = 0.11 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0x09e06eca
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [4e+00, 3e+01]
  RHS range        [7e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57050 rows and 22015 columns
Presolve time: 0.05s
Presolved: 3934 rows, 4842 columns, 23614 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.832e+04
 Factor NZ  : 6.450e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.199e+06 (less than 1 second per iteration)
 Threads    : 30

Barrier performed 0 iterations in 0.21 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with dual simplex
Solved in 2732 iterations and 0.22 seconds
Optimal objective  9.555914186e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 9.56e+06
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


all




all


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 3.24s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-uctb0z_k.lp
Reading time = 0.29 seconds
obj: 167880 rows, 80305 columns, 282380 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 167880 rows, 80305 columns and 282380 nonzeros
Model fingerprint: 0xa0a15c4e
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [4e+00, 3e+01]
  RHS range        [7e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 154254 rows and 35060 columns
Presolve time: 0.16s
Presolved: 13626 rows, 45245 columns, 92885 nonzeros

Ordering time: 0.52s

Barrier statistics:
 AA' NZ     : 5.273e+04
 Factor NZ  : 8.458e+05 (roughly 30 MBytes of memory)
 Factor Ops : 1.590e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.24616359e+12 -2.05743514e+12  4.10e+04 2.83e-11  6.91e+08     1s
   1   2.96415256e+11 -1.16823645e+12  4.67e+03 4.84e+03  8.75e+07     1s
   2   2.75274303e+10 -3.23430237e+11  3.55e+02 5.82e-10  8.76e+06     1s
   3   7.39311493e+09 -4.71755413e+10  3.34e+01 8.15e-10  9.91e+05     1s
   4   4.51188460e+09 -1.68725779e+10  9.25e+00 3.78e-10  3.15e+05     1s
   5   1.27940396e+09 -6.66509742e+09  2.86e+00 2.40e-10  1.04e+05     1s
   6   7.08625682e+07 -8.65056230e+08  1.60e-01 2.63e-10  1.07e+04     1s
   7   3.83210507e+07 -3.67990566e+08  5.70e-02 1.47e-10  4.55e+03     1s
   8   2.84859106e+07 -1.41145972e+08  3.53e-02 1.18e-10  1.90e+03     1s
   9   9.70719264e+06 -4.70493026e+07  4.99e-03 8.84e-11  6.29e+02     1s
  10   5.95665898e+06 -2.32718788e+07  2.48e-03 8.84e-11  3.23e+02     1s
  11   3.78370342e+06 -1.17329395e+07  1.24e-03 4.48e-11  1.72e+02     1s
  12   3.13136509e+06 -6.63801080e+06  9.33e-04 3.02e-11  1.08e+02     1s
  13   2.32371333e+06 -4.08710895e+06  5.67e-04 2.91e-11  7.09e+01     2s
  14   1.87164583e+06 -2.45095032e+06  3.70e-04 2.91e-11  4.78e+01     2s
  15   1.48986529e+06 -4.57850026e+05  2.16e-04 2.91e-11  2.15e+01     2s
  16   1.24931368e+06  4.40725759e+04  1.25e-04 2.91e-11  1.33e+01     2s
  17   1.13951669e+06  5.19290813e+05  8.54e-05 2.91e-11  6.85e+00     2s
  18   1.02032611e+06  6.87212053e+05  4.62e-05 5.82e-11  3.68e+00     2s
  19   9.21811562e+05  8.27226342e+05  9.70e-06 5.82e-11  1.05e+00     2s
  20   9.02479302e+05  8.67618972e+05  3.82e-06 5.82e-11  3.85e-01     2s
  21   8.93746894e+05  8.81028211e+05  1.48e-06 5.82e-11  1.41e-01     2s
  22   8.89814931e+05  8.85202814e+05  5.33e-07 5.82e-11  5.10e-02     2s
  23   8.88482263e+05  8.86433814e+05  2.29e-07 5.82e-11  2.26e-02     2s
  24   8.87918957e+05  8.87050575e+05  1.03e-07 5.82e-11  9.60e-03     2s
  25   8.87744818e+05  8.87248078e+05  6.62e-08 5.82e-11  5.49e-03     2s
  26   8.87573162e+05  8.87379566e+05  3.12e-08 5.82e-11  2.14e-03     2s
  27   8.87485716e+05  8.87400143e+05  4.75e-08 5.82e-11  9.46e-04     2s
  28   8.87446853e+05  8.87420619e+05  2.69e-08 2.91e-11  2.90e-04     2s
  29   8.87435193e+05  8.87426826e+05  2.10e-08 5.82e-11  9.25e-05     2s
  30   8.87431492e+05  8.87430551e+05  2.74e-09 5.82e-11  1.04e-05     2s
  31   8.87431038e+05  8.87430890e+05  5.18e-10 8.73e-11  1.64e-06     2s
  32   8.87430949e+05  8.87430922e+05  3.95e-10 5.82e-11  2.88e-07     3s
  33   8.87430927e+05  8.87430926e+05  1.76e-09 5.82e-11  1.39e-08     3s
  34   8.87430926e+05  8.87430926e+05  5.77e-09 8.73e-11  1.69e-09     3s

Barrier solved model in 34 iterations and 2.70 seconds
Optimal objective 8.87430926e+05

Crossover log...

     808 DPushes remaining with DInf 0.0000000e+00                 3s

Solved with dual simplex
Solved in 14087 iterations and 2.91 seconds
Optimal objective  8.874309265e+05
INFO:pypsa.linopf:Optimization successful. Objective value: 8.87e+05
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.75s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-h34k1d6e.lp
Reading time = 0.11 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0x4eea0ec9
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [6e+00, 5e+01]
  RHS range        [1e-02, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57049 rows and 22010 columns
Presolve time: 0.05s
Presolved: 3935 rows, 4847 columns, 23620 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.832e+04
 Factor NZ  : 6.452e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.199e+06 (less than 1 second per iteration)
 Threads    : 30

Barrier performed 0 iterations in 0.20 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with primal simplex
Solved in 5407 iterations and 0.20 seconds
Optimal objective  1.127409927e+07
INFO:pypsa.linopf:Optimization successful. Objective value: 1.13e+07
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


all




all


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 3.24s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-e9rxv402.lp
Reading time = 0.29 seconds
obj: 167880 rows, 80305 columns, 282380 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 167880 rows, 80305 columns and 282380 nonzeros
Model fingerprint: 0x9d63fd01
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [6e+00, 5e+01]
  RHS range        [1e-02, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 154251 rows and 35032 columns
Presolve time: 0.16s
Presolved: 13629 rows, 45273 columns, 92916 nonzeros

Ordering time: 0.30s

Barrier statistics:
 AA' NZ     : 5.273e+04
 Factor NZ  : 8.349e+05 (roughly 30 MBytes of memory)
 Factor Ops : 1.577e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.24842370e+12 -2.07546840e+12  3.73e+04 2.33e-11  6.91e+08     1s
   1   2.93180132e+11 -1.16021274e+12  4.20e+03 4.73e+03  8.65e+07     1s
   2   3.28930825e+10 -2.84401253e+11  4.04e+02 2.04e-10  9.57e+06     1s
   3   7.70151111e+09 -4.61402970e+10  3.45e+01 1.75e-10  1.05e+06     1s
   4   4.82493163e+09 -1.96413563e+10  8.35e+00 1.75e-10  3.56e+05     1s
   5   2.59385158e+09 -7.89916116e+09  4.56e+00 2.18e-10  1.48e+05     1s
   6   2.07139905e+08 -1.40249693e+09  4.86e-01 3.81e-09  1.93e+04     1s
   7   7.74657423e+07 -4.73368717e+08  1.47e-01 1.27e-09  6.30e+03     1s
   8   5.15257110e+07 -1.55408762e+08  8.72e-02 3.71e-10  2.35e+03     1s
   9   1.55541726e+07 -7.65188417e+07  1.66e-02 1.82e-10  1.02e+03     1s
  10   1.02669790e+07 -3.67153985e+07  9.27e-03 8.37e-11  5.21e+02     1s
  11   5.21756269e+06 -1.63427121e+07  3.30e-03 5.70e-11  2.39e+02     1s
  12   3.67957964e+06 -7.18958167e+06  1.82e-03 5.82e-11  1.20e+02     1s
  13   2.44664721e+06 -1.75409942e+06  7.52e-04 5.82e-11  4.64e+01     1s
  14   1.98108611e+06 -2.16307931e+05  3.92e-04 5.82e-11  2.43e+01     1s
  15   1.66386169e+06  8.85065861e+05  1.63e-04 5.82e-11  8.60e+00     2s
  16   1.51726484e+06  1.21610933e+06  6.86e-05 5.82e-11  3.33e+00     2s
  17   1.44054725e+06  1.34322654e+06  2.30e-05 5.82e-11  1.07e+00     2s
  18   1.40758173e+06  1.38267664e+06  5.07e-06 5.82e-11  2.75e-01     2s
  19   1.40114344e+06  1.38998499e+06  2.13e-06 2.91e-11  1.23e-01     2s
  20   1.39850926e+06  1.39337208e+06  1.02e-06 2.91e-11  5.67e-02     2s
  21   1.39700854e+06  1.39483184e+06  4.26e-07 2.91e-11  2.40e-02     2s
  22   1.39656571e+06  1.39552388e+06  2.60e-07 5.82e-11  1.15e-02     2s
  23   1.39635685e+06  1.39558250e+06  1.84e-07 2.91e-11  8.55e-03     2s
  24   1.39617515e+06  1.39565545e+06  1.19e-07 2.91e-11  5.74e-03     2s
  25   1.39610446e+06  1.39574648e+06  9.63e-08 5.82e-11  3.95e-03     2s
  26   1.39605708e+06  1.39577985e+06  7.81e-08 2.91e-11  3.06e-03     2s
  27   1.39601782e+06  1.39579618e+06  6.26e-08 5.82e-11  2.45e-03     2s
  28   1.39599167e+06  1.39580544e+06  5.80e-08 2.91e-11  2.06e-03     2s
  29   1.39596386e+06  1.39582526e+06  5.14e-08 2.91e-11  1.53e-03     2s
  30   1.39589833e+06  1.39583502e+06  1.67e-07 2.91e-11  6.99e-04     2s
  31   1.39587505e+06  1.39583846e+06  2.28e-07 8.73e-11  4.04e-04     2s
  32   1.39587012e+06  1.39583940e+06  2.36e-07 5.82e-11  3.39e-04     2s
  33   1.39586388e+06  1.39584003e+06  7.72e-07 2.91e-11  2.63e-04     2s

Barrier performed 33 iterations in 2.20 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with dual simplex
Solved in 12161 iterations and 2.20 seconds
Optimal objective  1.395841072e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 1.40e+06
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.74s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-nomk56dj.lp
Reading time = 0.11 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0xa76591bd
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [9e+00, 8e+01]
  RHS range        [2e-02, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57050 rows and 22019 columns
Presolve time: 0.05s
Presolved: 3934 rows, 4838 columns, 23610 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.832e+04
 Factor NZ  : 6.454e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.200e+06 (less than 1 second per iteration)
 Threads    : 30

Barrier performed 0 iterations in 0.26 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with primal simplex
Solved in 5612 iterations and 0.26 seconds
Optimal objective  1.182810363e+07
INFO:pypsa.linopf:Optimization successful. Objective value: 1.18e+07
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


all




all


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 3.24s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-vxpu2p_f.lp
Reading time = 0.29 seconds
obj: 167880 rows, 80305 columns, 282380 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 167880 rows, 80305 columns and 282380 nonzeros
Model fingerprint: 0x6c8e9051
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [9e+00, 8e+01]
  RHS range        [2e-02, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 154250 rows and 34915 columns
Presolve time: 0.14s
Presolved: 13630 rows, 45390 columns, 93034 nonzeros

Ordering time: 0.45s

Barrier statistics:
 AA' NZ     : 5.273e+04
 Factor NZ  : 8.453e+05 (roughly 30 MBytes of memory)
 Factor Ops : 1.632e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.73161491e+12 -2.03740236e+12  5.26e+04 1.17e+04  9.27e+08     1s
   1   3.85947066e+11 -1.19348131e+12  5.85e+03 2.04e-10  1.12e+08     1s
   2   3.15180881e+10 -3.71702227e+11  4.12e+02 2.04e-10  1.05e+07     1s
   3   8.42043769e+09 -5.19643984e+10  5.29e+01 1.75e-09  1.34e+06     1s
   4   4.53663858e+09 -2.09508302e+10  1.13e+01 8.73e-10  3.98e+05     1s
   5   1.17076979e+09 -7.89515113e+09  3.12e+00 5.82e-10  1.22e+05     1s
   6   5.91352027e+07 -1.29751284e+09  1.24e-01 1.85e-10  1.53e+04     1s
   7   4.00668909e+07 -5.97697372e+08  6.41e-02 1.27e-10  7.12e+03     1s
   8   3.31495944e+07 -3.06721748e+08  4.79e-02 9.81e-11  3.78e+03     1s
   9   2.05023779e+07 -8.71868879e+07  2.31e-02 9.81e-11  1.19e+03     1s
  10   1.40417101e+07 -3.84713349e+07  1.39e-02 5.44e-11  5.81e+02     1s
  11   9.33528798e+06 -2.00611056e+07  8.67e-03 3.98e-11  3.25e+02     1s
  12   6.31106704e+06 -1.17773215e+07  5.45e-03 3.43e-11  2.00e+02     1s
  13   4.88451151e+06 -8.44709664e+06  4.06e-03 2.70e-11  1.47e+02     1s
  14   3.30187271e+06 -5.48864783e+06  2.51e-03 2.18e-11  9.69e+01     1s
  15   2.51376623e+06 -2.73882678e+06  1.76e-03 4.37e-11  5.79e+01     1s
  16   2.29264195e+06 -1.62149725e+06  1.55e-03 4.37e-11  4.31e+01     1s
  17   1.68564375e+06 -1.07310899e+06  9.89e-04 2.91e-11  3.04e+01     1s
  18   1.18037058e+06 -5.37816179e+05  5.71e-04 1.46e-11  1.89e+01     1s
  19   1.16908013e+06 -4.63659331e+05  5.60e-04 1.46e-11  1.80e+01     1s
  20   1.03840211e+06 -1.66105819e+05  4.29e-04 2.91e-11  1.33e+01     1s
  21   9.23571220e+05  5.28367353e+04  3.22e-04 1.46e-11  9.59e+00     1s
  22   8.60338397e+05  1.22089121e+05  2.66e-04 1.46e-11  8.13e+00     1s
  23   7.72688166e+05  1.74833120e+05  1.88e-04 1.46e-11  6.59e+00     1s
  24   7.45125923e+05  2.44067110e+05  1.65e-04 2.91e-11  5.52e+00     1s
  25   6.85809770e+05  3.01690814e+05  1.12e-04 2.91e-11  4.23e+00     1s
  26   6.04083229e+05  4.26842004e+05  3.83e-05 1.46e-11  1.95e+00     1s
  27   5.93175730e+05  5.06116833e+05  2.97e-05 1.46e-11  9.59e-01     1s
  28   5.76816040e+05  5.30025857e+05  1.76e-05 1.46e-11  5.15e-01     1s
  29   5.75381253e+05  5.33898255e+05  1.66e-05 1.46e-11  4.57e-01     1s
  30   5.72053375e+05  5.38801983e+05  1.43e-05 1.46e-11  3.66e-01     1s
  31   5.65924041e+05  5.42170097e+05  1.01e-05 1.46e-11  2.62e-01     1s
  32   5.60278081e+05  5.46103334e+05  6.39e-06 2.91e-11  1.56e-01     1s
  33   5.56063345e+05  5.49685014e+05  3.49e-06 2.91e-11  7.03e-02     1s
  34   5.55850913e+05  5.49784821e+05  3.34e-06 5.82e-11  6.68e-02     1s
  35   5.52724673e+05  5.50101654e+05  1.24e-06 2.91e-11  2.89e-02     1s
  36   5.51935283e+05  5.50398569e+05  7.13e-07 2.91e-11  1.69e-02     1s
  37   5.51722817e+05  5.50617858e+05  5.69e-07 2.91e-11  1.22e-02     1s
  38   5.51615441e+05  5.50689446e+05  4.98e-07 2.91e-11  1.02e-02     1s
  39   5.51340986e+05  5.50755974e+05  3.16e-07 2.91e-11  6.45e-03     2s
  40   5.51216625e+05  5.50796152e+05  2.36e-07 2.91e-11  4.63e-03     2s
  41   5.51125587e+05  5.50807936e+05  1.77e-07 2.91e-11  3.50e-03     2s
  42   5.50996523e+05  5.50827322e+05  1.03e-07 2.91e-11  1.86e-03     2s
  43   5.50901789e+05  5.50841747e+05  1.34e-07 5.82e-11  6.61e-04     2s
  44   5.50880862e+05  5.50851099e+05  7.68e-08 2.91e-11  3.28e-04     2s
  45   5.50862971e+05  5.50855495e+05  3.83e-08 5.82e-11  8.24e-05     2s
  46   5.50857306e+05  5.50856866e+05  1.20e-07 5.82e-11  4.85e-06     2s
  47   5.50857068e+05  5.50857017e+05  9.76e-09 5.82e-11  5.63e-07     2s
  48   5.50857054e+05  5.50857040e+05  4.00e-09 5.82e-11  1.57e-07     2s
  49   5.50857047e+05  5.50857044e+05  8.45e-08 5.82e-11  4.27e-08     2s
  50   5.50857045e+05  5.50857044e+05  1.12e-07 5.82e-11  1.31e-08     2s
  51   5.50857044e+05  5.50857044e+05  2.29e-07 5.82e-11  1.28e-09     2s

Barrier solved model in 51 iterations and 1.91 seconds
Optimal objective 5.50857044e+05

Crossover log...

    1256 DPushes remaining with DInf 0.0000000e+00                 2s
       0 DPushes remaining with DInf 0.0000000e+00                 2s

    1016 PPushes remaining with PInf 3.4000000e-05                 2s
       0 PPushes remaining with PInf 3.4000000e-05                 2s

  Push phase complete: Pinf 3.4000000e-05, Dinf 1.8201184e-10      2s

Iteration    Objective       Primal Inf.    Dual Inf.      Time
    2275    5.5085704e+05   2.800000e-05   0.000000e+00      3s
Extra simplex iterations after uncrush: 57
    2352    5.5085704e+05   0.000000e+00   0.000000e+00      3s

Solved with barrier
Solved in 2352 iterations and 2.64 seconds
Optimal objective  5.508570440e+05
INFO:pypsa.linopf:Optimization successful. Objective value: 5.51e+05
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.77s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-wstkec13.lp
Reading time = 0.11 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0x61dc419b
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [1e+01, 8e+01]
  RHS range        [2e-02, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57053 rows and 22010 columns
Presolve time: 0.05s
Presolved: 3931 rows, 4847 columns, 23616 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.832e+04
 Factor NZ  : 6.460e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.204e+06 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   3.04204594e+07 -9.58319782e+08  1.57e+04 5.68e-14  4.14e+05     0s
   1   1.12575290e+07 -4.52794346e+08  1.70e+03 1.42e-13  6.95e+04     0s
   2   8.73573412e+06 -6.08823674e+07  1.72e+02 1.51e-12  8.07e+03     0s
   3   7.95970859e+06  6.43046515e+05  1.40e+01 1.71e-13  7.82e+02     0s
   4   7.71355650e+06  3.56298176e+06  1.85e+00 2.84e-13  4.30e+02     0s
   5   7.60868568e+06  6.04284347e+06  4.24e-01 1.56e-13  1.62e+02     0s
   6   7.56068395e+06  6.86334831e+06  1.60e-01 1.28e-13  7.20e+01     0s
   7   7.53512214e+06  7.14197034e+06  5.98e-02 5.68e-14  4.06e+01     0s
   8   7.52059413e+06  7.31206973e+06  1.65e-02 4.26e-14  2.15e+01     0s
   9   7.51287717e+06  7.40945200e+06  4.67e-03 4.06e-14  1.07e+01     0s

Barrier performed 9 iterations in 0.21 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with primal simplex
Solved in 5255 iterations and 0.21 seconds
Optimal objective  7.506804441e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 7.51e+06
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


all




all


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 3.24s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-55mm7m83.lp
Reading time = 0.29 seconds
obj: 167880 rows, 80305 columns, 282380 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 167880 rows, 80305 columns and 282380 nonzeros
Model fingerprint: 0x6cf38b1f
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [1e+01, 8e+01]
  RHS range        [2e-02, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 154289 rows and 35946 columns
Presolve time: 0.14s
Presolved: 13591 rows, 44359 columns, 91964 nonzeros

Ordering time: 0.67s

Barrier statistics:
 AA' NZ     : 5.269e+04
 Factor NZ  : 8.558e+05 (roughly 30 MBytes of memory)
 Factor Ops : 1.616e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.73299984e+12 -2.00331215e+12  5.81e+04 1.39e+04  9.30e+08     1s
   1   3.75124892e+11 -1.19403993e+12  6.60e+03 2.04e-10  1.14e+08     1s
   2   2.98815552e+10 -3.80386256e+11  4.55e+02 1.75e-10  1.06e+07     1s
   3   8.18208365e+09 -4.77928830e+10  6.31e+01 2.56e-09  1.36e+06     1s
   4   4.57357921e+09 -1.84720023e+10  1.79e+01 8.15e-10  4.25e+05     1s
   5   1.01326915e+09 -7.09129796e+09  4.37e+00 1.89e-10  1.21e+05     1s
   6   4.31717744e+07 -1.28093680e+09  7.80e-02 4.95e-10  1.51e+04     1s
   7   3.65245265e+07 -6.46721209e+08  5.71e-02 2.62e-10  7.79e+03     1s
   8   2.98593913e+07 -2.40457468e+08  3.95e-02 8.84e-11  3.07e+03     1s
   9   1.75947246e+07 -9.47921143e+07  1.50e-02 6.55e-11  1.27e+03     1s
  10   1.42259660e+07 -4.75403186e+07  1.05e-02 5.10e-11  6.98e+02     1s
  11   9.57381361e+06 -2.01429192e+07  5.06e-03 3.43e-11  3.35e+02     1s
  12   8.26458666e+06 -1.03564197e+07  3.83e-03 2.70e-11  2.10e+02     1s
  13   6.76290438e+06 -4.52782431e+06  2.53e-03 1.61e-11  1.27e+02     1s
  14   6.43301251e+06 -2.60226158e+06  2.24e-03 1.57e-11  1.02e+02     1s
  15   5.63911330e+06 -6.92635055e+05  1.59e-03 1.46e-11  7.14e+01     1s
  16   5.28313707e+06  6.35882099e+05  1.30e-03 1.46e-11  5.24e+01     1s
  17   4.66568013e+06  2.27167619e+06  8.28e-04 2.91e-11  2.70e+01     1s
  18   4.20114667e+06  3.10973366e+06  4.66e-04 1.46e-11  1.23e+01     1s
  19   3.95838187e+06  3.32448304e+06  2.82e-04 1.46e-11  7.15e+00     1s
  20   3.83078845e+06  3.45141298e+06  1.87e-04 1.46e-11  4.28e+00     1s
  21   3.71161748e+06  3.50220203e+06  1.00e-04 2.18e-11  2.36e+00     1s
  22   3.62863294e+06  3.53244738e+06  4.16e-05 1.46e-11  1.08e+00     1s
  23   3.59469880e+06  3.55382810e+06  1.76e-05 1.46e-11  4.61e-01     2s
  24   3.57830033e+06  3.56402494e+06  6.54e-06 2.91e-11  1.61e-01     2s
  25   3.57528491e+06  3.56540846e+06  4.60e-06 2.91e-11  1.11e-01     2s
  26   3.56965411e+06  3.56642317e+06  1.02e-06 2.91e-11  3.64e-02     2s
  27   3.56936072e+06  3.56700890e+06  8.42e-07 2.91e-11  2.65e-02     2s
  28   3.56880121e+06  3.56727737e+06  5.19e-07 4.37e-11  1.72e-02     2s
  29   3.56844151e+06  3.56766839e+06  3.12e-07 2.91e-11  8.72e-03     2s
  30   3.56819477e+06  3.56775920e+06  1.72e-07 2.91e-11  4.91e-03     2s
  31   3.56812265e+06  3.56780335e+06  1.32e-07 2.91e-11  3.60e-03     2s
  32   3.56801707e+06  3.56783123e+06  7.15e-08 2.91e-11  2.09e-03     2s
  33   3.56795914e+06  3.56785158e+06  4.75e-08 2.91e-11  1.21e-03     2s
  34   3.56794588e+06  3.56785914e+06  5.39e-08 2.91e-11  9.78e-04     2s
  35   3.56790263e+06  3.56787916e+06  8.05e-08 2.91e-11  2.65e-04     2s
  36   3.56789617e+06  3.56788333e+06  3.65e-08 5.82e-11  1.45e-04     2s
  37   3.56788977e+06  3.56788527e+06  1.35e-07 5.82e-11  5.06e-05     2s
  38   3.56788804e+06  3.56788562e+06  7.26e-08 5.82e-11  2.73e-05     2s
  39   3.56788585e+06  3.56788573e+06  5.49e-09 5.82e-11  1.38e-06     2s
  40   3.56788577e+06  3.56788575e+06  6.62e-10 5.82e-11  1.62e-07     2s
  41   3.56788576e+06  3.56788576e+06  1.23e-09 5.82e-11  2.97e-08     2s
  42   3.56788576e+06  3.56788576e+06  3.01e-09 2.91e-11  7.70e-09     2s

Barrier solved model in 42 iterations and 1.94 seconds
Optimal objective 3.56788576e+06

Crossover log...

    1293 DPushes remaining with DInf 0.0000000e+00                 2s
       0 DPushes remaining with DInf 0.0000000e+00                 2s

     913 PPushes remaining with PInf 5.5000000e-05                 2s
       0 PPushes remaining with PInf 6.2000000e-05                 2s

  Push phase complete: Pinf 6.2000000e-05, Dinf 2.2188807e-10      2s

Iteration    Objective       Primal Inf.    Dual Inf.      Time
    2209    3.5678858e+06   5.500000e-05   0.000000e+00      2s
Extra simplex iterations after uncrush: 57
    2291    3.5678858e+06   0.000000e+00   0.000000e+00      3s

Solved with barrier
Solved in 2291 iterations and 2.68 seconds
Optimal objective  3.567885755e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 3.57e+06
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.78s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-btz7ipjq.lp
Reading time = 0.11 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0x50a43d3e
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [1e+01, 8e+01]
  RHS range        [2e-02, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57051 rows and 22011 columns
Presolve time: 0.05s
Presolved: 3933 rows, 4846 columns, 23617 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.832e+04
 Factor NZ  : 6.449e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.199e+06 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   3.66370977e+07 -1.15821747e+09  1.92e+04 5.68e-14  5.28e+05     0s
   1   1.47657461e+07 -5.69570399e+08  2.21e+03 1.42e-13  9.08e+04     0s
   2   1.13312576e+07 -9.38707401e+07  2.20e+02 2.36e-12  1.22e+04     0s
   3   1.02364385e+07  2.74925331e+06  1.75e+01 2.13e-13  8.10e+02     0s
   4   9.93889389e+06  7.66521272e+06  2.81e+00 6.25e-13  2.37e+02     0s
   5   9.85743655e+06  8.49658669e+06  1.09e+00 5.12e-13  1.41e+02     0s
   6   9.81258643e+06  9.34524238e+06  3.96e-01 1.56e-13  4.83e+01     0s
   7   9.79093581e+06  9.60249810e+06  1.57e-01 3.13e-14  1.95e+01     0s
   8   9.77542418e+06  9.69570855e+06  2.07e-02 2.99e-14  8.23e+00     0s
   9   9.77170649e+06  9.73593052e+06  8.07e-03 3.25e-14  3.69e+00     0s
  10   9.76929549e+06  9.75660049e+06  2.06e-03 2.88e-14  1.31e+00     0s
  11   9.76862940e+06  9.76239662e+06  1.00e-03 2.96e-14  6.43e-01     0s

Barrier performed 11 iterations in 0.20 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with primal simplex
Solved in 5211 iterations and 0.21 seconds
Optimal objective  9.767853377e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 9.77e+06
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


all




all


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 3.23s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-_amm59ru.lp
Reading time = 0.29 seconds
obj: 167880 rows, 80305 columns, 282380 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 167880 rows, 80305 columns and 282380 nonzeros
Model fingerprint: 0xb4790b8c
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [1e+01, 8e+01]
  RHS range        [2e-02, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 154273 rows and 36597 columns
Presolve time: 0.14s
Presolved: 13607 rows, 43708 columns, 91329 nonzeros

Ordering time: 0.49s

Barrier statistics:
 AA' NZ     : 5.271e+04
 Factor NZ  : 8.240e+05 (roughly 30 MBytes of memory)
 Factor Ops : 1.560e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.74205173e+12 -2.04555238e+12  5.30e+04 1.37e+04  9.32e+08     1s
   1   3.68189775e+11 -1.19659290e+12  5.99e+03 2.04e-10  1.14e+08     1s
   2   3.04281767e+10 -3.78054195e+11  4.25e+02 2.04e-10  1.08e+07     1s
   3   8.43908671e+09 -4.55538416e+10  5.77e+01 5.24e-10  1.35e+06     1s
   4   5.08581773e+09 -1.75852955e+10  1.96e+01 3.78e-10  4.60e+05     1s
   5   2.41819715e+09 -7.99458027e+09  9.69e+00 1.65e-10  1.98e+05     1s
   6   1.42673136e+08 -1.82816898e+09  7.50e-01 1.65e-10  2.59e+04     1s
   7   6.99302255e+07 -7.35360122e+08  3.03e-01 1.07e-10  9.87e+03     1s
   8   4.70350345e+07 -2.40638669e+08  1.80e-01 1.11e-10  3.46e+03     1s
   9   1.42432624e+07 -8.28069311e+07  2.82e-02 8.84e-11  1.12e+03     1s
  10   9.88717427e+06 -5.09140788e+07  1.57e-02 7.79e-11  7.00e+02     1s
  11   5.38786856e+06 -1.78154831e+07  4.56e-03 3.43e-11  2.66e+02     1s
  12   4.45538256e+06 -9.43276554e+06  2.98e-03 3.43e-11  1.59e+02     1s
  13   3.68433265e+06 -4.52115598e+06  1.83e-03 2.18e-11  9.40e+01     1s
  14   3.29783930e+06 -1.89093110e+06  1.31e-03 4.37e-11  5.94e+01     1s
  15   2.69763114e+06  1.09535296e+05  5.40e-04 1.46e-11  2.96e+01     1s
  16   2.46578547e+06  1.31158087e+06  2.85e-04 1.46e-11  1.32e+01     1s
  17   2.36344144e+06  1.74179624e+06  1.83e-04 1.46e-11  7.11e+00     1s
  18   2.30410424e+06  1.94434794e+06  1.28e-04 1.46e-11  4.12e+00     1s
  19   2.23681644e+06  2.03923231e+06  6.77e-05 1.46e-11  2.26e+00     1s
  20   2.19261839e+06  2.07346124e+06  3.00e-05 1.46e-11  1.36e+00     1s
  21   2.18647391e+06  2.10306680e+06  2.50e-05 1.46e-11  9.54e-01     1s
  22   2.17513903e+06  2.12082637e+06  1.60e-05 1.46e-11  6.21e-01     2s
  23   2.16375283e+06  2.13616973e+06  7.30e-06 2.91e-11  3.16e-01     2s
  24   2.15794260e+06  2.14203442e+06  3.39e-06 2.91e-11  1.82e-01     2s
  25   2.15586447e+06  2.14669206e+06  1.98e-06 1.46e-11  1.05e-01     2s
  26   2.15481717e+06  2.14978102e+06  1.32e-06 2.91e-11  5.76e-02     2s
  27   2.15424198e+06  2.15097830e+06  9.81e-07 2.91e-11  3.73e-02     2s
  28   2.15370537e+06  2.15154136e+06  6.68e-07 2.91e-11  2.48e-02     2s
  29   2.15341016e+06  2.15180061e+06  4.97e-07 2.91e-11  1.84e-02     2s
  30   2.15306016e+06  2.15209135e+06  2.93e-07 2.91e-11  1.11e-02     2s
  31   2.15286204e+06  2.15222949e+06  1.84e-07 2.91e-11  7.24e-03     2s
  32   2.15274353e+06  2.15234139e+06  1.19e-07 2.91e-11  4.60e-03     2s
  33   2.15259786e+06  2.15247355e+06  5.37e-08 5.82e-11  1.42e-03     2s
  34   2.15256712e+06  2.15249308e+06  5.67e-07 2.91e-11  8.47e-04     2s
  35   2.15254560e+06  2.15250013e+06  2.65e-07 2.91e-11  5.20e-04     2s
  36   2.15253665e+06  2.15251167e+06  1.31e-07 5.82e-11  2.86e-04     2s
  37   2.15252931e+06  2.15251677e+06  2.96e-07 5.82e-11  1.43e-04     2s
  38   2.15252258e+06  2.15251781e+06  1.67e-06 5.82e-11  5.46e-05     2s
  39   2.15251944e+06  2.15251830e+06  4.30e-07 5.82e-11  1.31e-05     2s
  40   2.15251858e+06  2.15251843e+06  2.98e-08 5.82e-11  1.69e-06     2s
  41   2.15251850e+06  2.15251849e+06  2.47e-09 5.82e-11  1.51e-07     2s
  42   2.15251849e+06  2.15251849e+06  4.89e-10 5.82e-11  1.99e-08     2s
  43   2.15251849e+06  2.15251849e+06  9.92e-11 4.37e-11  2.36e-09     2s

Barrier solved model in 43 iterations and 2.31 seconds
Optimal objective 2.15251849e+06

Crossover log...

    1022 DPushes remaining with DInf 0.0000000e+00                 2s
       0 DPushes remaining with DInf 0.0000000e+00                 3s
Warning: Markowitz tolerance tightened to 0.25

    1079 PPushes remaining with PInf 1.0000000e-05                 3s
       0 PPushes remaining with PInf 1.1000000e-05                 3s

  Push phase complete: Pinf 1.1000000e-05, Dinf 8.4110437e-11      3s

Iteration    Objective       Primal Inf.    Dual Inf.      Time
    2104    2.1525185e+06   1.000000e-05   0.000000e+00      3s
Extra simplex iterations after uncrush: 87
    2201    2.1525185e+06   0.000000e+00   0.000000e+00      3s

Solved with barrier
Solved in 2201 iterations and 3.31 seconds
Optimal objective  2.152518493e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 2.15e+06
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.74s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-z0by0wy3.lp
Reading time = 0.11 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0x0e7ee3d2
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [1e+01, 8e+01]
  RHS range        [2e-02, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57048 rows and 22025 columns
Presolve time: 0.05s
Presolved: 3936 rows, 4832 columns, 23606 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.833e+04
 Factor NZ  : 6.453e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.199e+06 (less than 1 second per iteration)
 Threads    : 30

Barrier performed 0 iterations in 0.21 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with dual simplex
Solved in 2743 iterations and 0.21 seconds
Optimal objective  1.452736518e+07
INFO:pypsa.linopf:Optimization successful. Objective value: 1.45e+07
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


all




all


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 3.26s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-_iq9tp11.lp
Reading time = 0.29 seconds
obj: 167880 rows, 80305 columns, 282380 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 167880 rows, 80305 columns and 282380 nonzeros
Model fingerprint: 0x061ff226
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [1e+01, 8e+01]
  RHS range        [2e-02, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 154251 rows and 36408 columns
Presolve time: 0.14s
Presolved: 13629 rows, 43897 columns, 91540 nonzeros

Ordering time: 0.37s

Barrier statistics:
 AA' NZ     : 5.273e+04
 Factor NZ  : 8.399e+05 (roughly 30 MBytes of memory)
 Factor Ops : 1.595e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.73039734e+12 -2.01454097e+12  4.77e+04 1.13e+04  9.29e+08     1s
   1   3.68621904e+11 -1.19421283e+12  5.39e+03 1.98e-10  1.14e+08     1s
   2   3.06544001e+10 -3.78241775e+11  3.73e+02 1.75e-10  1.07e+07     1s
   3   9.09327783e+09 -4.69435692e+10  5.20e+01 6.40e-09  1.36e+06     1s
   4   5.58259417e+09 -1.85647950e+10  1.79e+01 1.91e-09  4.79e+05     1s
   5   2.47449191e+09 -8.28686335e+09  8.25e+00 4.91e-10  1.97e+05     1s
   6   1.42115856e+08 -2.26182988e+09  6.83e-01 3.49e-10  3.09e+04     1s
   7   2.48035482e+07 -8.24118376e+08  7.64e-11 1.30e-10  9.67e+03     1s
   8   2.11415448e+07 -3.44927499e+08  4.25e-11 1.01e-10  4.17e+03     1s
   9   1.49608312e+07 -7.16643930e+07  3.27e-11 7.15e-11  9.87e+02     1s
  10   9.26527595e+06 -2.37837275e+07  4.23e-11 5.70e-11  3.76e+02     1s
  11   5.65373140e+06 -7.94086838e+06  8.96e-11 2.18e-11  1.55e+02     1s
  12   4.57838654e+06 -4.36583909e+06  7.87e-11 1.51e-11  1.02e+02     1s
  13   2.97415404e+06 -8.11581176e+05  1.50e-10 1.46e-11  4.31e+01     1s
  14   2.53850359e+06  4.10284350e+05  1.95e-10 1.46e-11  2.42e+01     1s
  15   2.27218419e+06  1.12081584e+06  1.99e-10 1.46e-11  1.31e+01     1s
  16   2.05522551e+06  1.60219077e+06  4.92e-10 1.46e-11  5.16e+00     1s
  17   1.99279670e+06  1.71767212e+06  1.54e-09 1.46e-11  3.13e+00     1s
  18   1.97809408e+06  1.74641942e+06  2.10e-09 1.46e-11  2.64e+00     1s
  19   1.94115833e+06  1.77493364e+06  1.53e-08 1.46e-11  1.89e+00     1s
  20   1.92346054e+06  1.80192899e+06  1.31e-08 1.46e-11  1.38e+00     1s
  21   1.91602834e+06  1.80944684e+06  1.18e-08 1.46e-11  1.21e+00     1s
  22   1.90983398e+06  1.83488740e+06  9.82e-09 1.46e-11  8.54e-01     1s
  23   1.89730371e+06  1.84578543e+06  1.06e-08 1.46e-11  5.87e-01     1s
  24   1.88586113e+06  1.85877391e+06  1.42e-08 1.46e-11  3.09e-01     1s
  25   1.87752582e+06  1.86878209e+06  2.21e-08 2.91e-11  9.96e-02     1s
  26   1.87594191e+06  1.87150001e+06  1.52e-08 1.46e-11  5.06e-02     1s
  27   1.87449558e+06  1.87215657e+06  1.35e-08 1.46e-11  2.66e-02     1s
  28   1.87418047e+06  1.87292306e+06  8.73e-09 2.91e-11  1.43e-02     1s
  29   1.87389873e+06  1.87319415e+06  3.52e-08 2.91e-11  8.03e-03     1s
  30   1.87378274e+06  1.87340780e+06  2.42e-08 2.91e-11  4.27e-03     2s
  31   1.87365309e+06  1.87347899e+06  2.08e-08 2.91e-11  1.98e-03     2s
  32   1.87361453e+06  1.87352518e+06  2.39e-08 4.37e-11  1.02e-03     2s
  33   1.87357849e+06  1.87354631e+06  3.84e-08 2.91e-11  3.67e-04     2s
  34   1.87355879e+06  1.87355506e+06  1.07e-07 5.82e-11  4.25e-05     2s
  35   1.87355631e+06  1.87355579e+06  1.46e-08 5.82e-11  5.93e-06     2s
  36   1.87355605e+06  1.87355602e+06  3.04e-08 5.82e-11  3.40e-07     2s
  37   1.87355603e+06  1.87355603e+06  4.50e-09 5.82e-11  4.43e-08     2s
  38   1.87355603e+06  1.87355603e+06  5.07e-09 5.82e-11  1.14e-08     2s
  39   1.87355603e+06  1.87355603e+06  4.47e-07 8.73e-11  1.47e-09     2s

Barrier solved model in 39 iterations and 1.79 seconds
Optimal objective 1.87355603e+06

Crossover log...

    2124 DPushes remaining with DInf 0.0000000e+00                 2s
       0 DPushes remaining with DInf 0.0000000e+00                 2s

    1617 PPushes remaining with PInf 2.5000000e-05                 2s
       0 PPushes remaining with PInf 2.5000000e-05                 2s

  Push phase complete: Pinf 2.5000000e-05, Dinf 5.8911272e-10      2s

Iteration    Objective       Primal Inf.    Dual Inf.      Time
    3744    1.8735560e+06   2.500000e-05   0.000000e+00      2s
Extra simplex iterations after uncrush: 36
    3794    1.8735560e+06   0.000000e+00   0.000000e+00      2s

Solved with barrier
Solved in 3794 iterations and 2.45 seconds
Optimal objective  1.873556029e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 1.87e+06
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.79s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-hxixt3xx.lp
Reading time = 0.12 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0x6197fc72
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [1e+01, 8e+01]
  RHS range        [2e-02, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57049 rows and 22035 columns
Presolve time: 0.06s
Presolved: 3935 rows, 4822 columns, 23595 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.832e+04
 Factor NZ  : 6.452e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.199e+06 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   3.32954382e+07 -1.06923731e+09  1.89e+04 5.68e-14  4.46e+05     0s
   1   1.90015452e+07 -4.84153411e+08  2.26e+03 1.71e-13  7.69e+04     0s
   2   1.65914961e+07 -5.47055933e+07  1.88e+02 3.01e-12  8.22e+03     0s
   3   1.57887583e+07  5.08974307e+06  2.65e+01 1.14e-13  1.16e+03     0s
   4   1.55378664e+07  9.53833197e+06  6.52e+00 1.42e-13  6.31e+02     0s
   5   1.54661558e+07  1.29101793e+07  3.37e+00 1.14e-13  2.68e+02     0s
   6   1.53901595e+07  1.44788010e+07  1.28e+00 4.97e-14  9.50e+01     0s
   7   1.53419568e+07  1.49563976e+07  3.27e-01 4.53e-14  4.01e+01     0s
   8   1.53287855e+07  1.52810039e+07  1.92e-02 4.32e-14  4.96e+00     0s
   9   1.53273765e+07  1.53257906e+07  1.97e-04 4.17e-14  1.64e-01     0s
  10   1.53273212e+07  1.53273196e+07  1.01e-10 5.01e-14  1.65e-04     0s
  11   1.53273211e+07  1.53273211e+07  9.14e-11 4.25e-14  1.65e-10     0s

Barrier solved model in 11 iterations and 0.21 seconds
Optimal objective 1.53273211e+07


Solved with primal simplex
Solved in 5158 iterations and 0.21 seconds
Optimal objective  1.532732110e+07
INFO:pypsa.linopf:Optimization successful. Objective value: 1.53e+07
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


all




all


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 3.25s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-42ljvsuy.lp
Reading time = 0.30 seconds
obj: 167880 rows, 80305 columns, 282380 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 167880 rows, 80305 columns and 282380 nonzeros
Model fingerprint: 0xaa564574
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [1e+01, 8e+01]
  RHS range        [2e-02, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 154252 rows and 36087 columns
Presolve time: 0.14s
Presolved: 13628 rows, 44218 columns, 91860 nonzeros

Ordering time: 0.45s

Barrier statistics:
 AA' NZ     : 5.273e+04
 Factor NZ  : 8.412e+05 (roughly 30 MBytes of memory)
 Factor Ops : 1.634e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.73565642e+12 -2.02531923e+12  5.29e+04 1.14e+04  9.31e+08     1s
   1   3.73079585e+11 -1.19532042e+12  5.96e+03 2.04e-10  1.14e+08     1s
   2   3.09762595e+10 -3.78610134e+11  4.13e+02 2.04e-10  1.06e+07     1s
   3   8.93562227e+09 -4.73989810e+10  5.45e+01 3.52e-09  1.32e+06     1s
   4   5.46177143e+09 -1.86847475e+10  1.79e+01 1.09e-09  4.57e+05     1s
   5   1.87098287e+09 -7.79099765e+09  6.53e+00 3.49e-10  1.61e+05     1s
   6   1.04527295e+08 -2.09347042e+09  4.45e-01 1.85e-10  2.68e+04     1s
   7   2.31285445e+07 -7.75155418e+08  5.28e-11 1.59e-10  9.03e+03     1s
   8   2.08161771e+07 -3.67450224e+08  4.30e-11 1.01e-10  4.39e+03     1s
   9   1.71991073e+07 -1.11192821e+08  3.02e-11 7.15e-11  1.45e+03     1s
  10   1.14313598e+07 -4.57223151e+07  3.71e-11 5.70e-11  6.46e+02     1s
  11   5.71483374e+06 -1.97211827e+07  3.41e-11 3.51e-11  2.88e+02     2s
  12   4.18310791e+06 -7.45292953e+06  5.05e-11 2.18e-11  1.32e+02     2s
  13   2.64613543e+06 -2.88811157e+06  2.13e-10 2.91e-11  6.26e+01     2s
  14   1.59980617e+06 -9.86261602e+05  9.76e-10 1.46e-11  2.92e+01     2s
  15   1.23245896e+06 -2.10370042e+05  1.36e-09 1.46e-11  1.63e+01     2s
  16   9.45110511e+05  3.48381912e+05  6.64e-10 1.46e-11  6.75e+00     2s
  17   8.75335615e+05  5.22386711e+05  5.22e-10 1.46e-11  3.99e+00     2s
  18   8.29720958e+05  6.27547154e+05  4.36e-10 2.18e-11  2.29e+00     2s
  19   7.77841527e+05  6.81918101e+05  1.50e-09 1.46e-11  1.08e+00     2s
  20   7.51741852e+05  7.02682220e+05  2.25e-09 1.46e-11  5.55e-01     2s
  21   7.40498625e+05  7.16891150e+05  4.30e-09 1.46e-11  2.67e-01     2s
  22   7.32673608e+05  7.23926725e+05  1.10e-08 2.91e-11  9.89e-02     2s
  23   7.31083334e+05  7.25204236e+05  9.01e-09 2.91e-11  6.65e-02     2s
  24   7.29406980e+05  7.26255793e+05  5.05e-09 2.91e-11  3.56e-02     2s
  25   7.28612981e+05  7.26989711e+05  2.00e-08 2.91e-11  1.84e-02     2s
  26   7.28000909e+05  7.27494353e+05  2.52e-08 5.82e-11  5.73e-03     2s
  27   7.27848862e+05  7.27635739e+05  2.99e-08 5.82e-11  2.41e-03     2s
  28   7.27757228e+05  7.27712970e+05  7.97e-08 2.91e-11  5.00e-04     3s
  29   7.27744759e+05  7.27734067e+05  3.24e-08 5.82e-11  1.21e-04     3s
  30   7.27740097e+05  7.27738547e+05  1.71e-08 2.91e-11  1.75e-05     3s
  31   7.27739653e+05  7.27739333e+05  6.35e-08 5.82e-11  3.61e-06     3s
  32   7.27739472e+05  7.27739464e+05  1.36e-09 8.73e-11  8.96e-08     3s
  33   7.27739467e+05  7.27739467e+05  4.93e-10 5.82e-11  7.86e-09     3s

Barrier solved model in 33 iterations and 2.72 seconds
Optimal objective 7.27739467e+05

Crossover log...

    1165 DPushes remaining with DInf 0.0000000e+00                 3s
       0 DPushes remaining with DInf 0.0000000e+00                 3s

     825 PPushes remaining with PInf 4.5000000e-05                 3s
       0 PPushes remaining with PInf 7.5052568e-05                 3s

  Push phase complete: Pinf 7.5052568e-05, Dinf 2.9877989e-10      3s

Iteration    Objective       Primal Inf.    Dual Inf.      Time
    1993    7.2773947e+05   7.405257e-05   0.000000e+00      3s
Extra simplex iterations after uncrush: 132
    2158    7.2773947e+05   0.000000e+00   0.000000e+00      3s

Solved with barrier
Solved in 2158 iterations and 3.12 seconds
Optimal objective  7.277394666e+05
INFO:pypsa.linopf:Optimization successful. Objective value: 7.28e+05
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.79s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-u299d4ho.lp
Reading time = 0.11 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0xfde73e39
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [1e+01, 7e+01]
  RHS range        [2e-02, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57048 rows and 22003 columns
Presolve time: 0.06s
Presolved: 3936 rows, 4854 columns, 23628 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.833e+04
 Factor NZ  : 6.453e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.199e+06 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   4.24051355e+07 -8.93569540e+08  2.24e+04 5.68e-14  4.60e+05     0s
   1   1.54216215e+07 -4.74616887e+08  2.33e+03 1.28e-13  7.64e+04     0s
   2   1.13537276e+07 -8.49723871e+07  2.05e+02 9.95e-14  1.09e+04     0s
   3   1.03050172e+07 -7.35941300e+06  3.02e+01 3.50e-12  1.88e+03     0s
   4   1.01295341e+07  5.93696528e+06  1.54e+01 2.56e-13  4.46e+02     0s
   5   9.90485210e+06  8.37599838e+06  4.71e+00 1.56e-13  1.60e+02     0s
   6   9.80000268e+06  9.19751414e+06  1.71e+00 5.68e-14  6.25e+01     0s
   7   9.74120597e+06  9.53515160e+06  5.41e-01 4.26e-14  2.13e+01     0s

Barrier performed 7 iterations in 0.20 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with primal simplex
Solved in 5119 iterations and 0.21 seconds
Optimal objective  9.704403468e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 9.70e+06
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


all




all


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 3.24s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-px5deu4d.lp
Reading time = 0.30 seconds
obj: 167880 rows, 80305 columns, 282380 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 167880 rows, 80305 columns and 282380 nonzeros
Model fingerprint: 0xe755eff4
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [1e+01, 7e+01]
  RHS range        [2e-02, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 154250 rows and 35484 columns
Presolve time: 0.15s
Presolved: 13630 rows, 44821 columns, 92465 nonzeros

Ordering time: 0.55s

Barrier statistics:
 AA' NZ     : 5.273e+04
 Factor NZ  : 8.460e+05 (roughly 30 MBytes of memory)
 Factor Ops : 1.603e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.72982407e+12 -2.01021203e+12  5.29e+04 1.39e+04  9.30e+08     1s
   1   3.76558636e+11 -1.19803273e+12  5.83e+03 2.93e+02  1.11e+08     1s
   2   3.15930975e+10 -3.73733129e+11  4.18e+02 1.75e-10  1.06e+07     1s
   3   8.79155377e+09 -4.81954193e+10  5.51e+01 1.95e-09  1.33e+06     1s
   4   5.21042132e+09 -1.87605979e+10  1.73e+01 6.40e-10  4.44e+05     1s
   5   2.32307762e+09 -8.34517558e+09  8.07e+00 1.96e-10  1.80e+05     1s
   6   1.49207593e+08 -1.62031336e+09  7.76e-01 2.91e-10  2.28e+04     1s
   7   4.00336601e+07 -5.85020325e+08  9.98e-02 1.36e-10  7.15e+03     1s
   8   2.65798639e+07 -1.98301645e+08  4.75e-02 1.18e-10  2.55e+03     1s
   9   1.17868047e+07 -6.17671934e+07  1.17e-02 6.90e-11  8.24e+02     1s
  10   7.92464226e+06 -3.46054166e+07  5.69e-03 5.44e-11  4.76e+02     1s
  11   5.47700108e+06 -2.12458418e+07  2.55e-03 4.88e-11  2.98e+02     1s
  12   4.53741919e+06 -9.15349973e+06  1.53e-03 3.26e-11  1.53e+02     1s
  13   3.88068706e+06 -5.33511780e+06  9.20e-04 2.53e-11  1.03e+02     1s
  14   3.53707793e+06 -2.44367839e+06  6.45e-04 2.91e-11  6.67e+01     1s
  15   3.16357026e+06  2.30288600e+05  3.59e-04 2.91e-11  3.27e+01     1s
  16   3.01065728e+06  9.58579791e+05  2.54e-04 1.46e-11  2.29e+01     1s
  17   2.79206811e+06  1.79270932e+06  1.13e-04 1.46e-11  1.11e+01     1s
  18   2.69975759e+06  2.40489687e+06  5.99e-05 2.18e-11  3.29e+00     2s
  19   2.63290838e+06  2.50867586e+06  2.70e-05 2.18e-11  1.39e+00     2s
  20   2.60031356e+06  2.52924365e+06  1.22e-05 1.46e-11  7.93e-01     2s
  21   2.58762844e+06  2.55254548e+06  6.71e-06 1.46e-11  3.91e-01     2s
  22   2.58022440e+06  2.56305574e+06  3.67e-06 2.91e-11  1.92e-01     2s
  23   2.57744929e+06  2.56664724e+06  2.61e-06 2.91e-11  1.21e-01     2s
  24   2.57503112e+06  2.56809264e+06  1.71e-06 1.46e-11  7.74e-02     2s
  25   2.57496610e+06  2.56826232e+06  1.68e-06 2.91e-11  7.48e-02     2s
  26   2.57405518e+06  2.56846394e+06  1.36e-06 1.46e-11  6.24e-02     2s
  27   2.57278470e+06  2.56901641e+06  9.08e-07 1.46e-11  4.20e-02     2s
  28   2.57140340e+06  2.56934719e+06  3.95e-07 1.46e-11  2.29e-02     2s
  29   2.57118450e+06  2.56971617e+06  3.17e-07 1.46e-11  1.64e-02     2s
  30   2.57079368e+06  2.56986589e+06  1.73e-07 2.91e-11  1.04e-02     2s
  31   2.57059782e+06  2.57006294e+06  1.18e-07 2.91e-11  5.97e-03     2s
  32   2.57057013e+06  2.57017627e+06  1.02e-07 2.91e-11  4.39e-03     2s
  33   2.57051647e+06  2.57021590e+06  9.82e-08 2.91e-11  3.35e-03     2s
  34   2.57048151e+06  2.57023552e+06  8.02e-08 2.91e-11  2.74e-03     2s
  35   2.57043589e+06  2.57026906e+06  7.29e-08 2.91e-11  1.86e-03     2s
  36   2.57040819e+06  2.57028254e+06  9.76e-08 2.91e-11  1.40e-03     2s
  37   2.57037817e+06  2.57029380e+06  9.73e-08 2.91e-11  9.41e-04     2s
  38   2.57036364e+06  2.57030200e+06  1.00e-07 5.82e-11  6.88e-04     2s
  39   2.57035752e+06  2.57030448e+06  9.06e-08 5.82e-11  5.92e-04     2s
  40   2.57032638e+06  2.57030671e+06  1.88e-07 2.91e-11  2.19e-04     2s
  41   2.57032450e+06  2.57030886e+06  1.95e-07 5.82e-11  1.74e-04     2s
  42   2.57031385e+06  2.57030982e+06  2.10e-07 2.91e-11  4.50e-05     2s
  43   2.57031265e+06  2.57031058e+06  1.29e-07 5.82e-11  2.31e-05     2s
  44   2.57031092e+06  2.57031074e+06  8.09e-07 5.82e-11  2.07e-06     2s
  45   2.57031083e+06  2.57031080e+06  1.64e-07 5.82e-11  3.26e-07     2s
  46   2.57031081e+06  2.57031080e+06  1.95e-08 5.82e-11  4.30e-08     2s
  47   2.57031080e+06  2.57031080e+06  3.37e-09 8.73e-11  8.17e-09     2s

Barrier solved model in 47 iterations and 2.26 seconds
Optimal objective 2.57031080e+06

Crossover log...

    2436 DPushes remaining with DInf 0.0000000e+00                 2s
       0 DPushes remaining with DInf 0.0000000e+00                 2s

    1053 PPushes remaining with PInf 4.0000000e-06                 2s
       0 PPushes remaining with PInf 2.1000000e-05                 3s

  Push phase complete: Pinf 2.1000000e-05, Dinf 4.6492069e-10      3s

Iteration    Objective       Primal Inf.    Dual Inf.      Time
    3492    2.5703108e+06   2.500000e-05   0.000000e+00      3s
Extra simplex iterations after uncrush: 76
    3577    2.5703108e+06   0.000000e+00   0.000000e+00      3s

Solved with barrier
Solved in 3577 iterations and 2.68 seconds
Optimal objective  2.570310804e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 2.57e+06
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.8s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-zl2fd7gr.lp
Reading time = 0.12 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0x693bcf10
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [7e+00, 6e+01]
  RHS range        [1e-02, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57050 rows and 22023 columns
Presolve time: 0.09s
Presolved: 3934 rows, 4834 columns, 23606 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.832e+04
 Factor NZ  : 6.454e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.200e+06 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   2.92102546e+07 -1.09162552e+09  2.12e+04 5.68e-14  5.36e+05     0s
   1   1.16323163e+07 -5.63957090e+08  2.12e+03 1.42e-13  8.79e+04     0s
   2   8.79217444e+06 -8.67725556e+07  2.05e+02 1.42e-13  1.10e+04     0s
   3   7.93896846e+06  8.28393880e+05  1.63e+01 1.14e-13  7.68e+02     0s
   4   7.70335914e+06  6.05518119e+06  2.81e+00 4.26e-13  1.72e+02     0s
   5   7.63450074e+06  6.94722049e+06  1.03e+00 1.88e-13  7.15e+01     0s

Barrier performed 5 iterations in 0.23 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with primal simplex
Solved in 5366 iterations and 0.23 seconds
Optimal objective  7.561867117e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 7.56e+06
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


all




all


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 3.37s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-7ccgybrv.lp
Reading time = 0.31 seconds
obj: 167880 rows, 80305 columns, 282380 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 167880 rows, 80305 columns and 282380 nonzeros
Model fingerprint: 0x7d150d3c
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [7e+00, 6e+01]
  RHS range        [1e-02, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 154265 rows and 35233 columns
Presolve time: 0.16s
Presolved: 13615 rows, 45072 columns, 92701 nonzeros

Ordering time: 0.27s

Barrier statistics:
 AA' NZ     : 5.272e+04
 Factor NZ  : 8.601e+05 (roughly 30 MBytes of memory)
 Factor Ops : 1.672e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.24616566e+12 -2.01016855e+12  3.73e+04 1.38e+04  6.64e+08     1s
   1   2.84771226e+11 -1.13119554e+12  4.40e+03 5.82e+03  8.61e+07     1s
   2   3.35341812e+10 -3.16350671e+11  4.38e+02 1.80e-10  1.02e+07     1s
   3   8.68075636e+09 -5.43193771e+10  5.97e+01 2.33e-10  1.46e+06     1s
   4   4.37891265e+09 -2.02136072e+10  1.06e+01 2.91e-10  3.83e+05     1s
   5   1.88508544e+09 -9.98005361e+09  4.72e+00 3.84e-09  1.68e+05     1s
   6   1.19244730e+08 -1.46751600e+09  3.73e-01 1.76e-10  1.88e+04     1s
   7   5.25560511e+07 -5.67043417e+08  1.13e-01 1.40e-10  7.04e+03     1s
   8   3.75150389e+07 -1.95871854e+08  6.66e-02 8.84e-11  2.63e+03     1s
   9   1.58258721e+07 -7.75524491e+07  1.42e-02 8.84e-11  1.04e+03     1s
  10   1.08487786e+07 -3.76468558e+07  7.50e-03 7.39e-11  5.40e+02     1s
  11   6.93575501e+06 -1.43874975e+07  3.22e-03 3.75e-11  2.37e+02     1s
  12   5.72722502e+06 -5.47148784e+06  2.16e-03 1.97e-11  1.24e+02     1s
  13   4.40601035e+06 -2.04993392e+06  1.07e-03 1.64e-11  7.17e+01     1s
  14   4.03717738e+06 -4.18367964e+05  7.93e-04 1.46e-11  4.94e+01     1s
  15   3.63042442e+06  9.36373447e+05  4.96e-04 2.91e-11  2.99e+01     1s
  16   3.51265979e+06  1.46734389e+06  4.12e-04 1.46e-11  2.27e+01     1s
  17   3.27029851e+06  2.09687855e+06  2.43e-04 1.46e-11  1.30e+01     1s
  18   3.05747586e+06  2.42590605e+06  9.88e-05 1.46e-11  7.01e+00     1s
  19   2.98575740e+06  2.64199318e+06  5.65e-05 2.18e-11  3.81e+00     1s
  20   2.93699306e+06  2.72743757e+06  2.75e-05 1.46e-11  2.32e+00     1s
  21   2.91219729e+06  2.78239406e+06  1.37e-05 1.46e-11  1.44e+00     1s
  22   2.90094546e+06  2.82543615e+06  7.75e-06 1.46e-11  8.38e-01     1s
  23   2.89265875e+06  2.84819405e+06  3.90e-06 1.46e-11  4.93e-01     1s
  24   2.88827437e+06  2.85779366e+06  2.01e-06 1.46e-11  3.38e-01     1s
  25   2.88515836e+06  2.86867252e+06  8.43e-07 1.46e-11  1.83e-01     1s
  26   2.88331762e+06  2.87722808e+06  2.71e-07 1.46e-11  6.76e-02     1s
  27   2.88255958e+06  2.87879205e+06  9.25e-08 1.46e-11  4.18e-02     1s
  28   2.88218881e+06  2.88131550e+06  2.54e-08 2.18e-11  9.69e-03     1s
  29   2.88206891e+06  2.88173113e+06  2.15e-08 2.91e-11  3.75e-03     1s
  30   2.88201309e+06  2.88194918e+06  8.68e-09 1.46e-11  7.09e-04     1s
  31   2.88199958e+06  2.88197815e+06  1.35e-08 5.82e-11  2.38e-04     1s
  32   2.88199246e+06  2.88199022e+06  3.76e-08 5.82e-11  2.49e-05     2s
  33   2.88199180e+06  2.88199120e+06  1.22e-08 5.82e-11  6.65e-06     2s
  34   2.88199150e+06  2.88199144e+06  1.29e-09 2.91e-11  6.77e-07     2s
  35   2.88199147e+06  2.88199146e+06  9.43e-10 2.91e-11  7.65e-08     2s
  36   2.88199146e+06  2.88199146e+06  1.46e-07 5.82e-11  1.58e-08     2s
  37   2.88199146e+06  2.88199146e+06  5.84e-07 5.82e-11  6.92e-09     2s

Barrier solved model in 37 iterations and 1.77 seconds
Optimal objective 2.88199146e+06

Crossover log...

    2110 DPushes remaining with DInf 0.0000000e+00                 2s
       0 DPushes remaining with DInf 0.0000000e+00                 2s

    1117 PPushes remaining with PInf 5.7000000e-05                 2s
       0 PPushes remaining with PInf 7.8083333e-05                 2s

  Push phase complete: Pinf 7.8083333e-05, Dinf 2.6067580e-10      2s

Iteration    Objective       Primal Inf.    Dual Inf.      Time
    3230    2.8819915e+06   4.908333e-05   0.000000e+00      3s
Extra simplex iterations after uncrush: 101
    3366    2.8819915e+06   0.000000e+00   0.000000e+00      3s

Solved with barrier
Solved in 3366 iterations and 2.68 seconds
Optimal objective  2.881991460e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 2.88e+06
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.8s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-hfhl4_ej.lp
Reading time = 0.11 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0x793ec710
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [3e+00, 4e+01]
  RHS range        [7e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57049 rows and 22023 columns
Presolve time: 0.05s
Presolved: 3935 rows, 4834 columns, 23607 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.832e+04
 Factor NZ  : 6.452e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.199e+06 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   3.83511708e+07 -1.05658320e+09  1.91e+04 5.68e-14  4.82e+05     0s
   1   1.92045720e+07 -5.14426809e+08  2.28e+03 1.71e-13  8.39e+04     0s
   2   1.60979579e+07 -7.10124283e+07  2.09e+02 1.42e-13  1.01e+04     0s
   3   1.51224070e+07  3.02665891e+06  2.44e+01 2.27e-13  1.31e+03     0s
   4   1.47790580e+07  1.16140790e+07  3.63e+00 6.54e-13  3.31e+02     0s
   5   1.46933814e+07  1.28696530e+07  1.58e+00 2.27e-13  1.90e+02     0s
   6   1.46283616e+07  1.40619834e+07  5.99e-01 8.53e-14  5.88e+01     0s
   7   1.45994693e+07  1.44004017e+07  2.00e-01 8.53e-14  2.06e+01     0s
   8   1.45899077e+07  1.45382780e+07  5.94e-02 3.91e-14  5.35e+00     0s
   9   1.45856127e+07  1.45762133e+07  1.01e-02 5.68e-14  9.74e-01     0s
  10   1.45848631e+07  1.45846428e+07  5.75e-05 4.92e-14  2.28e-02     0s
  11   1.45846610e+07  1.45846607e+07  6.18e-08 4.23e-14  2.27e-05     0s
  12   1.45846609e+07  1.45846609e+07  2.91e-06 4.26e-14  2.27e-08     0s

Barrier performed 12 iterations in 0.22 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with primal simplex
Solved in 5133 iterations and 0.22 seconds
Optimal objective  1.458466087e+07
INFO:pypsa.linopf:Optimization successful. Objective value: 1.46e+07
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


all




all


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 3.26s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-ayka278d.lp
Reading time = 0.31 seconds
obj: 167880 rows, 80305 columns, 282380 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 167880 rows, 80305 columns and 282380 nonzeros
Model fingerprint: 0x3717f695
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [3e+00, 4e+01]
  RHS range        [1e-06, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 154250 rows and 35408 columns
Presolve time: 0.15s
Presolved: 13630 rows, 44897 columns, 92541 nonzeros

Ordering time: 0.81s

Barrier statistics:
 AA' NZ     : 5.273e+04
 Factor NZ  : 8.439e+05 (roughly 30 MBytes of memory)
 Factor Ops : 1.614e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.73303321e+12 -2.00702369e+12  5.29e+04 1.28e+04  9.31e+08     1s
   1   3.76130100e+11 -1.19345570e+12  5.77e+03 2.03e+02  1.10e+08     1s
   2   3.10652680e+10 -3.68027974e+11  4.07e+02 1.75e-10  1.04e+07     1s
   3   8.42226884e+09 -4.78063133e+10  4.92e+01 1.75e-10  1.26e+06     1s
   4   4.87884125e+09 -1.80440269e+10  1.34e+01 3.49e-10  3.96e+05     1s
   5   1.24471809e+09 -6.69271887e+09  3.85e+00 2.62e-10  1.18e+05     2s
   6   6.10467446e+07 -1.20583928e+09  1.64e-01 2.17e-10  1.46e+04     2s
   7   4.71396206e+07 -5.81014132e+08  1.11e-01 1.59e-10  7.20e+03     2s
   8   3.72672257e+07 -3.04970217e+08  7.97e-02 1.30e-10  3.91e+03     2s
   9   1.66868352e+07 -9.00608292e+07  2.12e-02 1.07e-10  1.20e+03     2s
  10   1.13214898e+07 -3.64847902e+07  1.19e-02 1.07e-10  5.36e+02     2s
  11   5.01730713e+06 -1.47172205e+07  2.87e-03 7.15e-11  2.20e+02     2s
  12   3.42863490e+06 -8.01833385e+06  1.38e-03 5.70e-11  1.28e+02     2s
  13   2.54879038e+06 -1.96055755e+06  6.16e-04 3.51e-11  5.03e+01     2s
  14   2.19281327e+06 -1.23662080e+05  3.67e-04 1.97e-11  2.58e+01     2s
  15   1.89151916e+06  7.06554215e+05  1.67e-04 2.18e-11  1.32e+01     2s
  16   1.74996541e+06  1.15361957e+06  8.20e-05 1.46e-11  6.64e+00     2s
  17   1.67013693e+06  1.42804924e+06  3.88e-05 2.18e-11  2.70e+00     2s
  18   1.62602395e+06  1.52059326e+06  1.77e-05 1.46e-11  1.17e+00     2s
  19   1.60065145e+06  1.55860648e+06  7.13e-06 2.91e-11  4.68e-01     2s
  20   1.59054981e+06  1.56532287e+06  3.29e-06 1.46e-11  2.81e-01     3s
  21   1.58505350e+06  1.57232064e+06  1.37e-06 1.46e-11  1.42e-01     3s
  22   1.58229712e+06  1.57470514e+06  4.61e-07 1.46e-11  8.46e-02     3s
  23   1.58190798e+06  1.57869051e+06  3.47e-07 1.46e-11  3.58e-02     3s
  24   1.58106226e+06  1.57965309e+06  1.06e-07 1.46e-11  1.57e-02     3s
  25   1.58099402e+06  1.57993605e+06  8.83e-08 1.46e-11  1.18e-02     3s
  26   1.58084280e+06  1.58031679e+06  5.14e-08 2.91e-11  5.86e-03     3s
  27   1.58077376e+06  1.58041584e+06  3.28e-08 2.91e-11  3.99e-03     3s
  28   1.58072213e+06  1.58048379e+06  3.71e-08 2.91e-11  2.65e-03     3s
  29   1.58069914e+06  1.58050716e+06  8.06e-08 2.91e-11  2.14e-03     3s
  30   1.58064775e+06  1.58059507e+06  3.85e-08 2.91e-11  5.87e-04     3s
  31   1.58063753e+06  1.58062460e+06  1.06e-07 5.82e-11  1.44e-04     3s
  32   1.58063472e+06  1.58062968e+06  6.46e-07 2.91e-11  5.61e-05     3s
  33   1.58063376e+06  1.58063325e+06  1.24e-07 5.82e-11  5.75e-06     3s
  34   1.58063350e+06  1.58063349e+06  3.96e-08 5.82e-11  1.34e-07     3s
  35   1.58063350e+06  1.58063350e+06  5.78e-09 5.82e-11  5.10e-09     3s

Barrier solved model in 35 iterations and 3.31 seconds
Optimal objective 1.58063350e+06

Crossover log...

    1924 DPushes remaining with DInf 0.0000000e+00                 3s
       0 DPushes remaining with DInf 0.0000000e+00                 4s

     878 PPushes remaining with PInf 1.7000000e-05                 4s
       0 PPushes remaining with PInf 2.8041667e-05                 4s

  Push phase complete: Pinf 2.8041667e-05, Dinf 6.6312567e-10      4s

Iteration    Objective       Primal Inf.    Dual Inf.      Time
    2805    1.5806335e+06   2.904167e-05   0.000000e+00      4s
Extra simplex iterations after uncrush: 33
    2852    1.5806335e+06   0.000000e+00   0.000000e+00      4s

Solved with barrier
Solved in 2852 iterations and 3.97 seconds
Optimal objective  1.580633499e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 1.58e+06
INFO:pypsa.io:Exported network elec_s300_200_ec_lcopt_1H-noex_210wind138solar_bat_all.nc has lines, carriers, generators, stores, buses, links, storage_units, loads
carrier
CCGT          18120.910000
OCGT           8044.269704
biomass         839.020000
coal          28069.379795
lignite       20833.500000
nuclear       15788.438693
offwind-ac     1125.369769
offwind-dc     3359.069844
oil            3696.400000
onwind        47837.387673
ror            2907.579410
solar         43394.372511
Name: p_nom, dtype: float64
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.79s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-i14ln5f6.lp
Reading time = 0.12 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0x8a0005e1
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [2e+00, 1e+01]
  RHS range        [4e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57098 rows and 22090 columns
Presolve time: 0.05s
Presolved: 3886 rows, 4767 columns, 23491 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.828e+04
 Factor NZ  : 6.435e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.205e+06 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   3.69142037e+07 -1.95162591e+09  1.25e+04 1.54e+00  6.07e+05     0s
   1   2.41112936e+07 -6.56173984e+08  3.52e+02 2.84e-13  7.73e+04     0s
   2   2.22745498e+07 -3.25269915e+07  6.76e+00 2.27e-13  5.78e+03     0s
   3   2.17461586e+07  1.64475597e+07  5.20e-01 1.42e-13  5.56e+02     0s
   4   2.15327232e+07  2.03695249e+07  1.24e-01 5.68e-14  1.22e+02     0s
   5   2.14533786e+07  2.11969153e+07  2.64e-02 5.68e-14  2.69e+01     0s
   6   2.14417085e+07  2.14268018e+07  3.80e-03 5.68e-14  1.56e+00     0s
   7   2.14399931e+07  2.14398457e+07  5.88e-05 5.68e-14  1.55e-02     0s
   8   2.14399607e+07  2.14399605e+07  8.53e-12 5.68e-14  1.55e-05     0s
   9   2.14399607e+07  2.14399607e+07  5.46e-12 4.43e-14  1.62e-11     0s

Barrier solved model in 9 iterations and 0.16 seconds
Optimal objective 2.14399607e+07

Crossover log...

       0 DPushes remaining with DInf 0.0000000e+00                 0s

     414 PPushes remaining with PInf 0.0000000e+00                 0s

Solved with primal simplex
Solved in 5052 iterations and 0.21 seconds
Optimal objective  2.143996066e+07
INFO:pypsa.linopf:Optimization successful. Objective value: 2.14e+07
solve_redispatch_network.py:711: DeprecationWarning:

The default dtype for empty Series will be 'object' instead of 'float64' in a future version. Specify a dtype explicitly to silence this warning.

solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


load


add_BESS_load
300


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 2.81s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-3nztzwl0.lp
Reading time = 0.29 seconds
obj: 154248 rows, 73489 columns, 258595 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 154248 rows, 73489 columns and 258595 nonzeros
Model fingerprint: 0x86b095a6
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [2e+00, 1e+01]
  RHS range        [4e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 142704 rows and 33900 columns
Presolve time: 0.12s
Presolved: 11544 rows, 39589 columns, 81810 nonzeros

Ordering time: 0.22s

Barrier statistics:
 AA' NZ     : 4.901e+04
 Factor NZ  : 7.178e+05 (roughly 26 MBytes of memory)
 Factor Ops : 1.280e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.73643699e+12 -2.08268281e+12  5.29e+04 2.33e-11  9.65e+08     0s
   1   3.75915510e+11 -1.23917541e+12  5.24e+03 1.88e-10  1.07e+08     1s
   2   3.87926375e+10 -3.48884998e+11  4.57e+02 2.04e-10  1.15e+07     1s
   3   9.77538077e+09 -4.85750785e+10  4.44e+01 2.04e-10  1.30e+06     1s
   4   5.75675045e+09 -2.09985374e+10  7.01e+00 3.64e-09  4.11e+05     1s
   5   2.83429861e+09 -8.44669391e+09  3.44e+00 1.06e-09  1.68e+05     1s
   6   4.27694824e+08 -1.32159949e+09  6.46e-01 5.41e-10  2.41e+04     1s
   7   2.20893656e+07 -4.22895623e+08  1.33e-03 2.17e-10  5.62e+03     1s
   8   1.76200584e+07 -1.44401350e+08  7.50e-04 2.46e-10  2.05e+03     1s
   9   8.72777095e+06 -4.50793222e+07  1.26e-04 1.30e-10  6.80e+02     1s
  10   5.51589401e+06 -1.83569894e+07  6.88e-05 1.01e-10  3.02e+02     1s
  11   2.51246259e+06 -6.06028502e+06  2.19e-05 7.15e-11  1.08e+02     1s
  12   1.46061528e+06 -2.41842258e+06  9.96e-06 3.51e-11  4.90e+01     1s
  13   9.36015882e+05 -4.87489545e+05  4.79e-06 2.91e-11  1.80e+01     1s
  14   7.66366065e+05 -9.77613526e+04  3.23e-06 5.82e-11  1.09e+01     1s
  15   5.51845426e+05  1.10630715e+05  1.38e-06 5.82e-11  5.57e+00     1s
  16   4.57150689e+05  2.28791658e+05  5.86e-07 5.82e-11  2.88e+00     1s
  17   4.19707530e+05  3.23712030e+05  2.96e-07 5.82e-11  1.21e+00     1s
  18   3.90885722e+05  3.59496892e+05  8.72e-08 2.91e-11  3.96e-01     1s
  19   3.84578106e+05  3.66829551e+05  6.19e-08 2.91e-11  2.24e-01     1s
  20   3.82878069e+05  3.69466749e+05  6.82e-08 2.91e-11  1.69e-01     1s
  21   3.81733071e+05  3.70663509e+05  4.65e-08 5.82e-11  1.40e-01     1s
  22   3.79792522e+05  3.71950760e+05  1.88e-07 2.91e-11  9.90e-02     1s
  23   3.78285043e+05  3.73910620e+05  2.89e-07 2.91e-11  5.52e-02     1s
  24   3.77391330e+05  3.75614266e+05  2.56e-07 5.82e-11  2.24e-02     1s
  25   3.76955439e+05  3.76074163e+05  1.86e-07 2.91e-11  1.11e-02     1s
  26   3.76941307e+05  3.76360211e+05  1.74e-07 5.82e-11  7.34e-03     1s
  27   3.76772627e+05  3.76535519e+05  1.64e-07 5.82e-11  2.99e-03     1s
  28   3.76691472e+05  3.76580606e+05  2.23e-07 2.91e-11  1.40e-03     1s
  29   3.76678845e+05  3.76581359e+05  2.64e-07 5.82e-11  1.23e-03     1s
  30   3.76676083e+05  3.76593096e+05  2.14e-07 2.91e-11  1.05e-03     1s
  31   3.76658496e+05  3.76623985e+05  1.94e-07 2.91e-11  4.36e-04     1s
  32   3.76640863e+05  3.76634045e+05  1.41e-07 2.91e-11  8.61e-05     1s
  33   3.76638015e+05  3.76636509e+05  2.53e-07 5.82e-11  1.90e-05     1s
  34   3.76637149e+05  3.76637127e+05  1.38e-07 5.82e-11  2.96e-07     1s
  35   3.76637142e+05  3.76637142e+05  7.94e-08 5.82e-11  8.55e-11     1s

Barrier solved model in 35 iterations and 1.49 seconds
Optimal objective 3.76637142e+05

Crossover log...

     477 DPushes remaining with DInf 0.0000000e+00                 2s
       0 DPushes remaining with DInf 0.0000000e+00                 2s

    1292 PPushes remaining with PInf 0.0000000e+00                 2s
       0 PPushes remaining with PInf 2.0000000e-06                 2s

  Push phase complete: Pinf 2.0000000e-06, Dinf 4.3078252e-10      2s

Iteration    Objective       Primal Inf.    Dual Inf.      Time
    1772    3.7663714e+05   3.000000e-06   0.000000e+00      2s
Extra simplex iterations after uncrush: 30
    1805    3.7663714e+05   0.000000e+00   0.000000e+00      2s

Solved with barrier
Solved in 1805 iterations and 2.23 seconds
Optimal objective  3.766371420e+05
INFO:pypsa.linopf:Optimization successful. Objective value: 3.77e+05
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.77s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-_tlkewla.lp
Reading time = 0.11 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0x5e8ba894
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [2e+00, 1e+01]
  RHS range        [4e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57048 rows and 22036 columns
Presolve time: 0.05s
Presolved: 3936 rows, 4821 columns, 23595 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.833e+04
 Factor NZ  : 6.453e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.199e+06 (less than 1 second per iteration)
 Threads    : 30

Barrier performed 0 iterations in 0.20 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with primal simplex
Solved in 4875 iterations and 0.20 seconds
Optimal objective  1.804032770e+07
INFO:pypsa.linopf:Optimization successful. Objective value: 1.80e+07
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


load


add_BESS_load
300


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 2.71s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-e8vujblr.lp
Reading time = 0.27 seconds
obj: 154248 rows, 73489 columns, 258595 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 154248 rows, 73489 columns and 258595 nonzeros
Model fingerprint: 0x6b246601
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [2e+00, 1e+01]
  RHS range        [4e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 142320 rows and 33803 columns
Presolve time: 0.11s
Presolved: 11928 rows, 39686 columns, 82291 nonzeros

Ordering time: 0.59s

Barrier statistics:
 AA' NZ     : 4.940e+04
 Factor NZ  : 7.082e+05 (roughly 27 MBytes of memory)
 Factor Ops : 1.222e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.73942482e+12 -2.09391988e+12  5.31e+04 1.36e-11  9.68e+08     1s
   1   3.75320217e+11 -1.24012701e+12  5.36e+03 2.16e-10  1.09e+08     1s
   2   3.52660972e+10 -3.73773999e+11  4.27e+02 2.04e-10  1.14e+07     1s
   3   9.24027389e+09 -5.16360956e+10  4.29e+01 1.78e-09  1.32e+06     1s
   4   5.85751477e+09 -1.96298414e+10  9.33e+00 2.19e-09  4.19e+05     2s
   5   2.05713991e+09 -7.35202755e+09  3.44e+00 1.26e-09  1.44e+05     2s
   6   2.13615259e+08 -1.91089023e+09  4.34e-01 5.89e-10  2.84e+04     2s
   7   2.32564636e+07 -5.02002145e+08  5.21e-11 2.17e-10  6.62e+03     2s

Barrier performed 7 iterations in 1.89 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with dual simplex
Solved in 12658 iterations and 1.89 seconds
Optimal objective  1.125100425e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 1.13e+06
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.77s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-l972vxeu.lp
Reading time = 0.11 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0x293a9fa6
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [2e+00, 1e+01]
  RHS range        [4e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57048 rows and 22035 columns
Presolve time: 0.05s
Presolved: 3936 rows, 4822 columns, 23596 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.833e+04
 Factor NZ  : 6.453e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.199e+06 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   5.57688016e+07 -2.23125074e+09  2.04e+04 1.14e-13  9.77e+05     0s

Barrier performed 0 iterations in 0.18 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with dual simplex
Solved in 2725 iterations and 0.19 seconds
Optimal objective  2.437006807e+07
INFO:pypsa.linopf:Optimization successful. Objective value: 2.44e+07
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


load


add_BESS_load
300


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 2.9s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-4bg5rvf5.lp
Reading time = 0.31 seconds
obj: 154248 rows, 73489 columns, 258595 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 154248 rows, 73489 columns and 258595 nonzeros
Model fingerprint: 0x413b688f
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [2e+00, 1e+01]
  RHS range        [4e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 142320 rows and 32607 columns
Presolve time: 0.20s
Presolved: 11928 rows, 40882 columns, 83487 nonzeros

Ordering time: 0.33s

Barrier statistics:
 AA' NZ     : 4.940e+04
 Factor NZ  : 7.082e+05 (roughly 27 MBytes of memory)
 Factor Ops : 1.222e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.73195057e+12 -2.01088113e+12  5.68e+04 1.20e+04  9.28e+08     1s
   1   3.85815993e+11 -1.20817432e+12  6.08e+03 4.13e+02  1.09e+08     1s
   2   3.45881401e+10 -3.73166323e+11  4.49e+02 1.88e-10  1.09e+07     1s
   3   9.96454385e+09 -4.27880118e+10  4.68e+01 4.19e-09  1.17e+06     1s
   4   4.55669239e+09 -1.53795707e+10  1.28e+01 1.10e-09  3.57e+05     1s
   5   1.77320855e+09 -4.54115091e+09  4.90e+00 2.91e-10  1.05e+05     1s
   6   2.97607004e+08 -2.04788451e+09  8.89e-01 1.88e-10  3.21e+04     1s
   7   1.77628456e+08 -6.71962560e+08  5.16e-01 1.30e-10  1.14e+04     1s
   8   8.79833517e+07 -3.26809097e+08  2.23e-01 1.30e-10  5.37e+03     1s
   9   4.57184881e+07 -1.86876465e+08  9.58e-02 1.30e-10  2.95e+03     1s
  10   3.43489022e+07 -1.14025895e+08  6.56e-02 1.01e-10  1.87e+03     1s
  11   2.08902235e+07 -4.96498631e+07  3.30e-02 1.01e-10  8.82e+02     1s
  12   1.45807339e+07 -2.61379238e+07  1.98e-02 1.11e-10  5.07e+02     1s
  13   7.78585990e+06 -8.20606744e+06  6.96e-03 1.30e-10  1.97e+02     1s
  14   5.88200296e+06 -3.38574729e+06  3.83e-03 7.15e-11  1.14e+02     1s
  15   4.64426289e+06 -7.98455742e+05  1.97e-03 5.70e-11  6.68e+01     1s
  16   4.31321053e+06  6.76025879e+05  1.51e-03 4.24e-11  4.46e+01     1s
  17   3.83545246e+06  1.67948166e+06  8.69e-04 2.91e-11  2.64e+01     1s
  18   3.67498286e+06  2.27873734e+06  6.65e-04 2.91e-11  1.71e+01     1s
  19   3.49233959e+06  2.57887682e+06  4.39e-04 1.46e-11  1.12e+01     1s
  20   3.30428566e+06  2.82608213e+06  2.12e-04 1.46e-11  5.85e+00     1s
  21   3.23030618e+06  3.00913319e+06  1.27e-04 2.91e-11  2.71e+00     1s
  22   3.19032791e+06  3.05404900e+06  8.33e-05 2.91e-11  1.67e+00     1s
  23   3.14941581e+06  3.07440253e+06  4.04e-05 5.82e-11  9.18e-01     1s
  24   3.13124545e+06  3.09137235e+06  2.21e-05 2.91e-11  4.88e-01     1s
  25   3.12208964e+06  3.09758746e+06  1.32e-05 2.91e-11  3.00e-01     1s
  26   3.11960473e+06  3.10206519e+06  1.09e-05 2.91e-11  2.15e-01     1s
  27   3.11394855e+06  3.10448422e+06  5.69e-06 2.91e-11  1.16e-01     2s
  28   3.10991608e+06  3.10613734e+06  2.03e-06 2.91e-11  4.62e-02     2s
  29   3.10892969e+06  3.10708644e+06  1.17e-06 1.46e-11  2.25e-02     2s
  30   3.10794600e+06  3.10744938e+06  2.87e-07 5.82e-11  6.08e-03     2s
  31   3.10771599e+06  3.10753158e+06  1.06e-07 5.82e-11  2.26e-03     2s
  32   3.10760520e+06  3.10756615e+06  6.08e-08 5.82e-11  4.78e-04     2s
  33   3.10758434e+06  3.10757374e+06  5.88e-08 5.82e-11  1.30e-04     2s
  34   3.10757846e+06  3.10757747e+06  5.66e-08 5.82e-11  1.21e-05     2s
  35   3.10757830e+06  3.10757818e+06  9.01e-09 5.82e-11  1.47e-06     2s
  36   3.10757827e+06  3.10757827e+06  9.61e-10 5.82e-11  5.82e-08     2s
  37   3.10757827e+06  3.10757827e+06  7.26e-08 5.82e-11  7.26e-09     2s

Barrier solved model in 37 iterations and 1.81 seconds
Optimal objective 3.10757827e+06

Crossover log...

    1812 DPushes remaining with DInf 0.0000000e+00                 2s
       0 DPushes remaining with DInf 0.0000000e+00                 2s

     233 PPushes remaining with PInf 7.0000000e-06                 2s

Solved with dual simplex
Solved in 11667 iterations and 2.13 seconds
Optimal objective  3.107578266e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 3.11e+06
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.79s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-zxfx6hrx.lp
Reading time = 0.12 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0x69ca2654
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [2e+00, 1e+01]
  RHS range        [4e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57048 rows and 22036 columns
Presolve time: 0.08s
Presolved: 3936 rows, 4821 columns, 23595 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.833e+04
 Factor NZ  : 6.453e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.199e+06 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   5.95263108e+07 -2.11162076e+09  2.04e+04 1.14e-13  9.27e+05     0s
   1   3.58352590e+07 -9.95980301e+08  2.70e+03 2.84e-13  1.67e+05     0s
   2   3.02663339e+07 -1.50308583e+08  2.27e+02 2.84e-13  2.09e+04     0s
   3   2.87517875e+07  3.63767161e+06  2.46e+01 2.73e-12  2.71e+03     0s
   4   2.81676708e+07  2.40615016e+07  5.73e+00 1.61e-11  4.34e+02     0s
   5   2.79225427e+07  2.66868173e+07  2.09e+00 4.18e-12  1.30e+02     0s
   6   2.78366760e+07  2.73876469e+07  8.06e-01 1.42e-12  4.70e+01     0s
   7   2.77907338e+07  2.76204474e+07  1.59e-01 5.68e-13  1.77e+01     0s
   8   2.77805321e+07  2.77592259e+07  2.10e-02 7.11e-14  2.22e+00     0s
   9   2.77786771e+07  2.77777484e+07  3.42e-04 8.85e-14  9.65e-02     0s
  10   2.77786153e+07  2.77786143e+07  1.89e-10 9.29e-14  9.88e-05     0s
  11   2.77786152e+07  2.77786152e+07  2.94e-10 8.53e-14  1.01e-10     0s

Barrier solved model in 11 iterations and 0.21 seconds
Optimal objective 2.77786152e+07

Crossover log...


Solved with primal simplex
Solved in 5238 iterations and 0.22 seconds
Optimal objective  2.777861522e+07
INFO:pypsa.linopf:Optimization successful. Objective value: 2.78e+07
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


load


add_BESS_load
300


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 2.79s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-8n0qkqnj.lp
Reading time = 0.29 seconds
obj: 154248 rows, 73489 columns, 258595 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 154248 rows, 73489 columns and 258595 nonzeros
Model fingerprint: 0x1849b24e
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [2e+00, 1e+01]
  RHS range        [4e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 142325 rows and 34017 columns
Presolve time: 0.15s
Presolved: 11923 rows, 39472 columns, 82072 nonzeros

Ordering time: 0.22s

Barrier statistics:
 AA' NZ     : 4.939e+04
 Factor NZ  : 7.210e+05 (roughly 27 MBytes of memory)
 Factor Ops : 1.277e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.72331800e+12 -2.04039229e+12  5.16e+04 1.42e-11  9.66e+08     0s
   1   3.64504306e+11 -1.24811706e+12  5.20e+03 2.04e-10  1.09e+08     0s
   2   3.42985814e+10 -3.80864471e+11  3.92e+02 2.04e-10  1.11e+07     1s
   3   9.77426382e+09 -6.12941521e+10  3.36e+01 1.46e-09  1.33e+06     1s
   4   5.70251612e+09 -1.95311157e+10  8.17e+00 1.34e-09  3.99e+05     1s
   5   1.62036164e+09 -6.98121277e+09  2.49e+00 4.66e-10  1.25e+05     1s
   6   2.55764830e+08 -2.39368432e+09  4.54e-01 2.10e-10  3.52e+04     1s
   7   1.40282830e+08 -1.05461431e+09  2.31e-01 2.10e-10  1.56e+04     1s
   8   3.68171619e+07 -3.85567515e+08  1.75e-02 1.80e-10  5.37e+03     1s
   9   1.95578790e+07 -1.50897579e+08  3.16e-03 1.30e-10  2.16e+03     1s
  10   1.25650443e+07 -6.33463535e+07  1.22e-03 1.30e-10  9.62e+02     1s
  11   7.05938060e+06 -2.47108429e+07  1.88e-04 1.01e-10  4.02e+02     1s
  12   5.59651355e+06 -9.44804663e+06  8.36e-05 7.15e-11  1.91e+02     1s
  13   4.32274198e+06 -3.71613211e+05  1.72e-05 5.82e-11  5.95e+01     1s
  14   4.03857745e+06  1.87239324e+06  8.69e-06 2.91e-11  2.74e+01     1s
  15   3.77338465e+06  2.93988579e+06  2.04e-06 2.91e-11  1.06e+01     1s
  16   3.71254943e+06  3.33396159e+06  8.61e-07 2.91e-11  4.80e+00     1s
  17   3.67647885e+06  3.53623726e+06  2.72e-07 5.82e-11  1.78e+00     1s
  18   3.65617247e+06  3.62958773e+06  3.33e-08 5.82e-11  3.37e-01     1s
  19   3.65234402e+06  3.64084586e+06  1.18e-08 2.91e-11  1.46e-01     1s
  20   3.65091328e+06  3.64563698e+06  5.60e-09 2.91e-11  6.68e-02     1s
  21   3.65039605e+06  3.64781133e+06  6.01e-09 2.91e-11  3.27e-02     1s
  22   3.65005577e+06  3.64883926e+06  3.55e-09 2.91e-11  1.54e-02     1s
  23   3.64984997e+06  3.64929779e+06  1.49e-08 2.91e-11  6.99e-03     1s
  24   3.64971896e+06  3.64957191e+06  1.09e-08 5.82e-11  1.86e-03     1s
  25   3.64969700e+06  3.64965019e+06  1.30e-08 2.91e-11  5.93e-04     1s
  26   3.64968930e+06  3.64968150e+06  7.73e-08 5.82e-11  9.88e-05     1s
  27   3.64968863e+06  3.64968645e+06  2.87e-08 5.82e-11  2.76e-05     1s
  28   3.64968825e+06  3.64968784e+06  2.59e-09 5.82e-11  5.15e-06     1s
  29   3.64968819e+06  3.64968808e+06  5.43e-10 5.82e-11  1.38e-06     1s
  30   3.64968818e+06  3.64968818e+06  3.32e-09 5.82e-11  3.64e-08     1s
  31   3.64968818e+06  3.64968818e+06  2.44e-09 5.82e-11  5.20e-09     1s

Barrier solved model in 31 iterations and 1.10 seconds
Optimal objective 3.64968818e+06

Crossover log...

    1133 DPushes remaining with DInf 0.0000000e+00                 1s
       0 DPushes remaining with DInf 0.0000000e+00                 1s

     649 PPushes remaining with PInf 4.0000000e-06                 1s
       0 PPushes remaining with PInf 1.9000000e-05                 2s

  Push phase complete: Pinf 1.9000000e-05, Dinf 3.5879477e-10      2s

Iteration    Objective       Primal Inf.    Dual Inf.      Time
    1785    3.6496882e+06   1.800000e-05   0.000000e+00      2s
Extra simplex iterations after uncrush: 218
    2012    3.6496882e+06   0.000000e+00   0.000000e+00      2s

Solved with barrier
Solved in 2012 iterations and 1.84 seconds
Optimal objective  3.649688177e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 3.65e+06
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.79s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-l1apx471.lp
Reading time = 0.12 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0x87ee401a
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [2e+00, 1e+01]
  RHS range        [4e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57048 rows and 22031 columns
Presolve time: 0.06s
Presolved: 3936 rows, 4826 columns, 23600 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.833e+04
 Factor NZ  : 6.453e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.199e+06 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   4.04451408e+07 -1.92993269e+09  2.06e+04 5.68e-14  8.50e+05     0s
   1   2.23337465e+07 -9.20756371e+08  2.11e+03 2.84e-13  1.40e+05     0s
   2   1.97456338e+07 -1.11107635e+08  2.05e+02 9.66e-13  1.52e+04     0s
   3   1.86574073e+07  6.22643143e+06  1.92e+01 1.25e-12  1.35e+03     0s
   4   1.82517279e+07  1.34095499e+07  3.43e+00 2.44e-12  5.07e+02     0s
   5   1.81581994e+07  1.61739599e+07  1.85e+00 6.25e-13  2.07e+02     0s
   6   1.80300547e+07  1.72075562e+07  7.89e-01 1.85e-13  8.55e+01     0s
   7   1.79517148e+07  1.76012189e+07  2.44e-01 5.68e-14  3.64e+01     0s
   8   1.79133547e+07  1.78121018e+07  4.60e-02 5.68e-14  1.05e+01     0s
   9   1.79028012e+07  1.78754857e+07  9.46e-03 5.68e-14  2.83e+00     0s

Barrier performed 9 iterations in 0.19 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with primal simplex
Solved in 4873 iterations and 0.19 seconds
Optimal objective  1.789941164e+07
INFO:pypsa.linopf:Optimization successful. Objective value: 1.79e+07
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


load


add_BESS_load
300


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 2.81s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-lxqd1dkm.lp
Reading time = 0.29 seconds
obj: 154248 rows, 73489 columns, 258595 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 154248 rows, 73489 columns and 258595 nonzeros
Model fingerprint: 0x64372fe7
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [2e+00, 1e+01]
  RHS range        [4e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 142326 rows and 32963 columns
Presolve time: 0.14s
Presolved: 11922 rows, 40526 columns, 83125 nonzeros

Ordering time: 0.30s

Barrier statistics:
 AA' NZ     : 4.939e+04
 Factor NZ  : 7.315e+05 (roughly 27 MBytes of memory)
 Factor Ops : 1.328e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.72689734e+12 -2.02518688e+12  5.69e+04 1.08e+04  9.45e+08     1s
   1   3.81533447e+11 -1.22833511e+12  6.06e+03 2.17e-10  1.11e+08     1s
   2   3.40340326e+10 -3.80037158e+11  4.39e+02 1.75e-10  1.10e+07     1s
   3   1.00121578e+10 -4.87804539e+10  4.21e+01 3.06e-09  1.20e+06     1s
   4   4.88354115e+09 -1.65804736e+10  1.24e+01 8.22e-10  3.71e+05     1s
   5   1.65420009e+09 -7.27240222e+09  4.50e+00 2.76e-10  1.37e+05     1s
   6   4.62774886e+08 -3.34737599e+09  1.36e+00 1.30e-10  5.26e+04     1s
   7   1.72389426e+08 -1.35799635e+09  4.94e-01 1.30e-10  2.01e+04     1s
   8   1.35839437e+08 -8.37382486e+08  3.69e-01 1.07e-10  1.27e+04     1s
   9   5.22730392e+07 -2.41237169e+08  8.42e-02 1.30e-10  3.71e+03     1s
  10   4.18597117e+07 -1.64105270e+08  5.81e-02 1.30e-10  2.60e+03     1s
  11   2.76145825e+07 -9.14390120e+07  2.66e-02 1.01e-10  1.49e+03     1s
  12   2.23033242e+07 -5.38015380e+07  1.78e-02 1.01e-10  9.48e+02     1s
  13   1.72661755e+07 -2.21299979e+07  1.09e-02 1.01e-10  4.90e+02     1s
  14   1.45719932e+07 -1.09552247e+07  7.45e-03 7.15e-11  3.17e+02     1s
  15   1.23752217e+07 -3.07909653e+06  4.93e-03 7.15e-11  1.92e+02     1s
  16   1.11050753e+07  1.24628160e+06  3.57e-03 5.70e-11  1.22e+02     1s
  17   9.68248001e+06  3.05542065e+06  2.17e-03 5.70e-11  8.20e+01     1s
  18   8.70231896e+06  4.48290900e+06  1.19e-03 2.91e-11  5.21e+01     1s
  19   8.19475270e+06  5.17372884e+06  7.21e-04 2.91e-11  3.73e+01     1s
  20   7.90752168e+06  5.91223111e+06  4.57e-04 2.91e-11  2.46e+01     1s
  21   7.72601577e+06  6.57200647e+06  2.96e-04 2.91e-11  1.42e+01     1s
  22   7.60262228e+06  6.84735177e+06  1.95e-04 2.91e-11  9.32e+00     1s
  23   7.50387561e+06  7.08249210e+06  1.18e-04 2.91e-11  5.20e+00     1s
  24   7.41363054e+06  7.23227308e+06  5.04e-05 1.46e-11  2.24e+00     1s
  25   7.38377054e+06  7.29226567e+06  3.02e-05 2.91e-11  1.13e+00     1s
  26   7.36127414e+06  7.31547744e+06  1.61e-05 2.91e-11  5.65e-01     1s
  27   7.34841982e+06  7.32380790e+06  8.07e-06 1.46e-11  3.04e-01     2s
  28   7.34027560e+06  7.33105091e+06  3.08e-06 2.91e-11  1.14e-01     2s
  29   7.33818864e+06  7.33261383e+06  1.89e-06 2.91e-11  6.88e-02     2s
  30   7.33572124e+06  7.33423104e+06  4.72e-07 2.91e-11  1.84e-02     2s
  31   7.33507336e+06  7.33462906e+06  1.20e-07 5.82e-11  5.48e-03     2s
  32   7.33486959e+06  7.33479616e+06  1.46e-08 5.82e-11  9.06e-04     2s
  33   7.33484610e+06  7.33482496e+06  2.07e-08 2.91e-11  2.61e-04     2s
  34   7.33483545e+06  7.33483393e+06  5.57e-08 8.73e-11  1.88e-05     2s
  35   7.33483498e+06  7.33483477e+06  5.56e-09 5.82e-11  2.63e-06     2s
  36   7.33483494e+06  7.33483492e+06  1.41e-09 5.82e-11  2.13e-07     2s
  37   7.33483493e+06  7.33483493e+06  3.19e-09 5.82e-11  1.24e-08     2s
  38   7.33483493e+06  7.33483493e+06  2.60e-09 8.73e-11  9.54e-10     2s

Barrier solved model in 38 iterations and 2.11 seconds
Optimal objective 7.33483493e+06

Crossover log...

    1419 DPushes remaining with DInf 0.0000000e+00                 2s
       0 DPushes remaining with DInf 0.0000000e+00                 2s

     189 PPushes remaining with PInf 1.9000000e-05                 2s
       0 PPushes remaining with PInf 1.9000000e-05                 2s

  Push phase complete: Pinf 1.9000000e-05, Dinf 4.5188228e-10      2s

Iteration    Objective       Primal Inf.    Dual Inf.      Time
    1611    7.3348349e+06   1.600000e-05   0.000000e+00      2s
Extra simplex iterations after uncrush: 22
    1642    7.3348349e+06   0.000000e+00   0.000000e+00      3s

Solved with barrier
Solved in 1642 iterations and 2.64 seconds
Optimal objective  7.334834926e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 7.33e+06
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.76s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-tv5nk8ag.lp
Reading time = 0.11 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0x9d42db85
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [2e+00, 1e+01]
  RHS range        [4e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57058 rows and 22029 columns
Presolve time: 0.05s
Presolved: 3926 rows, 4828 columns, 23592 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.832e+04
 Factor NZ  : 6.458e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.205e+06 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   3.55384717e+07 -1.16007883e+09  1.85e+04 5.68e-14  5.16e+05     0s
   1   1.64743345e+07 -5.57048919e+08  2.03e+03 1.42e-13  8.71e+04     0s
   2   1.35926675e+07 -8.57485467e+07  2.13e+02 1.14e-13  1.15e+04     0s
   3   1.25194032e+07  6.99255290e+05  1.85e+01 2.98e-13  1.27e+03     0s
   4   1.21907649e+07  9.58416392e+06  4.05e+00 5.23e-12  2.74e+02     0s
   5   1.20786333e+07  1.12789716e+07  1.50e+00 1.39e-12  8.34e+01     0s
   6   1.20199902e+07  1.17371966e+07  5.26e-01 4.30e-13  2.94e+01     0s
   7   1.19940312e+07  1.18806801e+07  1.47e-01 1.51e-13  1.18e+01     0s
   8   1.19858044e+07  1.19515297e+07  2.56e-02 5.02e-14  3.55e+00     0s
   9   1.19842735e+07  1.19758589e+07  5.70e-03 4.32e-14  8.72e-01     0s
  10   1.19837970e+07  1.19837025e+07  1.80e-10 3.74e-14  9.79e-03     0s
  11   1.19837912e+07  1.19837912e+07  8.37e-11 5.24e-14  1.58e-08     0s
  12   1.19837912e+07  1.19837912e+07  5.91e-12 3.68e-14  1.58e-11     0s

Barrier solved model in 12 iterations and 0.20 seconds
Optimal objective 1.19837912e+07

Crossover log...


Solved with primal simplex
Solved in 5455 iterations and 0.21 seconds
Optimal objective  1.198379124e+07
INFO:pypsa.linopf:Optimization successful. Objective value: 1.20e+07
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


load


add_BESS_load
300


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 2.82s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-jmod0xu0.lp
Reading time = 0.29 seconds
obj: 154248 rows, 73489 columns, 258595 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 154248 rows, 73489 columns and 258595 nonzeros
Model fingerprint: 0xc73150e9
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [2e+00, 1e+01]
  RHS range        [4e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 142341 rows and 33193 columns
Presolve time: 0.14s
Presolved: 11907 rows, 40296 columns, 82880 nonzeros

Ordering time: 0.20s

Barrier statistics:
 AA' NZ     : 4.938e+04
 Factor NZ  : 7.182e+05 (roughly 27 MBytes of memory)
 Factor Ops : 1.275e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.71887756e+12 -1.98654110e+12  5.80e+04 1.08e+04  9.25e+08     0s
   1   3.75891915e+11 -1.20249068e+12  6.22e+03 2.62e+02  1.09e+08     0s
   2   3.34693485e+10 -3.74072224e+11  4.52e+02 2.04e-10  1.08e+07     0s
   3   1.02911493e+10 -4.78201266e+10  5.88e+01 5.82e-10  1.35e+06     1s
   4   5.05695868e+09 -1.75180285e+10  1.68e+01 2.62e-10  4.22e+05     1s
   5   2.24932736e+09 -6.36608958e+09  7.67e+00 1.65e-10  1.52e+05     1s
   6   6.09893870e+08 -3.05394386e+09  2.26e+00 1.27e-10  5.51e+04     1s
   7   1.98263907e+08 -6.42960656e+08  6.54e-01 1.65e-10  1.18e+04     1s
   8   1.15288880e+08 -2.91178844e+08  3.43e-01 1.56e-10  5.51e+03     1s
   9   7.53784346e+07 -1.33239153e+08  1.99e-01 1.07e-10  2.78e+03     1s
  10   5.85027645e+07 -8.64510466e+07  1.42e-01 9.81e-11  1.92e+03     1s
  11   3.50561061e+07 -4.80523755e+07  7.31e-02 1.07e-10  1.08e+03     1s
  12   3.35198865e+07 -4.11584902e+07  6.81e-02 9.81e-11  9.71e+02     1s
  13   2.65139226e+07 -3.41623827e+07  4.59e-02 1.27e-10  7.81e+02     1s
  14   2.27171946e+07 -2.17149170e+07  3.41e-02 9.81e-11  5.69e+02     1s
  15   1.88319042e+07 -4.28603738e+06  2.28e-02 9.81e-11  2.95e+02     1s
  16   1.62929154e+07  3.59984653e+06  1.58e-02 6.90e-11  1.61e+02     1s
  17   1.51762406e+07  5.93420740e+06  1.27e-02 6.90e-11  1.17e+02     1s
  18   1.35758674e+07  7.39662620e+06  8.57e-03 5.44e-11  7.80e+01     1s
  19   1.32569341e+07  8.05153674e+06  7.72e-03 6.90e-11  6.56e+01     1s
  20   1.25315406e+07  8.93112432e+06  5.84e-03 5.44e-11  4.52e+01     1s
  21   1.18809270e+07  9.09727694e+06  4.24e-03 3.98e-11  3.49e+01     1s
  22   1.13920215e+07  9.54103164e+06  2.85e-03 3.98e-11  2.32e+01     1s
  23   1.13347697e+07  9.62854256e+06  2.70e-03 3.98e-11  2.13e+01     1s
  24   1.11582119e+07  9.71601351e+06  2.25e-03 3.26e-11  1.80e+01     2s
  25   1.08210969e+07  9.88943032e+06  1.42e-03 2.53e-11  1.16e+01     2s
  26   1.06014793e+07  1.01446253e+07  8.02e-04 1.46e-11  5.69e+00     2s
  27   1.04936231e+07  1.02301981e+07  5.15e-04 2.91e-11  3.27e+00     2s
  28   1.04370946e+07  1.02614765e+07  3.60e-04 1.46e-11  2.18e+00     2s
  29   1.03815279e+07  1.02745020e+07  2.10e-04 1.46e-11  1.33e+00     2s
  30   1.03617961e+07  1.02857034e+07  1.57e-04 1.46e-11  9.45e-01     2s
  31   1.03569392e+07  1.02885438e+07  1.44e-04 1.46e-11  8.49e-01     2s
  32   1.03380354e+07  1.02920943e+07  9.51e-05 1.46e-11  5.71e-01     2s
  33   1.03362149e+07  1.02937724e+07  9.08e-05 2.91e-11  5.27e-01     2s
  34   1.03188745e+07  1.02955780e+07  5.04e-05 1.46e-11  2.89e-01     2s
  35   1.03123087e+07  1.02983989e+07  3.24e-05 2.18e-11  1.73e-01     2s
  36   1.03057875e+07  1.02994645e+07  1.41e-05 1.46e-11  7.85e-02     2s
  37   1.03041131e+07  1.03001232e+07  9.41e-06 2.91e-11  4.95e-02     2s
  38   1.03030888e+07  1.03003113e+07  6.55e-06 2.91e-11  3.45e-02     2s
  39   1.03013380e+07  1.03005412e+07  1.76e-06 2.91e-11  9.89e-03     2s
  40   1.03008714e+07  1.03006238e+07  4.78e-07 2.91e-11  3.07e-03     2s
  41   1.03007397e+07  1.03006672e+07  1.35e-07 8.73e-11  9.00e-04     2s
  42   1.03006966e+07  1.03006805e+07  2.70e-08 5.82e-11  1.99e-04     2s
  43   1.03006854e+07  1.03006847e+07  1.15e-08 8.73e-11  8.17e-06     2s
  44   1.03006851e+07  1.03006851e+07  3.50e-09 5.82e-11  4.91e-07     2s
  45   1.03006851e+07  1.03006851e+07  2.29e-09 5.82e-11  1.18e-07     2s
  46   1.03006851e+07  1.03006851e+07  1.30e-08 2.91e-11  3.44e-08     2s
  47   1.03006851e+07  1.03006851e+07  1.13e-08 5.82e-11  6.16e-09     2s

Barrier solved model in 47 iterations and 2.21 seconds
Optimal objective 1.03006851e+07

Crossover log...

    1104 DPushes remaining with DInf 0.0000000e+00                 2s
       0 DPushes remaining with DInf 0.0000000e+00                 2s

     202 PPushes remaining with PInf 2.0000000e-05                 2s
       0 PPushes remaining with PInf 2.4000000e-05                 3s

  Push phase complete: Pinf 2.4000000e-05, Dinf 5.7621814e-10      3s

Iteration    Objective       Primal Inf.    Dual Inf.      Time
    1309    1.0300685e+07   1.900000e-05   0.000000e+00      3s
Extra simplex iterations after uncrush: 63
    1384    1.0300685e+07   0.000000e+00   0.000000e+00      3s

Solved with barrier
Solved in 1384 iterations and 2.64 seconds
Optimal objective  1.030068510e+07
INFO:pypsa.linopf:Optimization successful. Objective value: 1.03e+07
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.79s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-3tzqdfkm.lp
Reading time = 0.12 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0x09304dfc
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [2e+00, 1e+01]
  RHS range        [4e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57048 rows and 22031 columns
Presolve time: 0.05s
Presolved: 3936 rows, 4826 columns, 23600 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.833e+04
 Factor NZ  : 6.453e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.199e+06 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   4.43023029e+07 -1.95821940e+09  2.09e+04 1.14e-13  8.73e+05     0s
   1   2.42358244e+07 -9.43818505e+08  2.60e+03 2.84e-13  1.54e+05     0s
   2   2.05831712e+07 -1.25376220e+08  2.45e+02 2.27e-12  1.72e+04     0s
   3   1.94854609e+07  8.74411390e+06  2.62e+01 7.50e-12  1.20e+03     0s
   4   1.90822428e+07  1.69964591e+07  5.53e+00 4.55e-13  2.23e+02     0s
   5   1.89508508e+07  1.82004634e+07  1.77e+00 3.41e-13  7.88e+01     0s
   6   1.88872423e+07  1.86393496e+07  5.69e-01 9.95e-14  2.59e+01     0s
   7   1.88670441e+07  1.87655726e+07  1.94e-01 7.11e-14  1.06e+01     0s
   8   1.88580045e+07  1.88418619e+07  2.09e-02 5.68e-14  1.68e+00     0s
   9   1.88569517e+07  1.88560216e+07  6.08e-03 7.98e-14  9.74e-02     0s
  10   1.88565184e+07  1.88564928e+07  6.25e-05 7.09e-14  2.67e-03     0s

Barrier performed 10 iterations in 0.20 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with primal simplex
Solved in 4854 iterations and 0.20 seconds
Optimal objective  1.885651231e+07
INFO:pypsa.linopf:Optimization successful. Objective value: 1.89e+07
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


load


add_BESS_load
300


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 2.79s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-l0rj9cvv.lp
Reading time = 0.28 seconds
obj: 154248 rows, 73489 columns, 258595 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 154248 rows, 73489 columns and 258595 nonzeros
Model fingerprint: 0xe2a898ec
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [2e+00, 1e+01]
  RHS range        [1e-06, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 142321 rows and 32942 columns
Presolve time: 0.11s
Presolved: 11927 rows, 40547 columns, 83151 nonzeros

Ordering time: 0.32s

Barrier statistics:
 AA' NZ     : 4.940e+04
 Factor NZ  : 7.190e+05 (roughly 27 MBytes of memory)
 Factor Ops : 1.252e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.24664473e+12 -1.98371123e+12  3.76e+04 1.13e+04  6.66e+08     1s
   1   2.90387947e+11 -1.13465496e+12  4.44e+03 5.33e+03  8.74e+07     1s
   2   2.81508429e+10 -2.83604665e+11  3.35e+02 2.91e-10  8.46e+06     1s
   3   8.96143680e+09 -3.88573366e+10  3.31e+01 9.55e-09  9.73e+05     1s
   4   3.98107708e+09 -1.29665739e+10  8.29e+00 2.91e-09  2.81e+05     1s
   5   1.16920260e+09 -5.43125109e+09  2.92e+00 9.46e-10  9.90e+04     1s
   6   2.48646411e+08 -2.27244642e+09  6.02e-01 3.31e-10  3.33e+04     1s
   7   1.42370784e+08 -9.45402423e+08  3.15e-01 1.33e-10  1.41e+04     1s
   8   5.11880005e+07 -4.46042579e+08  6.53e-02 1.01e-10  6.23e+03     1s
   9   3.89369183e+07 -1.57585162e+08  4.10e-02 1.30e-10  2.46e+03     1s
  10   3.46909943e+07 -1.15800767e+08  3.40e-02 1.01e-10  1.88e+03     1s
  11   2.19136051e+07 -6.92793382e+07  1.44e-02 1.01e-10  1.13e+03     1s
  12   1.80931907e+07 -3.83193760e+07  1.00e-02 1.01e-10  7.00e+02     1s
  13   1.38742578e+07 -1.90290573e+07  5.54e-03 7.15e-11  4.07e+02     1s
  14   1.25606823e+07 -9.75463592e+06  4.35e-03 7.15e-11  2.76e+02     1s
  15   1.08038342e+07 -2.45518704e+06  2.87e-03 5.70e-11  1.64e+02     1s
  16   1.02931325e+07  5.88721239e+05  2.47e-03 4.24e-11  1.20e+02     1s
  17   9.58961554e+06  3.13478270e+06  1.93e-03 2.79e-11  7.98e+01     1s
  18   8.55502783e+06  4.54245521e+06  1.19e-03 2.06e-11  4.95e+01     1s
  19   8.17266501e+06  5.11869742e+06  9.21e-04 2.18e-11  3.77e+01     1s
  20   7.75040432e+06  5.61153750e+06  6.12e-04 2.91e-11  2.64e+01     1s
  21   7.47352326e+06  6.18774600e+06  4.12e-04 2.91e-11  1.59e+01     1s
  22   7.36238047e+06  6.45807538e+06  3.33e-04 2.18e-11  1.12e+01     1s
  23   7.30995972e+06  6.53298644e+06  2.97e-04 2.91e-11  9.59e+00     1s
  24   7.19766983e+06  6.65349608e+06  2.19e-04 2.91e-11  6.71e+00     1s
  25   7.10243716e+06  6.70710637e+06  1.55e-04 2.91e-11  4.88e+00     1s
  26   7.03496675e+06  6.75194259e+06  1.12e-04 1.46e-11  3.49e+00     1s
  27   6.99466713e+06  6.76064981e+06  8.51e-05 1.46e-11  2.89e+00     1s
  28   6.98252367e+06  6.79606841e+06  7.77e-05 1.46e-11  2.30e+00     1s
  29   6.90352930e+06  6.82226080e+06  2.51e-05 1.46e-11  1.00e+00     1s
  30   6.90018702e+06  6.82760098e+06  2.29e-05 1.46e-11  8.95e-01     1s
  31   6.89060437e+06  6.84541692e+06  1.69e-05 1.46e-11  5.57e-01     1s
  32   6.88941424e+06  6.84920148e+06  1.61e-05 1.46e-11  4.96e-01     1s
  33   6.88550418e+06  6.85266954e+06  1.37e-05 1.46e-11  4.05e-01     1s
  34   6.87828436e+06  6.85467372e+06  9.26e-06 1.46e-11  2.91e-01     1s
  35   6.87467043e+06  6.85492641e+06  7.07e-06 1.46e-11  2.44e-01     1s
  36   6.87436522e+06  6.85616797e+06  6.91e-06 1.46e-11  2.24e-01     1s
  37   6.87286979e+06  6.85860445e+06  6.00e-06 2.91e-11  1.76e-01     1s
  38   6.86953687e+06  6.85900592e+06  4.07e-06 1.46e-11  1.30e-01     2s
  39   6.86730204e+06  6.86058281e+06  2.75e-06 1.46e-11  8.29e-02     2s
  40   6.86563855e+06  6.86118930e+06  1.72e-06 1.46e-11  5.49e-02     2s
  41   6.86481940e+06  6.86134618e+06  1.22e-06 1.46e-11  4.28e-02     2s
  42   6.86476715e+06  6.86163921e+06  1.19e-06 1.46e-11  3.86e-02     2s
  43   6.86437704e+06  6.86232854e+06  9.50e-07 1.46e-11  2.53e-02     2s
  44   6.86390857e+06  6.86263485e+06  6.56e-07 1.46e-11  1.57e-02     2s
  45   6.86337020e+06  6.86276733e+06  3.14e-07 2.18e-11  7.44e-03     2s
  46   6.86302457e+06  6.86281868e+06  9.94e-08 2.91e-11  2.54e-03     2s
  47   6.86291174e+06  6.86285041e+06  3.09e-08 1.46e-11  7.56e-04     2s
  48   6.86288181e+06  6.86286029e+06  1.39e-08 2.91e-11  2.65e-04     2s
  49   6.86286842e+06  6.86286407e+06  4.26e-09 5.82e-11  5.37e-05     2s
  50   6.86286594e+06  6.86286548e+06  2.76e-10 5.82e-11  5.62e-06     2s
  51   6.86286578e+06  6.86286573e+06  2.41e-09 5.82e-11  6.81e-07     2s
  52   6.86286576e+06  6.86286575e+06  1.10e-09 5.82e-11  1.07e-07     2s
  53   6.86286576e+06  6.86286575e+06  9.09e-08 5.82e-11  2.95e-08     2s
  54   6.86286575e+06  6.86286575e+06  4.87e-08 5.82e-11  6.54e-09     2s

Barrier solved model in 54 iterations and 1.95 seconds
Optimal objective 6.86286575e+06

Crossover log...

     621 DPushes remaining with DInf 0.0000000e+00                 2s
       0 DPushes remaining with DInf 0.0000000e+00                 2s

     475 PPushes remaining with PInf 2.0000000e-06                 2s
       0 PPushes remaining with PInf 5.0000000e-06                 2s

  Push phase complete: Pinf 5.0000000e-06, Dinf 5.3929659e-10      2s

Iteration    Objective       Primal Inf.    Dual Inf.      Time
    1099    6.8628658e+06   4.000000e-06   0.000000e+00      2s
Extra simplex iterations after uncrush: 10
    1112    6.8628658e+06   0.000000e+00   0.000000e+00      3s

Solved with barrier
Solved in 1112 iterations and 2.58 seconds
Optimal objective  6.862865754e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 6.86e+06
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.77s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-iiwi70l7.lp
Reading time = 0.11 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0x24797525
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [2e+00, 1e+01]
  RHS range        [4e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57050 rows and 22028 columns
Presolve time: 0.05s
Presolved: 3934 rows, 4829 columns, 23601 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.832e+04
 Factor NZ  : 6.454e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.200e+06 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   3.50090062e+07 -9.81980581e+08  1.79e+04 5.68e-14  4.27e+05     0s
   1   1.79646515e+07 -4.60282314e+08  2.03e+03 1.71e-13  7.29e+04     0s
   2   1.52348140e+07 -5.86040236e+07  1.95e+02 5.09e-12  8.56e+03     0s
   3   1.43589082e+07  4.85310717e+06  2.65e+01 1.14e-12  1.04e+03     0s
   4   1.40256862e+07  9.33618293e+06  3.33e+00 5.97e-13  4.90e+02     0s
   5   1.39068493e+07  1.18146007e+07  7.80e-01 2.70e-13  2.17e+02     0s
   6   1.38680021e+07  1.30232355e+07  3.99e-01 1.15e-13  8.76e+01     0s
   7   1.38435747e+07  1.33432480e+07  2.18e-01 5.20e-14  5.19e+01     0s
   8   1.38202368e+07  1.36452046e+07  4.95e-02 4.51e-14  1.81e+01     0s

Barrier performed 8 iterations in 0.20 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with primal simplex
Solved in 5089 iterations and 0.20 seconds
Optimal objective  1.381187312e+07
INFO:pypsa.linopf:Optimization successful. Objective value: 1.38e+07
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


load


add_BESS_load
300


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 2.84s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-8h373j_t.lp
Reading time = 0.29 seconds
obj: 154248 rows, 73489 columns, 258595 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 154248 rows, 73489 columns and 258595 nonzeros
Model fingerprint: 0x05e65f15
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [2e+00, 1e+01]
  RHS range        [4e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 142324 rows and 32992 columns
Presolve time: 0.11s
Presolved: 11924 rows, 40497 columns, 83098 nonzeros

Ordering time: 0.23s

Barrier statistics:
 AA' NZ     : 4.939e+04
 Factor NZ  : 7.293e+05 (roughly 27 MBytes of memory)
 Factor Ops : 1.345e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.24797025e+12 -2.01438698e+12  3.74e+04 1.37e+04  6.63e+08     0s
   1   2.90889873e+11 -1.13029033e+12  4.41e+03 5.36e+03  8.69e+07     0s
   2   3.24190823e+10 -2.80320013e+11  4.03e+02 1.88e-10  9.44e+06     1s
   3   8.84715695e+09 -4.21575548e+10  4.43e+01 2.62e-10  1.16e+06     1s
   4   4.51464320e+09 -1.49019749e+10  1.55e+01 2.04e-10  3.82e+05     1s
   5   1.60771212e+09 -5.30964130e+09  5.51e+00 1.63e-10  1.20e+05     1s
   6   1.22831071e+08 -1.49338045e+09  4.35e-01 1.65e-10  2.15e+04     1s
   7   2.99543788e+07 -5.60292451e+08  2.01e-02 1.30e-10  7.32e+03     1s
   8   2.38407598e+07 -2.51990569e+08  1.09e-02 1.30e-10  3.42e+03     1s
   9   1.59556206e+07 -8.21367799e+07  4.88e-03 1.30e-10  1.21e+03     1s
  10   9.45726550e+06 -4.37321924e+07  1.71e-03 1.30e-10  6.57e+02     1s
  11   6.33326106e+06 -2.27197909e+07  6.36e-04 7.15e-11  3.59e+02     1s
  12   5.15676244e+06 -1.55505713e+07  3.57e-04 7.15e-11  2.56e+02     1s
  13   4.33243127e+06 -3.54669247e+06  2.11e-04 5.70e-11  9.73e+01     1s
  14   3.99044977e+06 -5.73778193e+05  1.51e-04 3.51e-11  5.64e+01     1s
  15   3.69792026e+06  9.03083451e+05  1.01e-04 2.42e-11  3.45e+01     1s
  16   3.46046770e+06  1.47843730e+06  6.39e-05 1.46e-11  2.45e+01     1s
  17   3.35837081e+06  2.20246102e+06  4.86e-05 2.91e-11  1.43e+01     1s
  18   3.21891475e+06  2.45290011e+06  2.86e-05 1.46e-11  9.46e+00     1s
  19   3.17713427e+06  2.70803878e+06  2.28e-05 2.91e-11  5.79e+00     1s
  20   3.10310930e+06  2.81822110e+06  1.30e-05 1.46e-11  3.52e+00     1s
  21   3.09500811e+06  2.83490961e+06  1.20e-05 1.46e-11  3.21e+00     1s
  22   3.07067940e+06  2.86857117e+06  8.92e-06 1.46e-11  2.50e+00     1s
  23   3.03259074e+06  2.91518813e+06  4.15e-06 1.46e-11  1.45e+00     1s
  24   3.00972260e+06  2.93413643e+06  1.53e-06 1.46e-11  9.33e-01     1s
  25   3.00678076e+06  2.96265251e+06  1.21e-06 1.46e-11  5.45e-01     1s
  26   3.00362478e+06  2.97638597e+06  8.88e-07 1.46e-11  3.36e-01     1s
  27   3.00089961e+06  2.98342370e+06  6.28e-07 1.46e-11  2.16e-01     1s
  28   3.00007872e+06  2.98618090e+06  5.52e-07 1.46e-11  1.72e-01     1s
  29   2.99643007e+06  2.98807380e+06  2.23e-07 1.46e-11  1.03e-01     1s
  30   2.99587067e+06  2.99172275e+06  1.74e-07 1.46e-11  5.12e-02     1s
  31   2.99428261e+06  2.99294184e+06  4.19e-08 2.91e-11  1.66e-02     1s
  32   2.99386152e+06  2.99351163e+06  1.54e-08 1.46e-11  4.32e-03     1s
  33   2.99378747e+06  2.99359372e+06  3.63e-08 2.91e-11  2.39e-03     1s
  34   2.99372940e+06  2.99367529e+06  7.81e-09 1.46e-11  6.68e-04     1s
  35   2.99372002e+06  2.99370086e+06  1.36e-08 2.91e-11  2.36e-04     1s
  36   2.99371493e+06  2.99371104e+06  2.22e-08 2.91e-11  4.80e-05     1s
  37   2.99371395e+06  2.99371362e+06  1.59e-08 5.82e-11  4.16e-06     1s
  38   2.99371389e+06  2.99371388e+06  5.88e-10 5.82e-11  1.31e-07     1s
  39   2.99371388e+06  2.99371388e+06  1.08e-09 2.91e-11  2.43e-08     1s
  40   2.99371388e+06  2.99371388e+06  6.02e-10 5.82e-11  4.24e-09     1s

Barrier solved model in 40 iterations and 1.39 seconds
Optimal objective 2.99371388e+06

Crossover log...

     757 DPushes remaining with DInf 0.0000000e+00                 1s
       0 DPushes remaining with DInf 0.0000000e+00                 2s

    1276 PPushes remaining with PInf 4.0000000e-06                 2s
       0 PPushes remaining with PInf 4.0000000e-06                 2s

  Push phase complete: Pinf 4.0000000e-06, Dinf 3.8061032e-10      2s

Iteration    Objective       Primal Inf.    Dual Inf.      Time
    2036    2.9937139e+06   2.000000e-06   0.000000e+00      2s
Extra simplex iterations after uncrush: 28
    2065    2.9937139e+06   0.000000e+00   0.000000e+00      2s

Solved with barrier
Solved in 2065 iterations and 2.18 seconds
Optimal objective  2.993713884e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 2.99e+06
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.79s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-8k674ppd.lp
Reading time = 0.11 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0xbb217a00
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [2e+00, 2e+01]
  RHS range        [4e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57055 rows and 22004 columns
Presolve time: 0.05s
Presolved: 3929 rows, 4853 columns, 23620 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.832e+04
 Factor NZ  : 6.467e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.208e+06 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   3.76877656e+07 -1.07459663e+09  1.91e+04 5.68e-14  4.86e+05     0s
   1   1.35094151e+07 -5.26651256e+08  2.22e+03 1.99e-13  8.39e+04     0s
   2   9.66079528e+06 -7.80412807e+07  2.19e+02 1.42e-13  1.02e+04     0s
   3   8.60993240e+06  2.18461754e+06  1.72e+01 1.71e-13  6.95e+02     0s
   4   8.32659831e+06  6.35961188e+06  3.38e+00 1.42e-13  2.05e+02     0s
   5   8.24599929e+06  7.22958857e+06  1.42e+00 8.53e-14  1.05e+02     0s
   6   8.18295732e+06  7.89624458e+06  3.01e-01 5.68e-14  2.96e+01     0s
   7   8.16544055e+06  8.04258230e+06  6.64e-02 3.73e-14  1.27e+01     0s
   8   8.15978609e+06  8.11385163e+06  1.63e-02 2.84e-14  4.73e+00     0s
   9   8.15692072e+06  8.13444694e+06  4.72e-03 2.85e-14  2.32e+00     0s
  10   8.15544158e+06  8.14874557e+06  9.25e-04 4.26e-14  6.90e-01     0s
  11   8.15495066e+06  8.15271472e+06  2.08e-04 2.84e-14  2.30e-01     0s

Barrier performed 11 iterations in 0.20 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with primal simplex
Solved in 5091 iterations and 0.20 seconds
Optimal objective  8.154757278e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 8.15e+06
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


load


add_BESS_load
300


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 2.76s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-vhrkb8wc.lp
Reading time = 0.29 seconds
obj: 154248 rows, 73489 columns, 258595 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 154248 rows, 73489 columns and 258595 nonzeros
Model fingerprint: 0x1262926b
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [2e+00, 2e+01]
  RHS range        [4e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 142350 rows and 34078 columns
Presolve time: 0.13s
Presolved: 11898 rows, 39411 columns, 81986 nonzeros

Ordering time: 0.29s

Barrier statistics:
 AA' NZ     : 4.937e+04
 Factor NZ  : 7.175e+05 (roughly 27 MBytes of memory)
 Factor Ops : 1.260e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.24742701e+12 -2.01596202e+12  3.75e+04 1.37e+04  6.64e+08     1s
   1   2.79631218e+11 -1.13589603e+12  4.40e+03 5.99e+03  8.69e+07     1s
   2   3.18381221e+10 -2.83764809e+11  4.19e+02 1.80e-10  9.75e+06     1s
   3   8.50314936e+09 -4.11784339e+10  5.18e+01 4.66e-10  1.23e+06     1s
   4   5.44165263e+09 -1.59786399e+10  2.11e+01 2.33e-10  4.63e+05     1s
   5   2.96156549e+09 -7.59920481e+09  1.18e+01 4.07e-10  2.19e+05     1s
   6   2.77600062e+08 -1.87568101e+09  1.36e+00 1.75e-10  3.33e+04     1s
   7   5.91558309e+07 -7.12841072e+08  1.82e-01 1.16e-10  1.02e+04     1s
   8   3.97859812e+07 -2.01860344e+08  9.91e-02 1.07e-10  3.18e+03     1s
   9   1.98733087e+07 -1.08390997e+08  3.37e-02 9.46e-11  1.66e+03     1s
  10   1.41448942e+07 -4.53596952e+07  1.95e-02 7.79e-11  7.65e+02     1s
  11   9.46018528e+06 -1.34665496e+07  1.03e-02 8.84e-11  2.94e+02     1s
  12   7.63948995e+06 -6.64592153e+06  7.20e-03 5.93e-11  1.83e+02     1s
  13   5.84034371e+06 -2.88818561e+06  4.33e-03 6.55e-11  1.11e+02     1s
  14   5.14851885e+06 -1.06157359e+06  3.27e-03 3.64e-11  7.92e+01     1s
  15   4.99212073e+06 -3.90147638e+05  3.03e-03 3.43e-11  6.86e+01     1s
  16   4.53266891e+06  5.67989080e+05  2.35e-03 2.91e-11  5.05e+01     1s
  17   3.87756642e+06  1.49354286e+06  1.41e-03 2.70e-11  3.03e+01     1s
  18   3.56770393e+06  2.00938764e+06  1.01e-03 1.97e-11  1.98e+01     1s
  19   3.45699876e+06  2.31576022e+06  8.53e-04 1.46e-11  1.45e+01     1s
  20   3.17721165e+06  2.45746532e+06  4.56e-04 1.46e-11  9.14e+00     1s
  21   3.08805106e+06  2.68254179e+06  3.33e-04 1.46e-11  5.15e+00     1s
  22   2.94552618e+06  2.77375172e+06  1.42e-04 2.18e-11  2.18e+00     1s
  23   2.88607445e+06  2.80375900e+06  6.49e-05 2.91e-11  1.04e+00     1s
  24   2.86031806e+06  2.81970724e+06  3.27e-05 1.46e-11  5.15e-01     1s
  25   2.84931525e+06  2.82610013e+06  1.92e-05 1.46e-11  2.95e-01     1s
  26   2.84334885e+06  2.83062618e+06  1.23e-05 2.91e-11  1.61e-01     1s
  27   2.83675060e+06  2.83181466e+06  4.59e-06 2.91e-11  6.26e-02     1s
  28   2.83485899e+06  2.83220535e+06  2.56e-06 1.46e-11  3.37e-02     1s
  29   2.83403968e+06  2.83238956e+06  1.56e-06 1.46e-11  2.09e-02     1s
  30   2.83370759e+06  2.83253962e+06  1.16e-06 2.91e-11  1.48e-02     1s
  31   2.83344583e+06  2.83262995e+06  8.49e-07 1.46e-11  1.04e-02     1s
  32   2.83303936e+06  2.83268185e+06  3.87e-07 5.82e-11  4.54e-03     1s
  33   2.83297224e+06  2.83269623e+06  3.02e-07 2.91e-11  3.50e-03     1s
  34   2.83275042e+06  2.83271605e+06  8.83e-08 2.91e-11  4.36e-04     1s
  35   2.83272835e+06  2.83272318e+06  1.36e-07 5.82e-11  6.56e-05     2s
  36   2.83272602e+06  2.83272543e+06  8.74e-08 2.91e-11  7.50e-06     2s
  37   2.83272593e+06  2.83272585e+06  1.57e-08 2.91e-11  1.01e-06     2s
  38   2.83272592e+06  2.83272590e+06  5.63e-09 2.91e-11  2.42e-07     2s
  39   2.83272592e+06  2.83272591e+06  2.94e-09 5.82e-11  5.83e-08     2s
  40   2.83272591e+06  2.83272591e+06  4.30e-09 5.82e-11  1.06e-08     2s
  41   2.83272591e+06  2.83272591e+06  3.53e-10 5.82e-11  1.29e-10     2s

Barrier solved model in 41 iterations and 1.80 seconds
Optimal objective 2.83272591e+06

Crossover log...

     976 DPushes remaining with DInf 0.0000000e+00                 2s
       0 DPushes remaining with DInf 0.0000000e+00                 2s

    1082 PPushes remaining with PInf 3.0000000e-06                 2s
       0 PPushes remaining with PInf 3.0000000e-06                 2s

  Push phase complete: Pinf 3.0000000e-06, Dinf 2.0058124e-10      2s

Iteration    Objective       Primal Inf.    Dual Inf.      Time
    2061    2.8327259e+06   2.000000e-06   0.000000e+00      2s
Extra simplex iterations after uncrush: 6
    2069    2.8327259e+06   0.000000e+00   0.000000e+00      3s

Solved with barrier
Solved in 2069 iterations and 2.53 seconds
Optimal objective  2.832725914e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 2.83e+06
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.78s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-f0mmv8au.lp
Reading time = 0.11 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0xa8410cc5
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [3e+00, 4e+01]
  RHS range        [7e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57048 rows and 22028 columns
Presolve time: 0.05s
Presolved: 3936 rows, 4829 columns, 23603 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.833e+04
 Factor NZ  : 6.453e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.199e+06 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   3.29756415e+07 -1.04418694e+09  2.06e+04 5.68e-14  4.63e+05     0s
   1   1.70417217e+07 -4.97861280e+08  2.37e+03 1.71e-13  7.93e+04     0s
   2   1.47196789e+07 -6.51299951e+07  2.23e+02 1.14e-13  9.27e+03     0s
   3   1.38654167e+07  4.25163719e+06  2.15e+01 5.76e-13  1.04e+03     0s
   4   1.35762697e+07  1.11490974e+07  3.69e+00 1.99e-13  2.54e+02     0s
   5   1.34772028e+07  1.26645475e+07  1.13e+00 1.42e-13  8.46e+01     0s
   6   1.34294991e+07  1.31422737e+07  2.56e-01 4.44e-14  2.98e+01     0s
   7   1.34187227e+07  1.33336625e+07  8.73e-02 4.35e-14  8.82e+00     0s
   8   1.34128240e+07  1.34025847e+07  5.81e-03 5.99e-14  1.06e+00     0s
   9   1.34123146e+07  1.34119292e+07  1.51e-03 4.09e-14  4.02e-02     0s
  10   1.34121347e+07  1.34121341e+07  8.62e-07 4.70e-14  6.42e-05     0s

Barrier performed 10 iterations in 0.20 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with primal simplex
Solved in 5005 iterations and 0.21 seconds
Optimal objective  1.341213442e+07
INFO:pypsa.linopf:Optimization successful. Objective value: 1.34e+07
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


load


add_BESS_load
300


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 2.75s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-y8lk93vo.lp
Reading time = 0.28 seconds
obj: 154248 rows, 73489 columns, 258595 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 154248 rows, 73489 columns and 258595 nonzeros
Model fingerprint: 0x09e9acd3
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [3e+00, 4e+01]
  RHS range        [7e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 142323 rows and 32969 columns
Presolve time: 0.11s
Presolved: 11925 rows, 40520 columns, 83122 nonzeros

Ordering time: 0.29s

Barrier statistics:
 AA' NZ     : 4.939e+04
 Factor NZ  : 7.175e+05 (roughly 27 MBytes of memory)
 Factor Ops : 1.287e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.24625417e+12 -2.01846255e+12  3.74e+04 9.33e+03  6.64e+08     1s
   1   2.90436549e+11 -1.13227732e+12  4.43e+03 5.75e+03  8.71e+07     1s
   2   3.30181983e+10 -2.86140767e+11  4.04e+02 1.93e-10  9.50e+06     1s
   3   9.98455639e+09 -4.28381938e+10  5.23e+01 2.91e-10  1.27e+06     1s
   4   4.94173673e+09 -1.68143406e+10  1.67e+01 2.33e-10  4.21e+05     1s
   5   2.88749194e+09 -6.34844670e+09  9.50e+00 1.75e-10  1.76e+05     1s
   6   5.27438652e+08 -3.16255557e+09  1.99e+00 2.91e-10  5.51e+04     1s
   7   4.49806299e+07 -8.50571733e+08  4.80e-02 1.59e-10  1.12e+04     1s
   8   4.07986093e+07 -4.76027247e+08  3.83e-02 1.09e-10  6.44e+03     1s
   9   3.06772225e+07 -2.26293813e+08  1.92e-02 1.01e-10  3.19e+03     1s
  10   2.66439572e+07 -1.25542024e+08  1.51e-02 7.79e-11  1.89e+03     1s
  11   2.18974615e+07 -8.20994051e+07  1.08e-02 7.15e-11  1.29e+03     1s
  12   1.99626123e+07 -5.46618425e+07  9.19e-03 7.15e-11  9.24e+02     1s
  13   1.67148282e+07 -2.40717450e+07  6.87e-03 5.70e-11  5.05e+02     1s
  14   1.27652144e+07 -1.10439254e+07  4.32e-03 4.24e-11  2.94e+02     1s
  15   1.11619570e+07 -5.98687196e+06  3.34e-03 4.24e-11  2.12e+02     1s
  16   1.02132353e+07 -2.10754522e+06  2.78e-03 2.91e-11  1.52e+02     1s
  17   9.26106058e+06  1.72294801e+05  2.23e-03 2.91e-11  1.12e+02     1s
  18   7.90094064e+06  1.35168429e+06  1.49e-03 2.91e-11  8.09e+01     1s
  19   7.44100091e+06  2.76361207e+06  1.23e-03 2.91e-11  5.78e+01     1s
  20   7.00338548e+06  3.37648932e+06  1.01e-03 1.46e-11  4.48e+01     1s
  21   6.64552831e+06  3.97673195e+06  8.23e-04 1.46e-11  3.29e+01     1s
  22   6.03647950e+06  4.57945246e+06  4.95e-04 2.91e-11  1.80e+01     1s
  23   5.85895513e+06  4.84028610e+06  4.00e-04 1.46e-11  1.26e+01     1s
  24   5.55841250e+06  4.91883828e+06  2.42e-04 2.91e-11  7.89e+00     1s
  25   5.41618140e+06  5.00819743e+06  1.68e-04 2.18e-11  5.04e+00     1s
  26   5.25729644e+06  5.04196191e+06  8.68e-05 2.91e-11  2.66e+00     1s
  27   5.19350552e+06  5.06247253e+06  5.42e-05 1.46e-11  1.62e+00     1s
  28   5.13781383e+06  5.07411544e+06  2.67e-05 1.46e-11  7.86e-01     1s
  29   5.10751349e+06  5.07740258e+06  1.17e-05 1.46e-11  3.72e-01     1s
  30   5.08815855e+06  5.08117622e+06  2.42e-06 2.91e-11  8.62e-02     1s
  31   5.08354063e+06  5.08233246e+06  3.28e-07 2.18e-11  1.49e-02     1s
  32   5.08313382e+06  5.08259115e+06  1.56e-07 2.91e-11  6.70e-03     1s
  33   5.08296944e+06  5.08267681e+06  8.77e-08 2.91e-11  3.61e-03     1s
  34   5.08285677e+06  5.08272331e+06  4.21e-08 5.82e-11  1.65e-03     1s
  35   5.08279539e+06  5.08273247e+06  1.68e-07 2.91e-11  7.77e-04     1s
  36   5.08276403e+06  5.08274427e+06  2.12e-07 5.82e-11  2.44e-04     1s
  37   5.08275458e+06  5.08275005e+06  4.40e-08 2.91e-11  5.59e-05     1s
  38   5.08275300e+06  5.08275143e+06  1.73e-08 5.82e-11  1.94e-05     1s
  39   5.08275201e+06  5.08275185e+06  1.31e-09 5.82e-11  2.05e-06     1s
  40   5.08275197e+06  5.08275193e+06  1.52e-09 2.91e-11  5.21e-07     1s
  41   5.08275195e+06  5.08275195e+06  2.05e-09 5.82e-11  5.25e-08     1s
  42   5.08275195e+06  5.08275195e+06  5.44e-10 5.82e-11  7.35e-09     1s

Barrier solved model in 42 iterations and 1.47 seconds
Optimal objective 5.08275195e+06

Crossover log...

    1702 DPushes remaining with DInf 0.0000000e+00                 2s
       0 DPushes remaining with DInf 0.0000000e+00                 2s

     717 PPushes remaining with PInf 3.0000000e-06                 2s
       0 PPushes remaining with PInf 3.3000000e-05                 2s

  Push phase complete: Pinf 3.3000000e-05, Dinf 3.0540668e-10      2s

Iteration    Objective       Primal Inf.    Dual Inf.      Time
    2422    5.0827519e+06   1.800000e-05   0.000000e+00      2s
Extra simplex iterations after uncrush: 28
    2460    5.0827519e+06   0.000000e+00   0.000000e+00      2s

Solved with barrier
Solved in 2460 iterations and 1.99 seconds
Optimal objective  5.082751949e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 5.08e+06
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.77s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-vgg4h9jb.lp
Reading time = 0.11 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0xd2fa5005
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [6e+00, 4e+01]
  RHS range        [1e-02, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57049 rows and 22032 columns
Presolve time: 0.05s
Presolved: 3935 rows, 4825 columns, 23598 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.832e+04
 Factor NZ  : 6.452e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.199e+06 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   3.96038663e+07 -2.08159827e+09  2.01e+04 5.68e-14  9.00e+05     0s
   1   2.18433105e+07 -9.81715366e+08  2.32e+03 3.41e-13  1.54e+05     0s
   2   1.89333482e+07 -1.19765878e+08  2.18e+02 2.84e-13  1.63e+04     0s
   3   1.79062474e+07  7.91298973e+06  1.76e+01 4.26e-13  1.09e+03     0s
   4   1.75313400e+07  1.52253706e+07  2.66e+00 1.14e-12  2.42e+02     0s
   5   1.74028663e+07  1.67181509e+07  8.13e-01 3.20e-13  7.13e+01     0s
   6   1.73382942e+07  1.70346206e+07  1.73e-01 1.35e-13  3.15e+01     0s
   7   1.73247270e+07  1.72227677e+07  3.96e-02 5.68e-14  1.06e+01     0s

Barrier performed 7 iterations in 0.20 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with primal simplex
Solved in 4845 iterations and 0.20 seconds
Optimal objective  1.731986282e+07
INFO:pypsa.linopf:Optimization successful. Objective value: 1.73e+07
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


load


add_BESS_load
300


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 2.83s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-mc6sc7kr.lp
Reading time = 0.29 seconds
obj: 154248 rows, 73489 columns, 258595 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 154248 rows, 73489 columns and 258595 nonzeros
Model fingerprint: 0x5fcca75d
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [6e+00, 4e+01]
  RHS range        [1e-02, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 142333 rows and 33287 columns
Presolve time: 0.11s
Presolved: 11915 rows, 40202 columns, 82794 nonzeros

Ordering time: 0.33s

Barrier statistics:
 AA' NZ     : 4.938e+04
 Factor NZ  : 7.411e+05 (roughly 27 MBytes of memory)
 Factor Ops : 1.364e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.72860358e+12 -2.00440547e+12  5.67e+04 9.79e+03  9.26e+08     1s
   1   3.76607516e+11 -1.20878042e+12  6.05e+03 3.65e+02  1.09e+08     1s
   2   3.38207108e+10 -3.74661856e+11  4.45e+02 2.33e-10  1.09e+07     1s
   3   1.01985040e+10 -4.53877449e+10  5.23e+01 2.33e-10  1.27e+06     1s
   4   4.75768461e+09 -1.69461720e+10  1.45e+01 1.59e-10  3.95e+05     1s
   5   2.18149624e+09 -5.49352089e+09  6.92e+00 1.85e-10  1.34e+05     1s
   6   4.31159948e+08 -2.45828244e+09  1.55e+00 1.88e-10  4.21e+04     1s
   7   4.54187934e+07 -5.82743880e+08  5.30e-02 1.59e-10  7.91e+03     1s
   8   3.87167400e+07 -2.76856834e+08  3.72e-02 1.07e-10  3.96e+03     1s
   9   2.71956249e+07 -1.24071153e+08  1.63e-02 7.15e-11  1.89e+03     1s
  10   2.39602856e+07 -7.06974678e+07  1.26e-02 7.15e-11  1.18e+03     1s
  11   1.91595450e+07 -4.45033419e+07  8.19e-03 7.15e-11  7.94e+02     1s
  12   1.71217956e+07 -2.85124527e+07  6.48e-03 7.15e-11  5.69e+02     1s
  13   1.56334843e+07 -1.68112160e+07  5.27e-03 5.70e-11  4.04e+02     1s
  14   1.39920567e+07 -8.03763969e+06  4.04e-03 2.79e-11  2.74e+02     1s
  15   1.20192769e+07 -2.63542337e+06  2.61e-03 2.79e-11  1.82e+02     1s
  16   1.07136622e+07  3.90587944e+05  1.73e-03 1.46e-11  1.28e+02     1s
  17   1.00981771e+07  3.02375693e+06  1.35e-03 2.91e-11  8.80e+01     1s
  18   9.83900100e+06  4.00191258e+06  1.19e-03 2.91e-11  7.26e+01     1s
  19   9.61904439e+06  4.54928273e+06  1.06e-03 2.91e-11  6.31e+01     1s
  20   9.08450060e+06  5.47191892e+06  7.40e-04 1.46e-11  4.49e+01     1s
  21   8.91014069e+06  6.14572682e+06  6.37e-04 2.18e-11  3.44e+01     1s
  22   8.50853241e+06  6.59084492e+06  4.04e-04 1.46e-11  2.39e+01     1s
  23   8.24545491e+06  6.93305051e+06  2.58e-04 2.91e-11  1.63e+01     1s
  24   8.09682069e+06  7.22122630e+06  1.78e-04 1.46e-11  1.09e+01     1s
  25   7.97624769e+06  7.38060413e+06  1.13e-04 1.46e-11  7.41e+00     1s
  26   7.92237292e+06  7.54497277e+06  8.47e-05 2.91e-11  4.69e+00     1s
  27   7.84708416e+06  7.65055794e+06  4.68e-05 2.91e-11  2.44e+00     1s
  28   7.80609637e+06  7.68618717e+06  2.71e-05 1.46e-11  1.49e+00     1s
  29   7.77794824e+06  7.70446131e+06  1.40e-05 1.46e-11  9.14e-01     1s
  30   7.76263444e+06  7.71616800e+06  7.18e-06 1.46e-11  5.78e-01     1s
  31   7.75505683e+06  7.73143006e+06  4.01e-06 1.46e-11  2.94e-01     1s
  32   7.75127170e+06  7.73893609e+06  2.50e-06 1.46e-11  1.53e-01     1s
  33   7.74803691e+06  7.74296864e+06  1.23e-06 2.91e-11  6.30e-02     1s
  34   7.74585533e+06  7.74383230e+06  4.29e-07 2.91e-11  2.52e-02     1s
  35   7.74492026e+06  7.74442236e+06  9.12e-08 2.91e-11  6.19e-03     1s
  36   7.74475221e+06  7.74456567e+06  3.54e-08 2.91e-11  2.32e-03     1s
  37   7.74466571e+06  7.74462104e+06  8.10e-08 5.82e-11  5.56e-04     1s
  38   7.74464847e+06  7.74463630e+06  3.13e-08 5.82e-11  1.51e-04     1s
  39   7.74464206e+06  7.74464085e+06  9.32e-08 5.82e-11  1.51e-05     1s
  40   7.74464173e+06  7.74464153e+06  1.61e-08 5.82e-11  2.44e-06     2s
  41   7.74464166e+06  7.74464164e+06  2.75e-09 8.73e-11  1.57e-07     2s
  42   7.74464165e+06  7.74464164e+06  1.67e-09 5.82e-11  2.33e-08     2s
  43   7.74464164e+06  7.74464164e+06  9.46e-09 5.82e-11  2.85e-09     2s

Barrier solved model in 43 iterations and 1.68 seconds
Optimal objective 7.74464164e+06

Crossover log...

     960 DPushes remaining with DInf 0.0000000e+00                 2s
       0 DPushes remaining with DInf 0.0000000e+00                 2s

     200 PPushes remaining with PInf 5.0000000e-06                 2s
       0 PPushes remaining with PInf 7.0000000e-06                 2s

  Push phase complete: Pinf 7.0000000e-06, Dinf 7.6871874e-10      2s

Iteration    Objective       Primal Inf.    Dual Inf.      Time
    1163    7.7446416e+06   6.000000e-06   0.000000e+00      2s
Extra simplex iterations after uncrush: 7
    1175    7.7446416e+06   0.000000e+00   0.000000e+00      2s

Solved with barrier
Solved in 1175 iterations and 2.17 seconds
Optimal objective  7.744641644e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 7.74e+06
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.75s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-wcejj82u.lp
Reading time = 0.11 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0xcd24313c
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [7e+00, 4e+01]
  RHS range        [1e-02, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57048 rows and 22034 columns
Presolve time: 0.06s
Presolved: 3936 rows, 4823 columns, 23597 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.833e+04
 Factor NZ  : 6.453e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.199e+06 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   4.99883603e+07 -1.90909181e+09  2.00e+04 5.68e-14  8.25e+05     0s
   1   2.80777628e+07 -8.94149812e+08  2.52e+03 2.84e-13  1.46e+05     0s

Barrier performed 1 iterations in 0.22 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with primal simplex
Solved in 4990 iterations and 0.22 seconds
Optimal objective  2.154630316e+07
INFO:pypsa.linopf:Optimization successful. Objective value: 2.15e+07
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


load


add_BESS_load
300


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 2.78s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-t5mf4tem.lp
Reading time = 0.29 seconds
obj: 154248 rows, 73489 columns, 258595 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 154248 rows, 73489 columns and 258595 nonzeros
Model fingerprint: 0x7f4d39a0
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [7e+00, 4e+01]
  RHS range        [1e-02, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 142320 rows and 32949 columns
Presolve time: 0.13s
Presolved: 11928 rows, 40540 columns, 83145 nonzeros

Ordering time: 0.29s

Barrier statistics:
 AA' NZ     : 4.940e+04
 Factor NZ  : 7.082e+05 (roughly 27 MBytes of memory)
 Factor Ops : 1.222e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.73311183e+12 -2.00277588e+12  5.68e+04 1.19e+04  9.29e+08     1s
   1   3.88691635e+11 -1.20809917e+12  6.33e+03 2.04e-10  1.13e+08     1s
   2   3.41629271e+10 -3.83620281e+11  4.56e+02 1.75e-10  1.12e+07     1s
   3   1.00389575e+10 -4.91452742e+10  5.15e+01 5.47e-09  1.30e+06     1s
   4   5.05831004e+09 -1.72296823e+10  1.69e+01 1.46e-09  4.22e+05     1s
   5   2.12736451e+09 -5.55669782e+09  7.46e+00 2.64e-10  1.39e+05     1s
   6   4.49127482e+08 -2.35419835e+09  1.76e+00 1.36e-10  4.16e+04     1s
   7   3.79597989e+07 -5.54301369e+08  3.59e-02 1.59e-10  7.37e+03     1s
   8   3.16251651e+07 -3.13014119e+08  2.37e-02 1.30e-10  4.28e+03     1s
   9   2.23708710e+07 -1.90915308e+08  1.14e-02 1.01e-10  2.64e+03     1s
  10   1.87179384e+07 -1.14629294e+08  8.42e-03 7.15e-11  1.65e+03     1s
  11   1.38726231e+07 -5.87343765e+07  4.78e-03 7.15e-11  8.97e+02     1s
  12   1.16915271e+07 -3.64588176e+07  3.44e-03 5.70e-11  5.95e+02     1s
  13   7.11175142e+06 -1.47261742e+07  8.88e-04 2.91e-11  2.69e+02     1s
  14   6.32071636e+06 -7.94307434e+06  6.44e-04 2.79e-11  1.76e+02     1s
  15   5.52292598e+06 -3.95565855e+06  4.32e-04 2.91e-11  1.17e+02     1s
  16   4.91470045e+06 -6.33285953e+05  2.78e-04 1.46e-11  6.84e+01     1s
  17   4.18275935e+06  1.63036847e+06  1.12e-04 2.91e-11  3.15e+01     1s
  18   3.80253044e+06  2.69128939e+06  3.45e-05 1.46e-11  1.37e+01     1s
  19   3.69969812e+06  3.24816620e+06  1.77e-05 1.46e-11  5.57e+00     1s
  20   3.62681797e+06  3.43293118e+06  7.42e-06 1.46e-11  2.39e+00     1s
  21   3.59294596e+06  3.50662518e+06  3.26e-06 1.46e-11  1.06e+00     1s
  22   3.57554956e+06  3.52656331e+06  1.33e-06 2.18e-11  6.04e-01     1s
  23   3.56824428e+06  3.54603000e+06  6.00e-07 1.46e-11  2.74e-01     1s
  24   3.56457603e+06  3.55427819e+06  2.64e-07 1.46e-11  1.27e-01     1s
  25   3.56286940e+06  3.55855984e+06  1.23e-07 2.91e-11  5.32e-02     1s
  26   3.56173048e+06  3.56023817e+06  3.53e-08 2.91e-11  1.84e-02     1s
  27   3.56142074e+06  3.56081808e+06  4.77e-08 5.82e-11  7.43e-03     1s
  28   3.56123509e+06  3.56108227e+06  1.38e-08 5.82e-11  1.88e-03     1s
  29   3.56121228e+06  3.56116262e+06  3.93e-08 5.82e-11  6.12e-04     1s
  30   3.56120159e+06  3.56119302e+06  5.66e-08 2.91e-11  1.06e-04     1s
  31   3.56120097e+06  3.56119865e+06  1.34e-08 5.82e-11  2.86e-05     1s
  32   3.56120072e+06  3.56120052e+06  7.94e-10 8.73e-11  2.47e-06     1s
  33   3.56120068e+06  3.56120066e+06  3.79e-10 5.82e-11  2.91e-07     1s
  34   3.56120068e+06  3.56120068e+06  5.74e-10 5.82e-11  1.81e-08     1s
  35   3.56120068e+06  3.56120068e+06  6.55e-10 5.82e-11  2.47e-09     1s

Barrier solved model in 35 iterations and 1.41 seconds
Optimal objective 3.56120068e+06

Crossover log...

    1104 DPushes remaining with DInf 0.0000000e+00                 1s
       0 DPushes remaining with DInf 0.0000000e+00                 2s

     320 PPushes remaining with PInf 1.3000000e-05                 2s
       0 PPushes remaining with PInf 1.3000000e-05                 2s

  Push phase complete: Pinf 1.3000000e-05, Dinf 2.9049291e-10      2s

Iteration    Objective       Primal Inf.    Dual Inf.      Time
    1427    3.5612007e+06   5.000000e-06   0.000000e+00      2s
Extra simplex iterations after uncrush: 28
    1459    3.5612007e+06   0.000000e+00   0.000000e+00      2s

Solved with barrier
Solved in 1459 iterations and 1.65 seconds
Optimal objective  3.561200676e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 3.56e+06
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.77s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-os5_efye.lp
Reading time = 0.11 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0xc9fb54c1
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [7e+00, 4e+01]
  RHS range        [1e-02, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57050 rows and 22027 columns
Presolve time: 0.05s
Presolved: 3934 rows, 4830 columns, 23602 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.832e+04
 Factor NZ  : 6.450e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.199e+06 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   4.95839114e+07 -1.88283846e+09  2.13e+04 1.14e-13  8.53e+05     0s
   1   2.50389493e+07 -9.16691994e+08  2.42e+03 2.84e-13  1.46e+05     0s
   2   2.06367759e+07 -1.28978423e+08  2.41e+02 2.27e-13  1.75e+04     0s
   3   1.93989196e+07  7.20808964e+06  2.36e+01 9.55e-12  1.34e+03     0s
   4   1.90079829e+07  1.46255363e+07  4.05e+00 4.29e-12  4.59e+02     0s
   5   1.88225166e+07  1.73548630e+07  1.15e+00 1.45e-12  1.53e+02     0s
   6   1.87577237e+07  1.79627427e+07  4.27e-01 7.89e-13  8.25e+01     0s
   7   1.87309957e+07  1.84164302e+07  1.92e-01 2.63e-13  3.26e+01     0s
   8   1.87127746e+07  1.86333677e+07  2.47e-02 6.75e-14  8.22e+00     0s
   9   1.87098493e+07  1.86963587e+07  7.10e-03 5.68e-14  1.40e+00     0s
  10   1.87086577e+07  1.87085142e+07  6.60e-05 5.68e-14  1.49e-02     0s

Barrier performed 10 iterations in 0.19 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with primal simplex
Solved in 5237 iterations and 0.19 seconds
Optimal objective  1.870864216e+07
INFO:pypsa.linopf:Optimization successful. Objective value: 1.87e+07
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


load


add_BESS_load
300


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 2.8s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-kpoly3s8.lp
Reading time = 0.28 seconds
obj: 154248 rows, 73489 columns, 258595 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 154248 rows, 73489 columns and 258595 nonzeros
Model fingerprint: 0x4132e045
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [7e+00, 4e+01]
  RHS range        [1e-06, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 142324 rows and 33047 columns
Presolve time: 0.11s
Presolved: 11924 rows, 40442 columns, 83043 nonzeros

Ordering time: 0.26s

Barrier statistics:
 AA' NZ     : 4.939e+04
 Factor NZ  : 6.966e+05 (roughly 27 MBytes of memory)
 Factor Ops : 1.211e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.24245001e+12 -1.99449595e+12  4.01e+04 9.60e+03  6.63e+08     1s
   1   2.88136318e+11 -1.12829697e+12  4.74e+03 5.31e+03  8.70e+07     1s
   2   3.28189681e+10 -2.85145917e+11  4.28e+02 1.75e-10  9.43e+06     1s
   3   9.49524760e+09 -3.86252300e+10  4.17e+01 2.33e-10  1.05e+06     1s
   4   4.15770644e+09 -1.40034450e+10  1.01e+01 3.49e-10  3.08e+05     1s
   5   1.51905771e+09 -5.23127702e+09  3.95e+00 2.18e-10  1.05e+05     1s
   6   4.09369085e+08 -2.36716604e+09  1.09e+00 2.91e-10  3.82e+04     1s
   7   3.86245716e+07 -5.99447955e+08  2.33e-02 1.56e-10  7.93e+03     1s
   8   3.13768878e+07 -2.86582775e+08  1.29e-02 1.01e-10  3.94e+03     1s
   9   2.44524321e+07 -1.53281732e+08  6.93e-03 7.15e-11  2.20e+03     1s
  10   2.14505881e+07 -9.73052278e+07  5.30e-03 7.15e-11  1.47e+03     1s
  11   1.70499406e+07 -5.65943643e+07  3.38e-03 5.70e-11  9.11e+02     1s
  12   1.62591215e+07 -4.83063881e+07  3.08e-03 5.70e-11  7.99e+02     1s
  13   1.46139317e+07 -2.72039754e+07  2.52e-03 5.70e-11  5.17e+02     1s
  14   1.17125585e+07 -1.70435983e+07  1.59e-03 4.24e-11  3.56e+02     1s
  15   1.02205601e+07 -7.84346883e+06  1.14e-03 2.79e-11  2.23e+02     1s
  16   9.18123158e+06 -5.10610485e+06  8.53e-04 2.06e-11  1.77e+02     1s
  17   8.40958655e+06 -1.28013655e+06  6.41e-04 2.91e-11  1.20e+02     1s
  18   7.89983111e+06  4.50999490e+05  5.10e-04 2.91e-11  9.21e+01     1s
  19   7.36378173e+06  1.68937441e+06  3.80e-04 2.91e-11  7.02e+01     1s
  20   6.96920277e+06  2.88376669e+06  2.92e-04 2.91e-11  5.05e+01     1s
  21   6.54895459e+06  3.66991483e+06  2.05e-04 2.91e-11  3.56e+01     1s
  22   6.34164915e+06  4.50947879e+06  1.61e-04 1.46e-11  2.27e+01     1s
  23   6.09751927e+06  4.84235818e+06  1.10e-04 2.91e-11  1.55e+01     1s
  24   5.89869885e+06  5.24680940e+06  6.65e-05 2.91e-11  8.06e+00     1s
  25   5.76517822e+06  5.33385319e+06  3.98e-05 2.91e-11  5.33e+00     1s
  26   5.72534417e+06  5.40383900e+06  3.17e-05 1.46e-11  3.98e+00     1s
  27   5.66864791e+06  5.47850473e+06  2.04e-05 7.28e-12  2.35e+00     1s
  28   5.64370116e+06  5.50918474e+06  1.56e-05 1.46e-11  1.66e+00     1s
  29   5.61427348e+06  5.52937703e+06  9.93e-06 1.46e-11  1.05e+00     1s
  30   5.59375224e+06  5.54160809e+06  6.07e-06 2.91e-11  6.45e-01     2s
  31   5.57567826e+06  5.55243045e+06  2.75e-06 1.46e-11  2.87e-01     2s
  32   5.56710392e+06  5.55442281e+06  1.22e-06 1.46e-11  1.57e-01     2s
  33   5.56289637e+06  5.55774844e+06  4.94e-07 1.46e-11  6.36e-02     2s
  34   5.56141446e+06  5.55868466e+06  2.54e-07 2.91e-11  3.38e-02     2s
  35   5.56008994e+06  5.55939780e+06  4.35e-08 2.91e-11  8.56e-03     2s
  36   5.55994173e+06  5.55965487e+06  2.26e-08 2.18e-11  3.55e-03     2s
  37   5.55985782e+06  5.55974858e+06  2.82e-08 2.91e-11  1.35e-03     2s
  38   5.55981519e+06  5.55977096e+06  4.96e-08 2.91e-11  5.47e-04     2s
  39   5.55979169e+06  5.55978125e+06  4.38e-08 5.82e-11  1.29e-04     2s
  40   5.55978547e+06  5.55978286e+06  1.05e-08 5.82e-11  3.23e-05     2s
  41   5.55978337e+06  5.55978330e+06  2.95e-10 5.82e-11  9.61e-07     2s
  42   5.55978335e+06  5.55978333e+06  1.46e-09 5.82e-11  2.22e-07     2s
  43   5.55978334e+06  5.55978334e+06  3.92e-09 5.82e-11  2.93e-08     2s
  44   5.55978334e+06  5.55978334e+06  4.47e-09 5.82e-11  2.32e-09     2s

Barrier solved model in 44 iterations and 1.92 seconds
Optimal objective 5.55978334e+06

Crossover log...

     888 DPushes remaining with DInf 0.0000000e+00                 2s
       0 DPushes remaining with DInf 0.0000000e+00                 2s

     286 PPushes remaining with PInf 6.0000000e-06                 2s
       0 PPushes remaining with PInf 9.0000000e-06                 2s

  Push phase complete: Pinf 9.0000000e-06, Dinf 3.0946565e-10      2s

Iteration    Objective       Primal Inf.    Dual Inf.      Time
    1177    5.5597833e+06   4.000000e-06   0.000000e+00      2s
Extra simplex iterations after uncrush: 59
    1240    5.5597833e+06   0.000000e+00   0.000000e+00      3s

Solved with barrier
Solved in 1240 iterations and 2.54 seconds
Optimal objective  5.559783340e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 5.56e+06
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.78s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-_n6mdl8t.lp
Reading time = 0.11 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0x33a88c88
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [7e+00, 4e+01]
  RHS range        [1e-02, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57048 rows and 22020 columns
Presolve time: 0.05s
Presolved: 3936 rows, 4837 columns, 23611 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.833e+04
 Factor NZ  : 6.453e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.199e+06 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   3.85884564e+07 -8.77321914e+08  2.43e+04 5.68e-14  4.85e+05     0s
   1   1.52213166e+07 -4.85431975e+08  2.44e+03 1.28e-13  7.92e+04     0s
   2   1.21475575e+07 -7.99545305e+07  2.07e+02 3.69e-13  1.05e+04     0s
   3   1.13135400e+07 -3.48025845e+05  2.03e+01 1.14e-13  1.25e+03     0s
   4   1.09775346e+07  8.84193634e+06  3.96e+00 1.14e-12  2.23e+02     0s
   5   1.08478996e+07  1.00685524e+07  1.26e+00 4.12e-13  8.10e+01     0s
   6   1.07868188e+07  1.05347174e+07  3.43e-01 1.35e-13  2.61e+01     0s
   7   1.07655461e+07  1.06987870e+07  1.00e-01 5.33e-14  6.92e+00     0s
   8   1.07575547e+07  1.07516380e+07  1.47e-02 4.76e-14  6.14e-01     0s
   9   1.07561393e+07  1.07557673e+07  1.62e-03 4.33e-14  3.87e-02     0s

Barrier performed 9 iterations in 0.20 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with primal simplex
Solved in 5182 iterations and 0.20 seconds
Optimal objective  1.075595832e+07
INFO:pypsa.linopf:Optimization successful. Objective value: 1.08e+07
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


load


add_BESS_load
300


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 2.79s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-sq3h32v6.lp
Reading time = 0.29 seconds
obj: 154248 rows, 73489 columns, 258595 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 154248 rows, 73489 columns and 258595 nonzeros
Model fingerprint: 0xac6ff0af
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [7e+00, 4e+01]
  RHS range        [1e-02, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 142328 rows and 33863 columns
Presolve time: 0.11s
Presolved: 11920 rows, 39626 columns, 82223 nonzeros

Ordering time: 0.36s

Barrier statistics:
 AA' NZ     : 4.939e+04
 Factor NZ  : 7.329e+05 (roughly 27 MBytes of memory)
 Factor Ops : 1.310e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.24422532e+12 -2.01429407e+12  3.75e+04 1.37e+04  6.64e+08     1s
   1   2.81057298e+11 -1.13950097e+12  4.38e+03 5.38e+03  8.66e+07     1s
   2   3.18304102e+10 -2.87030739e+11  3.94e+02 1.84e-10  9.41e+06     1s
   3   9.45595499e+09 -4.21052370e+10  4.36e+01 2.91e-10  1.15e+06     1s
   4   4.27517002e+09 -1.52316446e+10  1.12e+01 1.75e-10  3.43e+05     1s
   5   1.47429610e+09 -5.98735059e+09  4.46e+00 1.75e-10  1.21e+05     1s
   6   3.87501810e+08 -2.08228209e+09  1.17e+00 1.30e-10  3.53e+04     1s
   7   5.64248535e+07 -7.40636191e+08  8.14e-02 1.53e-10  1.02e+04     1s
   8   4.70410100e+07 -3.14036299e+08  5.64e-02 1.01e-10  4.61e+03     1s
   9   3.31862472e+07 -1.62286056e+08  2.70e-02 8.61e-11  2.48e+03     1s
  10   2.80792647e+07 -9.21002996e+07  2.02e-02 7.15e-11  1.53e+03     1s
  11   2.44178578e+07 -4.66869436e+07  1.63e-02 7.15e-11  9.02e+02     1s
  12   2.08585009e+07 -2.37093549e+07  1.25e-02 6.55e-11  5.65e+02     1s
  13   1.69802460e+07 -1.09302720e+07  8.77e-03 4.24e-11  3.53e+02     1s
  14   1.53305838e+07 -5.66482065e+06  7.24e-03 3.51e-11  2.66e+02     1s
  15   1.45269651e+07 -2.96286765e+06  6.51e-03 3.51e-11  2.21e+02     1s
  16   1.27041329e+07 -1.44166864e+06  4.97e-03 2.79e-11  1.79e+02     1s
  17   1.22641449e+07 -7.92196001e+05  4.62e-03 3.51e-11  1.65e+02     1s
  18   1.17428583e+07  7.43874014e+05  4.15e-03 3.51e-11  1.39e+02     1s
  19   1.09186532e+07  2.37931759e+06  3.46e-03 2.91e-11  1.08e+02     1s
  20   1.06555734e+07  2.56350992e+06  3.24e-03 2.06e-11  1.02e+02     1s
  21   9.96699175e+06  3.07613767e+06  2.66e-03 2.91e-11  8.70e+01     1s
  22   8.77847862e+06  4.22088323e+06  1.67e-03 1.46e-11  5.76e+01     1s
  23   8.21405058e+06  5.38552683e+06  1.15e-03 1.46e-11  3.57e+01     1s
  24   7.73406641e+06  5.72577771e+06  7.37e-04 1.46e-11  2.54e+01     1s
  25   7.48146458e+06  6.12220563e+06  5.22e-04 1.46e-11  1.72e+01     1s
  26   7.35529052e+06  6.38142756e+06  4.10e-04 1.46e-11  1.23e+01     1s
  27   7.20050437e+06  6.51728821e+06  2.76e-04 1.46e-11  8.62e+00     1s
  28   7.07679580e+06  6.65001338e+06  1.71e-04 1.46e-11  5.39e+00     1s
  29   6.98176787e+06  6.77752202e+06  9.50e-05 1.46e-11  2.58e+00     1s
  30   6.95648985e+06  6.81635418e+06  7.43e-05 1.46e-11  1.77e+00     1s
  31   6.91860260e+06  6.84076701e+06  4.38e-05 1.46e-11  9.82e-01     1s
  32   6.90265959e+06  6.85245616e+06  3.13e-05 2.91e-11  6.34e-01     1s
  33   6.88239590e+06  6.85707244e+06  1.55e-05 1.46e-11  3.20e-01     1s
  34   6.87783052e+06  6.85837627e+06  1.20e-05 1.46e-11  2.46e-01     1s
  35   6.86772628e+06  6.86025649e+06  4.24e-06 2.91e-11  9.43e-02     1s
  36   6.86446158e+06  6.86132365e+06  1.84e-06 2.91e-11  3.96e-02     1s
  37   6.86305741e+06  6.86153422e+06  8.06e-07 1.46e-11  1.92e-02     1s
  38   6.86258077e+06  6.86176182e+06  4.68e-07 1.46e-11  1.03e-02     1s
  39   6.86206129e+06  6.86184304e+06  1.07e-07 2.91e-11  2.75e-03     1s
  40   6.86195614e+06  6.86187936e+06  3.67e-08 1.46e-11  9.69e-04     1s
  41   6.86190220e+06  6.86189289e+06  6.51e-09 2.91e-11  1.18e-04     1s
  42   6.86189760e+06  6.86189725e+06  1.19e-08 5.82e-11  4.51e-06     1s
  43   6.86189755e+06  6.86189751e+06  2.56e-09 5.82e-11  4.98e-07     1s
  44   6.86189754e+06  6.86189753e+06  3.41e-09 5.82e-11  1.31e-07     1s
  45   6.86189754e+06  6.86189753e+06  9.67e-10 5.82e-11  3.15e-08     1s
  46   6.86189754e+06  6.86189754e+06  1.25e-09 5.82e-11  2.18e-09     1s

Barrier solved model in 46 iterations and 1.44 seconds
Optimal objective 6.86189754e+06

Crossover log...

    1638 DPushes remaining with DInf 0.0000000e+00                 1s
       0 DPushes remaining with DInf 0.0000000e+00                 2s

     410 PPushes remaining with PInf 3.0000000e-06                 2s
       0 PPushes remaining with PInf 1.4000000e-05                 2s

  Push phase complete: Pinf 1.4000000e-05, Dinf 4.7610128e-10      2s

Iteration    Objective       Primal Inf.    Dual Inf.      Time
    2051    6.8618975e+06   1.300000e-05   0.000000e+00      2s
Extra simplex iterations after uncrush: 19
    2076    6.8618975e+06   0.000000e+00   0.000000e+00      2s

Solved with barrier
Solved in 2076 iterations and 1.67 seconds
Optimal objective  6.861897536e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 6.86e+06
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.75s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-wsgj45e6.lp
Reading time = 0.11 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0x25d5b3e0
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [7e+00, 5e+01]
  RHS range        [1e-02, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57052 rows and 22018 columns
Presolve time: 0.05s
Presolved: 3932 rows, 4839 columns, 23609 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.832e+04
 Factor NZ  : 6.455e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.201e+06 (less than 1 second per iteration)
 Threads    : 30

Barrier performed 0 iterations in 0.23 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with primal simplex
Solved in 4844 iterations and 0.23 seconds
Optimal objective  3.187042965e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 3.19e+06
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


load


add_BESS_load
300


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 2.69s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-fbhgckyw.lp
Reading time = 0.29 seconds
obj: 154248 rows, 73489 columns, 258595 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 154248 rows, 73489 columns and 258595 nonzeros
Model fingerprint: 0x7be5fb4f
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [7e+00, 5e+01]
  RHS range        [1e-02, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 142337 rows and 33709 columns
Presolve time: 0.13s
Presolved: 11911 rows, 39780 columns, 82368 nonzeros

Ordering time: 0.53s

Barrier statistics:
 AA' NZ     : 4.938e+04
 Factor NZ  : 7.412e+05 (roughly 27 MBytes of memory)
 Factor Ops : 1.359e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.24463680e+12 -2.02235755e+12  3.48e+04 1.37e+04  6.62e+08     1s
   1   2.81974477e+11 -1.14051491e+12  4.07e+03 5.83e+03  8.65e+07     1s
   2   3.26426423e+10 -3.23575822e+11  3.88e+02 1.75e-10  1.02e+07     1s
   3   8.80814391e+09 -4.69290539e+10  4.94e+01 2.04e-10  1.31e+06     1s
   4   5.26028089e+09 -1.77298290e+10  1.74e+01 1.46e-10  4.55e+05     1s
   5   2.52606340e+09 -7.92441206e+09  8.61e+00 2.04e-10  1.95e+05     1s
   6   1.63578901e+08 -1.49477405e+09  6.91e-01 1.89e-10  2.36e+04     1s
   7   8.76547380e+07 -6.11783209e+08  3.01e-01 1.18e-10  9.42e+03     1s
   8   6.14536167e+07 -2.89598117e+08  1.84e-01 1.18e-10  4.65e+03     1s
   9   3.43458624e+07 -9.53503563e+07  8.12e-02 1.18e-10  1.69e+03     1s
  10   2.24362500e+07 -4.28493816e+07  4.34e-02 1.18e-10  8.40e+02     1s
  11   1.67589923e+07 -2.21458604e+07  2.79e-02 5.93e-11  4.98e+02     1s
  12   1.36149570e+07 -9.83925056e+06  1.99e-02 5.93e-11  2.99e+02     1s
  13   9.17885402e+06 -2.66547455e+06  9.12e-03 4.48e-11  1.50e+02     1s
  14   7.91076521e+06  9.80943673e+05  6.31e-03 4.48e-11  8.76e+01     1s
  15   6.39691279e+06  3.02896897e+06  3.05e-03 2.91e-11  4.25e+01     1s
  16   5.90627157e+06  3.81984491e+06  2.05e-03 1.93e-11  2.63e+01     1s
  17   5.29802227e+06  4.36178946e+06  8.23e-04 1.46e-11  1.18e+01     1s
  18   4.99987802e+06  4.67124022e+06  2.41e-04 2.18e-11  4.13e+00     2s
  19   4.92967218e+06  4.78996978e+06  1.17e-04 4.37e-11  1.76e+00     2s
  20   4.89112060e+06  4.83628606e+06  4.68e-05 2.91e-11  6.89e-01     2s
  21   4.87706577e+06  4.84984461e+06  2.31e-05 1.46e-11  3.42e-01     2s
  22   4.86858154e+06  4.85563370e+06  9.57e-06 2.91e-11  1.63e-01     2s
  23   4.86628661e+06  4.85807445e+06  6.14e-06 1.46e-11  1.03e-01     2s
  24   4.86495497e+06  4.85986224e+06  4.28e-06 1.46e-11  6.40e-02     2s
  25   4.86453550e+06  4.86033810e+06  3.67e-06 1.46e-11  5.28e-02     2s
  26   4.86296247e+06  4.86060960e+06  1.47e-06 1.46e-11  2.96e-02     2s
  27   4.86280754e+06  4.86140112e+06  1.25e-06 2.91e-11  1.77e-02     2s
  28   4.86234343e+06  4.86159005e+06  6.15e-07 1.46e-11  9.47e-03     2s
  29   4.86200658e+06  4.86172758e+06  1.69e-07 1.46e-11  3.51e-03     2s
  30   4.86194240e+06  4.86177448e+06  8.59e-08 1.46e-11  2.11e-03     2s
  31   4.86189859e+06  4.86184228e+06  3.86e-08 2.18e-11  7.08e-04     2s
  32   4.86188157e+06  4.86186644e+06  2.59e-08 2.91e-11  1.90e-04     2s
  33   4.86187601e+06  4.86187044e+06  2.87e-08 2.91e-11  7.01e-05     2s
  34   4.86187292e+06  4.86187223e+06  3.28e-08 5.82e-11  8.67e-06     2s
  35   4.86187259e+06  4.86187258e+06  2.11e-08 5.82e-11  2.28e-07     2s
  36   4.86187259e+06  4.86187259e+06  2.07e-09 5.82e-11  8.33e-09     2s

Barrier solved model in 36 iterations and 2.17 seconds
Optimal objective 4.86187259e+06

Crossover log...

    1289 DPushes remaining with DInf 0.0000000e+00                 2s
       0 DPushes remaining with DInf 0.0000000e+00                 2s

     361 PPushes remaining with PInf 0.0000000e+00                 2s
       0 PPushes remaining with PInf 2.0000000e-06                 2s

  Push phase complete: Pinf 2.0000000e-06, Dinf 1.6349340e-10      2s

Iteration    Objective       Primal Inf.    Dual Inf.      Time
    1653    4.8618726e+06   1.000000e-06   0.000000e+00      2s
    1654    4.8618726e+06   0.000000e+00   0.000000e+00      2s

Solved with barrier
Solved in 1654 iterations and 2.50 seconds
Optimal objective  4.861872592e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 4.86e+06
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.79s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-sqwbb2gi.lp
Reading time = 0.11 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0xe4c705be
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [7e+00, 5e+01]
  RHS range        [1e-02, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57048 rows and 22014 columns
Presolve time: 0.05s
Presolved: 3936 rows, 4843 columns, 23617 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.833e+04
 Factor NZ  : 6.453e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.199e+06 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   2.54500926e+07 -8.23937055e+08  2.35e+04 2.84e-14  4.38e+05     0s
   1   7.18615584e+06 -4.48986552e+08  2.25e+03 9.95e-14  7.03e+04     0s
   2   3.87670863e+06 -5.56562533e+07  1.65e+02 8.53e-14  6.80e+03     0s
   3   3.36520264e+06 -2.23155245e+06  1.75e+01 1.22e-12  6.04e+02     0s
   4   3.16053342e+06  1.18046780e+06  2.88e+00 5.97e-13  2.06e+02     0s
   5   3.09674111e+06  2.27004878e+06  1.33e+00 2.42e-13  8.58e+01     0s
   6   3.04030525e+06  2.68929682e+06  4.25e-01 8.79e-14  3.63e+01     0s
   7   3.01246146e+06  2.86491003e+06  1.33e-01 4.15e-14  1.53e+01     0s
   8   2.99856563e+06  2.94549286e+06  1.98e-02 3.81e-14  5.48e+00     0s
   9   2.99609206e+06  2.97278980e+06  9.24e-03 2.84e-14  2.41e+00     0s
  10   2.99381112e+06  2.99122567e+06  3.33e-04 2.84e-14  2.67e-01     0s
  11   2.99359827e+06  2.99356060e+06  5.90e-07 2.84e-14  3.89e-03     0s

Barrier performed 11 iterations in 0.20 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with primal simplex
Solved in 5116 iterations and 0.20 seconds
Optimal objective  2.993593905e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 2.99e+06
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


load


add_BESS_load
300


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 2.82s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-ntw95_3j.lp
Reading time = 0.28 seconds
obj: 154248 rows, 73489 columns, 258595 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 154248 rows, 73489 columns and 258595 nonzeros
Model fingerprint: 0xe16a9b0e
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [7e+00, 5e+01]
  RHS range        [1e-02, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 142321 rows and 33836 columns
Presolve time: 0.12s
Presolved: 11927 rows, 39653 columns, 82257 nonzeros

Ordering time: 0.27s

Barrier statistics:
 AA' NZ     : 4.940e+04
 Factor NZ  : 7.175e+05 (roughly 27 MBytes of memory)
 Factor Ops : 1.276e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.24650557e+12 -2.02881445e+12  3.47e+04 1.37e+04  6.63e+08     1s
   1   2.81004627e+11 -1.13780882e+12  4.07e+03 5.78e+03  8.66e+07     1s
   2   3.19130442e+10 -3.20884197e+11  3.84e+02 1.80e-10  1.02e+07     1s
   3   8.61170840e+09 -4.82603722e+10  5.32e+01 1.75e-10  1.38e+06     1s
   4   4.94964858e+09 -1.96985588e+10  1.69e+01 1.75e-10  4.76e+05     1s
   5   2.59005471e+09 -8.47290994e+09  8.91e+00 2.04e-10  2.07e+05     1s
   6   1.77354278e+08 -1.76464078e+09  7.18e-01 2.33e-10  2.75e+04     1s
   7   8.10074087e+07 -6.82316488e+08  2.52e-01 1.18e-10  1.02e+04     1s
   8   5.70628778e+07 -2.57066302e+08  1.53e-01 1.18e-10  4.13e+03     1s
   9   1.86229528e+07 -1.16348923e+08  1.66e-02 8.84e-11  1.71e+03     1s
  10   1.44370091e+07 -5.80675135e+07  9.89e-03 8.84e-11  9.18e+02     1s
  11   1.14944761e+07 -2.30253715e+07  6.26e-03 5.93e-11  4.37e+02     1s
  12   8.96782846e+06 -1.00627260e+07  3.81e-03 4.48e-11  2.40e+02     1s
  13   7.12614139e+06 -3.99967494e+06  2.22e-03 3.75e-11  1.40e+02     1s
  14   5.79613565e+06 -6.33601434e+04  1.16e-03 2.91e-11  7.39e+01     1s
  15   5.24899813e+06  2.63589112e+06  7.57e-04 1.46e-11  3.30e+01     1s
  16   4.84217709e+06  3.19706732e+06  4.72e-04 1.46e-11  2.07e+01     1s
  17   4.49349075e+06  3.67924073e+06  2.40e-04 1.46e-11  1.03e+01     1s
  18   4.34303976e+06  3.96986077e+06  1.39e-04 2.91e-11  4.71e+00     1s
  19   4.18994442e+06  4.07769676e+06  3.90e-05 2.18e-11  1.42e+00     1s
  20   4.15628599e+06  4.10199856e+06  1.82e-05 1.46e-11  6.85e-01     1s
  21   4.13913550e+06  4.11483413e+06  8.05e-06 1.46e-11  3.06e-01     1s
  22   4.13006856e+06  4.12099103e+06  2.93e-06 1.46e-11  1.14e-01     1s
  23   4.12733287e+06  4.12282118e+06  1.45e-06 1.46e-11  5.69e-02     1s
  24   4.12592976e+06  4.12355163e+06  7.36e-07 2.91e-11  3.00e-02     1s
  25   4.12507106e+06  4.12403411e+06  2.98e-07 1.46e-11  1.31e-02     1s
  26   4.12499910e+06  4.12422688e+06  2.66e-07 2.91e-11  9.74e-03     1s
  27   4.12464053e+06  4.12435191e+06  9.68e-08 1.46e-11  3.64e-03     1s
  28   4.12459851e+06  4.12440252e+06  9.67e-08 2.91e-11  2.47e-03     1s
  29   4.12457321e+06  4.12442318e+06  7.69e-08 1.46e-11  1.89e-03     1s
  30   4.12454939e+06  4.12443706e+06  8.21e-08 2.91e-11  1.42e-03     1s
  31   4.12453328e+06  4.12444901e+06  8.35e-08 2.91e-11  1.06e-03     1s
  32   4.12450966e+06  4.12445179e+06  1.37e-07 2.91e-11  7.30e-04     1s
  33   4.12447626e+06  4.12445568e+06  2.23e-07 5.82e-11  2.59e-04     1s
  34   4.12446182e+06  4.12445768e+06  1.87e-06 5.82e-11  5.22e-05     1s
  35   4.12445959e+06  4.12445801e+06  6.27e-07 5.82e-11  1.99e-05     1s
  36   4.12445915e+06  4.12445824e+06  3.88e-07 4.37e-11  1.15e-05     1s
  37   4.12445887e+06  4.12445838e+06  2.36e-07 5.82e-11  6.24e-06     2s
  38   4.12445847e+06  4.12445842e+06  7.01e-09 2.91e-11  6.79e-07     2s
  39   4.12445844e+06  4.12445843e+06  4.20e-10 8.73e-11  5.45e-08     2s
  40   4.12445843e+06  4.12445843e+06  2.97e-09 8.73e-11  5.81e-09     2s

Barrier solved model in 40 iterations and 1.63 seconds
Optimal objective 4.12445843e+06

Crossover log...

    1692 DPushes remaining with DInf 0.0000000e+00                 2s
       0 DPushes remaining with DInf 0.0000000e+00                 2s

    1544 PPushes remaining with PInf 3.0000000e-06                 2s

Solved with dual simplex
Solved in 11934 iterations and 2.02 seconds
Optimal objective  4.124458433e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 4.12e+06
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.78s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-jdiorma_.lp
Reading time = 0.11 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0x50bc06ee
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [5e+00, 5e+01]
  RHS range        [1e-02, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57048 rows and 22007 columns
Presolve time: 0.05s
Presolved: 3936 rows, 4850 columns, 23624 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.833e+04
 Factor NZ  : 6.453e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.199e+06 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   3.98537225e+07 -9.92036545e+08  2.31e+04 5.68e-14  5.23e+05     0s
   1   1.38528959e+07 -5.35533627e+08  2.11e+03 1.42e-13  8.28e+04     0s
   2   1.03735276e+07 -7.49776032e+07  2.10e+02 1.42e-13  9.84e+03     0s
   3   9.38588045e+06  1.95970336e+06  2.08e+01 3.27e-13  8.04e+02     0s
   4   9.09450007e+06  7.45068542e+06  3.87e+00 5.40e-13  1.72e+02     0s
   5   9.01987558e+06  8.27916696e+06  1.51e+00 2.56e-13  7.69e+01     0s
   6   8.98166993e+06  8.65758853e+06  6.73e-01 1.02e-13  3.35e+01     0s
   7   8.95702101e+06  8.77787229e+06  2.79e-01 6.98e-14  1.85e+01     0s
   8   8.93983176e+06  8.85237529e+06  2.94e-02 4.14e-14  9.02e+00     0s
   9   8.93732873e+06  8.90248363e+06  1.19e-02 2.84e-14  3.59e+00     0s
  10   8.93541154e+06  8.92300921e+06  3.34e-03 2.84e-14  1.28e+00     0s
  11   8.93473747e+06  8.93130931e+06  1.26e-03 2.84e-14  3.54e-01     0s
  12   8.93434096e+06  8.93405729e+06  2.09e-04 2.84e-14  2.93e-02     0s
  13   8.93425040e+06  8.93424187e+06  1.75e-06 2.93e-14  8.79e-04     0s
  14   8.93424867e+06  8.93424866e+06  5.00e-12 5.68e-14  8.79e-07     0s
  15   8.93424866e+06  8.93424866e+06  5.46e-12 2.91e-14  2.24e-12     0s

Barrier solved model in 15 iterations and 0.20 seconds
Optimal objective 8.93424866e+06


Solved with primal simplex
Solved in 5418 iterations and 0.21 seconds
Optimal objective  8.934248665e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 8.93e+06
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


load


add_BESS_load
300


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 2.76s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-5bnjsq83.lp
Reading time = 0.28 seconds
obj: 154248 rows, 73489 columns, 258595 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 154248 rows, 73489 columns and 258595 nonzeros
Model fingerprint: 0x39220255
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [5e+00, 5e+01]
  RHS range        [1e-02, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 142320 rows and 33126 columns
Presolve time: 0.11s
Presolved: 11928 rows, 40363 columns, 82968 nonzeros

Ordering time: 0.23s

Barrier statistics:
 AA' NZ     : 4.940e+04
 Factor NZ  : 7.082e+05 (roughly 27 MBytes of memory)
 Factor Ops : 1.222e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.24209135e+12 -2.00829518e+12  4.11e+04 1.37e+04  6.63e+08     1s
   1   2.87450642e+11 -1.13955192e+12  4.81e+03 5.20e+03  8.65e+07     1s
   2   3.34345096e+10 -2.88634951e+11  4.53e+02 1.82e-10  9.66e+06     1s
   3   1.01379290e+10 -4.80897403e+10  6.08e+01 4.95e-10  1.37e+06     1s
   4   5.22667868e+09 -1.81401949e+10  2.07e+01 2.33e-10  4.61e+05     1s
   5   2.46594157e+09 -6.43445219e+09  9.93e+00 2.62e-10  1.67e+05     1s
   6   4.91997527e+08 -2.61575739e+09  2.20e+00 1.36e-10  4.71e+04     1s
   7   5.73140763e+07 -7.24119407e+08  1.13e-01 1.36e-10  9.91e+03     1s
   8   4.62631453e+07 -3.19358261e+08  7.09e-02 8.84e-11  4.61e+03     1s
   9   3.59123151e+07 -1.53648143e+08  4.22e-02 1.07e-10  2.38e+03     1s
  10   3.20069360e+07 -9.24203075e+07  3.44e-02 7.79e-11  1.56e+03     1s
  11   2.67603730e+07 -5.82813464e+07  2.46e-02 7.79e-11  1.06e+03     1s
  12   2.28844845e+07 -3.21904383e+07  1.82e-02 6.34e-11  6.87e+02     1s
  13   1.93562995e+07 -1.60187617e+07  1.27e-02 4.48e-11  4.40e+02     1s
  14   1.60811334e+07 -8.34077825e+06  7.84e-03 3.43e-11  3.04e+02     1s
  15   1.50515953e+07 -3.03443715e+06  6.39e-03 3.43e-11  2.25e+02     1s
  16   1.46131260e+07 -7.58329248e+05  5.80e-03 2.70e-11  1.91e+02     1s
  17   1.33736319e+07  1.98832040e+06  4.20e-03 2.30e-11  1.41e+02     1s
  18   1.22014659e+07  5.40540432e+06  2.74e-03 2.70e-11  8.43e+01     1s
  19   1.13326471e+07  6.96711052e+06  1.74e-03 1.97e-11  5.41e+01     1s
  20   1.09536053e+07  8.70068451e+06  1.32e-03 1.46e-11  2.79e+01     1s
  21   1.05769490e+07  9.10826706e+06  9.16e-04 1.46e-11  1.82e+01     1s
  22   1.02398317e+07  9.35267895e+06  5.60e-04 1.46e-11  1.10e+01     1s
  23   1.01341751e+07  9.44796718e+06  4.50e-04 1.46e-11  8.50e+00     1s
  24   1.00775666e+07  9.52513126e+06  3.92e-04 1.46e-11  6.85e+00     1s
  25   1.00007136e+07  9.59137449e+06  3.14e-04 1.46e-11  5.07e+00     1s
  26   9.87172340e+06  9.63677157e+06  1.85e-04 1.46e-11  2.91e+00     1s
  27   9.82503149e+06  9.64496996e+06  1.43e-04 2.91e-11  2.23e+00     1s
  28   9.81827830e+06  9.64920024e+06  1.36e-04 1.46e-11  2.09e+00     1s
  29   9.80981163e+06  9.66384838e+06  1.27e-04 1.46e-11  1.81e+00     1s
  30   9.76851114e+06  9.66777280e+06  8.53e-05 1.46e-11  1.25e+00     1s
  31   9.74840493e+06  9.66979734e+06  6.77e-05 1.46e-11  9.74e-01     1s
  32   9.74495855e+06  9.67430337e+06  6.42e-05 1.46e-11  8.75e-01     1s
  33   9.72594596e+06  9.67564605e+06  4.60e-05 1.46e-11  6.23e-01     1s
  34   9.71639306e+06  9.67727461e+06  3.65e-05 2.91e-11  4.85e-01     2s
  35   9.69932743e+06  9.67874773e+06  1.84e-05 1.46e-11  2.55e-01     2s
  36   9.69427995e+06  9.68043837e+06  1.34e-05 1.46e-11  1.72e-01     2s
  37   9.68919111e+06  9.68097349e+06  7.73e-06 1.46e-11  1.02e-01     2s
  38   9.68792920e+06  9.68134050e+06  6.33e-06 1.46e-11  8.16e-02     2s
  39   9.68567113e+06  9.68170617e+06  3.83e-06 2.91e-11  4.91e-02     2s
  40   9.68484565e+06  9.68183962e+06  2.95e-06 1.46e-11  3.72e-02     2s
  41   9.68405449e+06  9.68188223e+06  2.09e-06 1.46e-11  2.69e-02     2s
  42   9.68271381e+06  9.68194348e+06  6.51e-07 1.46e-11  9.54e-03     2s
  43   9.68238300e+06  9.68200050e+06  3.06e-07 1.46e-11  4.74e-03     2s
  44   9.68227289e+06  9.68203181e+06  1.89e-07 1.46e-11  2.99e-03     2s
  45   9.68211536e+06  9.68207754e+06  2.30e-08 5.82e-11  4.69e-04     2s
  46   9.68209854e+06  9.68208693e+06  8.63e-09 5.82e-11  1.44e-04     2s
  47   9.68209146e+06  9.68209009e+06  5.70e-09 8.73e-11  1.70e-05     2s
  48   9.68209072e+06  9.68209044e+06  2.45e-09 5.82e-11  3.47e-06     2s
  49   9.68209049e+06  9.68209048e+06  1.72e-09 5.82e-11  1.35e-07     2s
  50   9.68209048e+06  9.68209048e+06  1.83e-09 8.73e-11  2.90e-08     2s
  51   9.68209048e+06  9.68209048e+06  5.42e-09 5.82e-11  2.79e-09     2s

Barrier solved model in 51 iterations and 2.04 seconds
Optimal objective 9.68209048e+06

Crossover log...

    1109 DPushes remaining with DInf 0.0000000e+00                 2s
       0 DPushes remaining with DInf 0.0000000e+00                 2s

     302 PPushes remaining with PInf 1.6000000e-05                 2s
       0 PPushes remaining with PInf 1.6000000e-05                 2s

  Push phase complete: Pinf 1.6000000e-05, Dinf 5.9420122e-10      2s

Iteration    Objective       Primal Inf.    Dual Inf.      Time
    1414    9.6820905e+06   1.000000e-05   0.000000e+00      2s
Extra simplex iterations after uncrush: 37
    1457    9.6820905e+06   0.000000e+00   0.000000e+00      3s

Solved with barrier
Solved in 1457 iterations and 2.56 seconds
Optimal objective  9.682090480e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 9.68e+06
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.78s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-z8z1u7ey.lp
Reading time = 0.11 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0x5dda8511
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [5e+00, 3e+01]
  RHS range        [9e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57049 rows and 22031 columns
Presolve time: 0.05s
Presolved: 3935 rows, 4826 columns, 23599 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.832e+04
 Factor NZ  : 6.452e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.199e+06 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   4.19103820e+07 -2.14275175e+09  1.99e+04 5.68e-14  9.21e+05     0s
   1   2.32058930e+07 -1.00628365e+09  2.44e+03 2.84e-13  1.61e+05     0s
   2   1.98540891e+07 -1.37501550e+08  2.45e+02 3.41e-13  1.86e+04     0s
   3   1.88051982e+07  6.37540248e+06  2.60e+01 8.64e-12  1.38e+03     0s

Barrier performed 3 iterations in 0.19 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with primal simplex
Solved in 5004 iterations and 0.19 seconds
Optimal objective  1.819016335e+07
INFO:pypsa.linopf:Optimization successful. Objective value: 1.82e+07
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


load


add_BESS_load
300


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 2.77s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-b4meps5k.lp
Reading time = 0.28 seconds
obj: 154248 rows, 73489 columns, 258595 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 154248 rows, 73489 columns and 258595 nonzeros
Model fingerprint: 0x7af41839
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [5e+00, 3e+01]
  RHS range        [9e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 142329 rows and 32683 columns
Presolve time: 0.13s
Presolved: 11919 rows, 40806 columns, 83402 nonzeros

Ordering time: 0.33s

Barrier statistics:
 AA' NZ     : 4.939e+04
 Factor NZ  : 7.112e+05 (roughly 27 MBytes of memory)
 Factor Ops : 1.263e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.72636247e+12 -1.97760074e+12  5.29e+04 1.16e+04  9.27e+08     1s
   1   3.83735211e+11 -1.20573971e+12  5.66e+03 2.63e+02  1.09e+08     1s
   2   3.41128487e+10 -3.76602000e+11  4.14e+02 2.33e-10  1.09e+07     1s
   3   1.04884941e+10 -4.81137227e+10  5.68e+01 2.91e-09  1.39e+06     1s
   4   4.95996425e+09 -1.78414727e+10  1.70e+01 8.29e-10  4.38e+05     1s
   5   2.20544940e+09 -6.17034617e+09  7.83e+00 1.59e-10  1.53e+05     1s
   6   4.27253850e+08 -2.93435880e+09  1.71e+00 1.59e-10  4.89e+04     1s
   7   6.39700427e+07 -7.51333110e+08  1.34e-01 1.59e-10  1.03e+04     1s
   8   4.97801418e+07 -3.41072144e+08  8.66e-02 1.59e-10  4.90e+03     1s
   9   3.12069800e+07 -1.66011165e+08  3.63e-02 1.30e-10  2.45e+03     1s
  10   2.57673152e+07 -1.00563736e+08  2.59e-02 1.30e-10  1.56e+03     1s
  11   1.87755006e+07 -6.66388054e+07  1.42e-02 1.01e-10  1.05e+03     1s
  12   1.69762143e+07 -3.91280080e+07  1.16e-02 1.01e-10  6.91e+02     1s
  13   1.40358284e+07 -1.66674114e+07  7.92e-03 7.15e-11  3.78e+02     1s
  14   1.20998668e+07 -9.01396117e+06  5.71e-03 7.15e-11  2.60e+02     1s
  15   1.06253113e+07 -2.25413667e+06  4.21e-03 2.91e-11  1.58e+02     1s
  16   9.74804448e+06  3.30023700e+05  3.32e-03 2.91e-11  1.16e+02     1s
  17   8.58749037e+06  2.19499941e+06  2.21e-03 2.06e-11  7.84e+01     1s
  18   7.73335810e+06  4.21109872e+06  1.45e-03 2.18e-11  4.32e+01     1s
  19   7.23620390e+06  4.80477386e+06  1.01e-03 1.46e-11  2.98e+01     1s
  20   6.91876038e+06  5.24232551e+06  7.22e-04 1.46e-11  2.06e+01     1s
  21   6.78895735e+06  5.59718135e+06  6.08e-04 2.91e-11  1.46e+01     1s
  22   6.65215598e+06  5.71246496e+06  4.90e-04 1.46e-11  1.15e+01     1s
  23   6.41194889e+06  5.87010203e+06  2.87e-04 1.46e-11  6.64e+00     1s
  24   6.30190655e+06  5.96216745e+06  1.98e-04 2.18e-11  4.16e+00     1s
  25   6.25336051e+06  5.98441249e+06  1.57e-04 1.46e-11  3.30e+00     1s
  26   6.23224443e+06  6.00244249e+06  1.39e-04 1.46e-11  2.82e+00     1s
  27   6.20383363e+06  6.01829905e+06  1.15e-04 1.46e-11  2.27e+00     1s
  28   6.12560835e+06  6.03221528e+06  5.05e-05 1.46e-11  1.14e+00     1s
  29   6.11921506e+06  6.04067211e+06  4.54e-05 1.46e-11  9.63e-01     1s
  30   6.10947540e+06  6.04508825e+06  3.77e-05 1.46e-11  7.89e-01     1s
  31   6.09819007e+06  6.05359011e+06  2.89e-05 1.46e-11  5.47e-01     1s
  32   6.06988061e+06  6.05657330e+06  6.88e-06 1.46e-11  1.63e-01     1s
  33   6.06322328e+06  6.05907332e+06  1.81e-06 1.46e-11  5.09e-02     1s
  34   6.06230707e+06  6.05999259e+06  1.16e-06 1.46e-11  2.84e-02     2s
  35   6.06148861e+06  6.06015268e+06  5.72e-07 2.91e-11  1.64e-02     2s
  36   6.06103604e+06  6.06054969e+06  2.43e-07 2.91e-11  5.96e-03     2s
  37   6.06070078e+06  6.06065142e+06  3.31e-08 5.82e-11  6.05e-04     2s
  38   6.06067822e+06  6.06066554e+06  1.71e-08 5.82e-11  1.55e-04     2s
  39   6.06067110e+06  6.06066792e+06  3.69e-09 5.82e-11  3.90e-05     2s
  40   6.06066966e+06  6.06066882e+06  1.10e-09 2.91e-11  1.02e-05     2s
  41   6.06066917e+06  6.06066896e+06  3.04e-10 2.91e-11  2.54e-06     2s
  42   6.06066902e+06  6.06066901e+06  1.14e-09 5.82e-11  1.34e-07     2s
  43   6.06066902e+06  6.06066902e+06  2.61e-09 8.73e-11  3.29e-09     2s

Barrier solved model in 43 iterations and 1.81 seconds
Optimal objective 6.06066902e+06

Crossover log...

     988 DPushes remaining with DInf 0.0000000e+00                 2s
       0 DPushes remaining with DInf 0.0000000e+00                 2s

     190 PPushes remaining with PInf 1.2000000e-05                 2s
       0 PPushes remaining with PInf 1.3000000e-05                 2s

  Push phase complete: Pinf 1.3000000e-05, Dinf 5.3801076e-10      2s

Iteration    Objective       Primal Inf.    Dual Inf.      Time
    1181    6.0606690e+06   9.000000e-06   0.000000e+00      2s
Extra simplex iterations after uncrush: 20
    1208    6.0606690e+06   0.000000e+00   0.000000e+00      2s

Solved with barrier
Solved in 1208 iterations and 2.40 seconds
Optimal objective  6.060669016e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 6.06e+06
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.79s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-smybfk2w.lp
Reading time = 0.11 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0xe1a2562c
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [5e+00, 3e+01]
  RHS range        [9e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57048 rows and 22035 columns
Presolve time: 0.05s
Presolved: 3936 rows, 4822 columns, 23596 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.833e+04
 Factor NZ  : 6.453e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.199e+06 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   5.86430600e+07 -2.11555047e+09  2.14e+04 1.14e-13  9.64e+05     0s
   1   3.33580707e+07 -1.02825731e+09  2.49e+03 2.84e-13  1.66e+05     0s
   2   2.81736794e+07 -1.46711450e+08  2.49e+02 2.84e-13  2.05e+04     0s
   3   2.66279017e+07 -2.33383824e+06  3.25e+01 2.27e-13  3.15e+03     0s
   4   2.61923288e+07  2.00678083e+07  5.13e+00 3.13e-13  6.43e+02     0s
   5   2.59882804e+07  2.37710634e+07  1.71e+00 1.14e-12  2.31e+02     0s
   6   2.58734572e+07  2.50181197e+07  6.42e-01 3.98e-13  8.89e+01     0s
   7   2.58125087e+07  2.54919077e+07  2.29e-01 1.28e-13  3.33e+01     0s
   8   2.57848897e+07  2.57050229e+07  6.01e-02 5.68e-14  8.29e+00     0s
   9   2.57775931e+07  2.57546097e+07  1.48e-02 5.68e-14  2.39e+00     0s
  10   2.57755234e+07  2.57745829e+07  7.83e-04 8.33e-14  9.77e-02     0s

Barrier performed 10 iterations in 0.21 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with primal simplex
Solved in 5114 iterations and 0.21 seconds
Optimal objective  2.577535069e+07
INFO:pypsa.linopf:Optimization successful. Objective value: 2.58e+07
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


load


add_BESS_load
300


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 2.77s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-68out7q2.lp
Reading time = 0.28 seconds
obj: 154248 rows, 73489 columns, 258595 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 154248 rows, 73489 columns and 258595 nonzeros
Model fingerprint: 0x42434823
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [5e+00, 3e+01]
  RHS range        [9e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 142337 rows and 32843 columns
Presolve time: 0.12s
Presolved: 11911 rows, 40646 columns, 83234 nonzeros

Ordering time: 0.20s

Barrier statistics:
 AA' NZ     : 4.938e+04
 Factor NZ  : 7.370e+05 (roughly 27 MBytes of memory)
 Factor Ops : 1.341e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.73443987e+12 -1.99635391e+12  5.69e+04 1.14e+04  9.30e+08     0s
   1   3.91075833e+11 -1.20930947e+12  6.38e+03 2.20e+02  1.14e+08     0s
   2   3.46755764e+10 -3.85095692e+11  4.64e+02 2.04e-10  1.13e+07     0s
   3   9.83313140e+09 -4.26142003e+10  4.56e+01 6.40e-10  1.15e+06     1s
   4   4.34779603e+09 -1.47056301e+10  1.26e+01 1.53e-10  3.43e+05     1s
   5   1.16244569e+09 -4.53288444e+09  3.83e+00 1.88e-10  9.10e+04     1s
   6   3.50764522e+08 -1.70117525e+09  1.18e+00 1.59e-10  2.91e+04     1s
   7   1.14827716e+08 -6.35045625e+08  3.11e-01 1.40e-10  9.81e+03     1s
   8   7.56600685e+07 -3.18786290e+08  1.87e-01 1.01e-10  5.08e+03     1s
   9   4.50404196e+07 -1.61575210e+08  9.87e-02 1.30e-10  2.63e+03     1s
  10   3.11984060e+07 -7.92469059e+07  6.32e-02 1.15e-10  1.39e+03     1s
  11   1.51482431e+07 -4.00338943e+07  2.42e-02 1.30e-10  6.88e+02     1s
  12   1.06747669e+07 -1.66071804e+07  1.52e-02 1.01e-10  3.39e+02     1s
  13   5.36795232e+06 -8.21539661e+06  5.23e-03 7.15e-11  1.68e+02     1s
  14   4.78902552e+06 -4.93632624e+06  4.26e-03 5.70e-11  1.20e+02     1s
  15   2.90752157e+06 -1.83816937e+06  1.25e-03 2.91e-11  5.85e+01     1s
  16   2.48527541e+06 -1.03278665e+05  7.34e-04 2.91e-11  3.19e+01     1s
  17   2.21720843e+06  7.71165706e+05  4.25e-04 2.91e-11  1.78e+01     1s
  18   1.99435208e+06  1.25201871e+06  1.84e-04 1.46e-11  9.13e+00     1s
  19   1.84984201e+06  1.57403789e+06  4.18e-05 2.91e-11  3.39e+00     1s
  20   1.82270006e+06  1.68568511e+06  2.01e-05 1.46e-11  1.69e+00     1s
  21   1.80791658e+06  1.75099981e+06  9.68e-06 2.91e-11  7.00e-01     1s
  22   1.79999518e+06  1.77372313e+06  5.14e-06 2.91e-11  3.23e-01     1s
  23   1.79811186e+06  1.78228821e+06  4.16e-06 2.91e-11  1.95e-01     1s
  24   1.79536683e+06  1.78311275e+06  2.78e-06 1.46e-11  1.51e-01     1s
  25   1.79250131e+06  1.78663367e+06  1.38e-06 1.46e-11  7.22e-02     1s
  26   1.79090848e+06  1.78822546e+06  6.24e-07 1.46e-11  3.30e-02     1s
  27   1.79053298e+06  1.78863451e+06  4.52e-07 2.91e-11  2.34e-02     1s
  28   1.79001924e+06  1.78900802e+06  2.23e-07 2.91e-11  1.24e-02     1s
  29   1.78987188e+06  1.78917060e+06  1.58e-07 2.91e-11  8.63e-03     1s
  30   1.78965619e+06  1.78935850e+06  6.40e-08 2.91e-11  3.66e-03     1s
  31   1.78960676e+06  1.78942605e+06  4.39e-08 2.91e-11  2.22e-03     1s
  32   1.78953963e+06  1.78946357e+06  2.92e-08 2.91e-11  9.36e-04     1s
  33   1.78951520e+06  1.78947731e+06  1.01e-07 2.91e-11  4.66e-04     2s
  34   1.78950586e+06  1.78948926e+06  1.74e-07 2.91e-11  2.04e-04     2s
  35   1.78950297e+06  1.78949402e+06  1.01e-07 2.91e-11  1.10e-04     2s
  36   1.78949889e+06  1.78949684e+06  3.26e-07 2.91e-11  2.52e-05     2s
  37   1.78949785e+06  1.78949763e+06  3.06e-08 2.91e-11  2.75e-06     2s
  38   1.78949772e+06  1.78949771e+06  3.92e-10 5.82e-11  1.82e-07     2s
  39   1.78949772e+06  1.78949772e+06  1.70e-09 5.82e-11  2.36e-08     2s
  40   1.78949772e+06  1.78949772e+06  5.76e-10 5.82e-11  2.59e-09     2s

Barrier solved model in 40 iterations and 1.74 seconds
Optimal objective 1.78949772e+06

Crossover log...

    1419 DPushes remaining with DInf 0.0000000e+00                 2s
       0 DPushes remaining with DInf 0.0000000e+00                 2s

     352 PPushes remaining with PInf 8.0000000e-06                 2s
       0 PPushes remaining with PInf 8.0000000e-06                 2s

  Push phase complete: Pinf 8.0000000e-06, Dinf 2.2709716e-10      2s

Iteration    Objective       Primal Inf.    Dual Inf.      Time
    1774    1.7894977e+06   7.000000e-06   0.000000e+00      2s
Extra simplex iterations after uncrush: 13
    1791    1.7894977e+06   0.000000e+00   0.000000e+00      2s

Solved with barrier
Solved in 1791 iterations and 2.26 seconds
Optimal objective  1.789497721e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 1.79e+06
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.78s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-dd7dbgan.lp
Reading time = 0.11 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0x757ddc8d
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [4e+00, 3e+01]
  RHS range        [9e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57051 rows and 22038 columns
Presolve time: 0.05s
Presolved: 3933 rows, 4819 columns, 23590 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.832e+04
 Factor NZ  : 6.468e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.207e+06 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   5.50688210e+07 -2.11224845e+09  2.00e+04 1.14e-13  9.12e+05     0s
   1   3.12692842e+07 -9.86580111e+08  2.22e+03 3.41e-13  1.54e+05     0s
   2   2.63119741e+07 -1.28604042e+08  2.34e+02 2.84e-13  1.82e+04     0s
   3   2.50497989e+07  1.14322429e+07  2.56e+01 1.13e-11  1.50e+03     0s
   4   2.46966641e+07  2.11262856e+07  3.73e+00 1.76e-12  3.76e+02     0s
   5   2.46246731e+07  2.30496974e+07  2.29e+00 8.24e-13  1.65e+02     0s
   6   2.45149387e+07  2.39157755e+07  9.13e-01 3.13e-13  6.25e+01     0s
   7   2.44307089e+07  2.41702706e+07  2.85e-01 1.71e-13  2.71e+01     0s
   8   2.43893703e+07  2.43282365e+07  3.38e-02 5.68e-14  6.35e+00     0s
   9   2.43826304e+07  2.43642811e+07  8.55e-03 6.19e-14  1.91e+00     0s
  10   2.43814353e+07  2.43801278e+07  8.56e-04 6.72e-14  1.36e-01     0s
  11   2.43811793e+07  2.43811665e+07  1.10e-05 1.14e-13  1.33e-03     0s
  12   2.43811753e+07  2.43811753e+07  2.41e-09 5.68e-14  1.33e-06     0s

Barrier performed 12 iterations in 0.20 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with primal simplex
Solved in 5431 iterations and 0.21 seconds
Optimal objective  2.438117532e+07
INFO:pypsa.linopf:Optimization successful. Objective value: 2.44e+07
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


load


add_BESS_load
300


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 2.83s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-gp5m9omk.lp
Reading time = 0.28 seconds
obj: 154248 rows, 73489 columns, 258595 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 154248 rows, 73489 columns and 258595 nonzeros
Model fingerprint: 0x7dd567a1
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [4e+00, 3e+01]
  RHS range        [9e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 142325 rows and 32319 columns
Presolve time: 0.12s
Presolved: 11923 rows, 41170 columns, 83770 nonzeros

Ordering time: 0.26s

Barrier statistics:
 AA' NZ     : 4.939e+04
 Factor NZ  : 7.391e+05 (roughly 30 MBytes of memory)
 Factor Ops : 1.386e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.24336954e+12 -1.99010623e+12  4.00e+04 9.40e+03  6.62e+08     0s
   1   2.95088968e+11 -1.12649625e+12  4.75e+03 5.11e+03  8.70e+07     1s
   2   3.08628370e+10 -2.85111587e+11  3.85e+02 2.04e-10  8.81e+06     1s
   3   9.06578256e+09 -3.89489745e+10  3.43e+01 2.21e-09  9.62e+05     1s
   4   3.82123581e+09 -1.32008453e+10  7.73e+00 4.66e-10  2.69e+05     1s
   5   1.65984823e+09 -5.78669926e+09  3.44e+00 1.59e-10  1.09e+05     1s
   6   3.49102798e+08 -2.44040016e+09  8.00e-01 1.59e-10  3.65e+04     1s
   7   1.65144818e+08 -6.41591389e+08  3.37e-01 1.59e-10  1.03e+04     1s
   8   1.08069362e+08 -3.22380084e+08  2.05e-01 1.30e-10  5.44e+03     1s
   9   6.47178369e+07 -2.07122121e+08  1.13e-01 1.01e-10  3.40e+03     1s
  10   5.28770479e+07 -1.30106354e+08  8.82e-02 1.01e-10  2.28e+03     1s
  11   3.12331785e+07 -5.55495076e+07  4.56e-02 1.30e-10  1.07e+03     1s
  12   2.04357829e+07 -2.67233466e+07  2.65e-02 1.01e-10  5.81e+02     1s
  13   8.98335301e+06 -1.09608566e+07  7.86e-03 7.15e-11  2.44e+02     1s
  14   6.29615297e+06 -4.96082272e+06  4.33e-03 5.70e-11  1.37e+02     1s
  15   4.22916413e+06 -1.01792513e+06  1.76e-03 3.51e-11  6.38e+01     1s
  16   3.48792113e+06  7.08924833e+05  9.21e-04 2.91e-11  3.38e+01     1s
  17   2.94955907e+06  1.66020381e+06  3.41e-04 2.91e-11  1.57e+01     1s
  18   2.65447670e+06  2.11552265e+06  4.71e-05 2.91e-11  6.55e+00     1s
  19   2.62096590e+06  2.36858379e+06  2.07e-05 2.91e-11  3.07e+00     1s
  20   2.59861106e+06  2.50363161e+06  7.52e-06 5.82e-11  1.15e+00     1s
  21   2.58735914e+06  2.54743982e+06  2.73e-06 2.91e-11  4.85e-01     1s
  22   2.58215371e+06  2.56056021e+06  9.83e-07 2.91e-11  2.62e-01     1s
  23   2.57979181e+06  2.57111912e+06  2.96e-07 2.91e-11  1.05e-01     1s
  24   2.57877583e+06  2.57610171e+06  9.04e-08 5.82e-11  3.25e-02     1s
  25   2.57850711e+06  2.57743497e+06  4.92e-08 2.91e-11  1.30e-02     1s
  26   2.57822314e+06  2.57785094e+06  3.47e-08 2.91e-11  4.52e-03     1s
  27   2.57819125e+06  2.57804866e+06  1.32e-08 2.91e-11  1.73e-03     1s
  28   2.57817649e+06  2.57813940e+06  1.28e-08 2.91e-11  4.50e-04     1s
  29   2.57817149e+06  2.57815710e+06  3.37e-08 2.91e-11  1.75e-04     1s
  30   2.57816849e+06  2.57816561e+06  3.96e-08 5.82e-11  3.50e-05     1s
  31   2.57816793e+06  2.57816726e+06  2.55e-07 5.82e-11  8.26e-06     1s
  32   2.57816776e+06  2.57816775e+06  1.00e-07 8.73e-11  9.04e-08     1s
  33   2.57816776e+06  2.57816776e+06  6.54e-08 5.82e-11  4.52e-13     1s

Barrier solved model in 33 iterations and 1.46 seconds
Optimal objective 2.57816776e+06

Crossover log...

    1385 DPushes remaining with DInf 0.0000000e+00                 1s
       0 DPushes remaining with DInf 0.0000000e+00                 2s

     155 PPushes remaining with PInf 0.0000000e+00                 2s
       0 PPushes remaining with PInf 0.0000000e+00                 2s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.5744852e-10      2s

Iteration    Objective       Primal Inf.    Dual Inf.      Time
    1543    2.5781678e+06   0.000000e+00   0.000000e+00      2s

Solved with barrier
Solved in 1543 iterations and 1.61 seconds
Optimal objective  2.578167759e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 2.58e+06
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.78s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-1tnsdjbw.lp
Reading time = 0.11 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0x0db93897
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [4e+00, 3e+01]
  RHS range        [8e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57048 rows and 22036 columns
Presolve time: 0.05s
Presolved: 3936 rows, 4821 columns, 23595 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.833e+04
 Factor NZ  : 6.453e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.199e+06 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   5.74986106e+07 -2.10928108e+09  2.04e+04 1.14e-13  9.28e+05     0s
   1   3.34509793e+07 -9.96564367e+08  2.07e+03 2.84e-13  1.53e+05     0s
   2   2.87338390e+07 -1.30254293e+08  2.28e+02 2.84e-13  1.86e+04     0s
   3   2.71837362e+07  5.56209806e+06  2.22e+01 1.51e-11  2.33e+03     0s
   4   2.68426091e+07  2.18305929e+07  2.80e+00 3.78e-12  5.24e+02     0s
   5   2.66762523e+07  2.49570006e+07  1.02e+00 1.17e-12  1.79e+02     0s
   6   2.65539676e+07  2.60582068e+07  2.74e-01 3.12e-13  5.15e+01     0s
   7   2.65205528e+07  2.63430840e+07  7.26e-02 9.77e-14  1.84e+01     0s
   8   2.65098486e+07  2.64828116e+07  4.93e-03 5.95e-14  2.80e+00     0s
   9   2.65087696e+07  2.65078701e+07  4.29e-04 6.49e-14  9.34e-02     0s

Barrier performed 9 iterations in 0.20 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with primal simplex
Solved in 5212 iterations and 0.20 seconds
Optimal objective  2.650861745e+07
INFO:pypsa.linopf:Optimization successful. Objective value: 2.65e+07
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


load


add_BESS_load
300


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 2.8s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-wwmf4a0j.lp
Reading time = 0.28 seconds
obj: 154248 rows, 73489 columns, 258595 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 154248 rows, 73489 columns and 258595 nonzeros
Model fingerprint: 0xd1f4cf02
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [4e+00, 3e+01]
  RHS range        [8e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 142325 rows and 32423 columns
Presolve time: 0.13s
Presolved: 11923 rows, 41066 columns, 83666 nonzeros

Ordering time: 0.30s

Barrier statistics:
 AA' NZ     : 4.939e+04
 Factor NZ  : 7.210e+05 (roughly 27 MBytes of memory)
 Factor Ops : 1.283e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.73085495e+12 -2.00052502e+12  5.67e+04 9.64e+03  9.27e+08     1s
   1   3.95591134e+11 -1.20864466e+12  6.39e+03 4.58e+02  1.14e+08     1s
   2   3.39318875e+10 -3.84943135e+11  4.49e+02 2.33e-10  1.10e+07     1s
   3   9.61191856e+09 -4.60399178e+10  4.56e+01 4.83e-09  1.19e+06     1s
   4   4.85880734e+09 -1.56604971e+10  1.53e+01 1.19e-09  3.84e+05     1s
   5   1.93908908e+09 -5.48304924e+09  6.50e+00 2.47e-10  1.29e+05     1s
   6   4.04379648e+08 -2.07853308e+09  1.45e+00 1.88e-10  3.56e+04     1s
   7   3.74519977e+07 -7.50339866e+08  3.41e-02 1.30e-10  9.67e+03     1s
   8   2.84031433e+07 -3.43881913e+08  1.81e-02 1.01e-10  4.55e+03     1s
   9   1.97511559e+07 -1.53359903e+08  8.64e-03 1.01e-10  2.11e+03     1s
  10   1.42292520e+07 -8.23017677e+07  5.04e-03 7.15e-11  1.18e+03     1s
  11   8.30980345e+06 -4.54654713e+07  1.67e-03 7.15e-11  6.55e+02     1s
  12   5.68964022e+06 -1.90478045e+07  8.01e-04 5.70e-11  3.01e+02     1s
  13   3.29605729e+06 -5.41557641e+06  1.87e-04 4.24e-11  1.06e+02     1s
  14   2.73951823e+06 -2.01413771e+06  1.10e-04 2.91e-11  5.79e+01     1s
  15   2.21194751e+06  2.16834593e+05  4.68e-05 2.18e-11  2.43e+01     1s
  16   2.09605479e+06  8.07881258e+05  3.49e-05 2.91e-11  1.57e+01     1s
  17   1.94953530e+06  1.23232443e+06  2.09e-05 2.91e-11  8.73e+00     1s
  18   1.80704859e+06  1.50799091e+06  7.91e-06 2.91e-11  3.64e+00     1s
  19   1.74484357e+06  1.61681416e+06  2.88e-06 2.91e-11  1.56e+00     1s
  20   1.73429664e+06  1.65687241e+06  2.14e-06 2.91e-11  9.43e-01     1s
  21   1.71565736e+06  1.68273616e+06  9.01e-07 1.46e-11  4.01e-01     1s
  22   1.70622750e+06  1.69320910e+06  3.36e-07 1.46e-11  1.59e-01     1s
  23   1.70188109e+06  1.69765777e+06  9.75e-08 1.46e-11  5.14e-02     1s
  24   1.70073843e+06  1.69943295e+06  3.84e-08 2.91e-11  1.59e-02     1s
  25   1.70025914e+06  1.69970433e+06  1.52e-08 2.91e-11  6.76e-03     1s
  26   1.70001067e+06  1.69989111e+06  7.99e-09 5.82e-11  1.46e-03     1s
  27   1.69997974e+06  1.69992946e+06  1.20e-08 2.91e-11  6.12e-04     1s
  28   1.69995922e+06  1.69994655e+06  3.05e-08 5.82e-11  1.54e-04     1s
  29   1.69995489e+06  1.69995130e+06  3.28e-08 2.91e-11  4.36e-05     1s
  30   1.69995285e+06  1.69995259e+06  1.60e-09 5.82e-11  3.20e-06     1s
  31   1.69995279e+06  1.69995272e+06  9.72e-10 5.82e-11  7.37e-07     1s
  32   1.69995275e+06  1.69995274e+06  2.43e-09 5.82e-11  1.54e-07     1s
  33   1.69995274e+06  1.69995274e+06  8.30e-10 5.82e-11  1.80e-08     1s
  34   1.69995274e+06  1.69995274e+06  9.45e-09 5.82e-11  9.65e-10     1s

Barrier solved model in 34 iterations and 1.47 seconds
Optimal objective 1.69995274e+06

Crossover log...

    1151 DPushes remaining with DInf 0.0000000e+00                 2s
       0 DPushes remaining with DInf 0.0000000e+00                 2s

     270 PPushes remaining with PInf 1.3000000e-05                 2s
       0 PPushes remaining with PInf 1.3000000e-05                 2s

  Push phase complete: Pinf 1.3000000e-05, Dinf 3.1688785e-10      2s

Iteration    Objective       Primal Inf.    Dual Inf.      Time
    1424    1.6999527e+06   2.000000e-06   0.000000e+00      2s
Extra simplex iterations after uncrush: 30
    1456    1.6999527e+06   0.000000e+00   0.000000e+00      2s

Solved with barrier
Solved in 1456 iterations and 1.83 seconds
Optimal objective  1.699952742e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 1.70e+06
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.78s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-f4ypxec7.lp
Reading time = 0.11 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0xa0b5ff0a
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [4e+00, 3e+01]
  RHS range        [8e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57048 rows and 22035 columns
Presolve time: 0.05s
Presolved: 3936 rows, 4822 columns, 23596 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.833e+04
 Factor NZ  : 6.453e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.199e+06 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   3.96105339e+07 -2.05309139e+09  1.98e+04 5.68e-14  8.77e+05     0s
   1   2.32574036e+07 -9.55863573e+08  1.97e+03 3.41e-13  1.43e+05     0s
   2   2.10047189e+07 -1.23835561e+08  2.07e+02 2.27e-13  1.68e+04     0s
   3   2.00397849e+07  1.06250885e+07  2.28e+01 4.66e-12  1.05e+03     0s
   4   1.96285582e+07  1.56578509e+07  3.91e+00 2.73e-12  4.18e+02     0s
   5   1.95270163e+07  1.77400148e+07  2.08e+00 1.08e-12  1.87e+02     0s
   6   1.94084980e+07  1.87755978e+07  6.19e-01 5.68e-13  6.59e+01     0s
   7   1.93469234e+07  1.90760459e+07  2.56e-01 1.71e-13  2.81e+01     0s
   8   1.93034851e+07  1.92088456e+07  5.13e-02 5.68e-14  9.82e+00     0s
   9   1.92905780e+07  1.92567685e+07  1.55e-02 5.68e-14  3.51e+00     0s

Barrier performed 9 iterations in 0.18 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with primal simplex
Solved in 4742 iterations and 0.18 seconds
Optimal objective  1.928384494e+07
INFO:pypsa.linopf:Optimization successful. Objective value: 1.93e+07
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


load


add_BESS_load
300


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 2.78s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-ccl7vhd_.lp
Reading time = 0.28 seconds
obj: 154248 rows, 73489 columns, 258595 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 154248 rows, 73489 columns and 258595 nonzeros
Model fingerprint: 0x1f4b5dad
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [4e+00, 3e+01]
  RHS range        [1e-06, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 142324 rows and 33538 columns
Presolve time: 0.13s
Presolved: 11924 rows, 39951 columns, 82552 nonzeros

Ordering time: 0.31s

Barrier statistics:
 AA' NZ     : 4.939e+04
 Factor NZ  : 7.150e+05 (roughly 27 MBytes of memory)
 Factor Ops : 1.215e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.73060499e+12 -2.05160370e+12  5.67e+04 1.13e+04  9.39e+08     1s
   1   3.85400898e+11 -1.21861945e+12  6.43e+03 2.17e-10  1.16e+08     1s
   2   3.20685235e+10 -3.87649089e+11  4.41e+02 1.75e-10  1.11e+07     1s
   3   9.11982647e+09 -4.57819345e+10  4.96e+01 2.15e-10  1.25e+06     1s
   4   5.85207195e+09 -1.58686067e+10  1.85e+01 3.49e-10  4.36e+05     1s
   5   2.95921441e+09 -7.77944975e+09  9.76e+00 3.49e-10  2.01e+05     1s
   6   5.14151861e+08 -2.38554431e+09  2.02e+00 2.17e-10  4.48e+04     1s
   7   3.04243822e+07 -6.56838617e+08  1.57e-02 1.59e-10  8.64e+03     1s
   8   2.46972915e+07 -2.98201036e+08  8.81e-03 1.30e-10  4.05e+03     1s
   9   1.59518633e+07 -1.35394282e+08  2.64e-03 1.30e-10  1.90e+03     1s
  10   1.10812989e+07 -4.92987664e+07  1.15e-03 1.01e-10  7.56e+02     1s
  11   5.64047146e+06 -1.68262440e+07  1.72e-04 5.70e-11  2.81e+02     1s
  12   4.35038240e+06 -7.03804542e+06  8.16e-05 3.51e-11  1.43e+02     1s
  13   3.43788185e+06 -1.77089352e+06  2.97e-05 2.91e-11  6.52e+01     1s
  14   3.19344348e+06 -9.08542929e+04  1.95e-05 5.82e-11  4.11e+01     1s
  15   2.79514354e+06  1.02057504e+06  4.78e-06 2.91e-11  2.22e+01     1s
  16   2.71144741e+06  1.68171371e+06  2.60e-06 2.91e-11  1.29e+01     1s
  17   2.64153452e+06  2.12364371e+06  1.03e-06 2.91e-11  6.48e+00     1s
  18   2.60067903e+06  2.36841293e+06  3.09e-07 1.46e-11  2.91e+00     1s
  19   2.58032621e+06  2.49212165e+06  6.58e-08 2.91e-11  1.10e+00     1s
  20   2.57364914e+06  2.53842700e+06  2.69e-08 2.91e-11  4.41e-01     1s
  21   2.56910624e+06  2.55156312e+06  9.16e-09 1.46e-11  2.20e-01     1s
  22   2.56788312e+06  2.56007493e+06  5.51e-09 1.46e-11  9.77e-02     1s
  23   2.56685496e+06  2.56353195e+06  1.74e-08 2.91e-11  4.16e-02     1s
  24   2.56614373e+06  2.56446725e+06  3.31e-08 1.46e-11  2.10e-02     1s
  25   2.56603049e+06  2.56537001e+06  1.38e-08 5.82e-11  8.27e-03     1s
  26   2.56595375e+06  2.56579667e+06  5.04e-09 5.82e-11  1.97e-03     1s
  27   2.56592798e+06  2.56587562e+06  7.80e-10 2.91e-11  6.55e-04     1s
  28   2.56591355e+06  2.56590379e+06  1.36e-09 5.82e-11  1.22e-04     1s
  29   2.56591240e+06  2.56591058e+06  1.92e-09 2.91e-11  2.29e-05     1s
  30   2.56591212e+06  2.56591199e+06  1.13e-09 5.82e-11  1.66e-06     1s
  31   2.56591210e+06  2.56591210e+06  1.57e-09 8.73e-11  6.21e-08     1s
  32   2.56591210e+06  2.56591210e+06  9.32e-09 8.73e-11  2.01e-09     1s

Barrier solved model in 32 iterations and 1.44 seconds
Optimal objective 2.56591210e+06

Crossover log...

    1173 DPushes remaining with DInf 0.0000000e+00                 2s
       0 DPushes remaining with DInf 0.0000000e+00                 2s

     157 PPushes remaining with PInf 0.0000000e+00                 2s
       0 PPushes remaining with PInf 0.0000000e+00                 2s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.0603695e-09      2s

Iteration    Objective       Primal Inf.    Dual Inf.      Time
    1333    2.5659121e+06   0.000000e+00   0.000000e+00      2s

Solved with barrier
Solved in 1333 iterations and 1.90 seconds
Optimal objective  2.565912098e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 2.57e+06
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.77s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-pywmm_7y.lp
Reading time = 0.11 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0xca2dc6bc
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [2e+00, 2e+01]
  RHS range        [5e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57048 rows and 22024 columns
Presolve time: 0.05s
Presolved: 3936 rows, 4833 columns, 23607 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.833e+04
 Factor NZ  : 6.453e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.199e+06 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   4.27100054e+07 -2.03386105e+09  2.12e+04 5.68e-14  9.14e+05     0s
   1   2.22288074e+07 -9.87856546e+08  2.37e+03 2.84e-13  1.55e+05     0s
   2   1.90260702e+07 -1.30799869e+08  2.05e+02 1.25e-12  1.73e+04     0s
   3   1.77634448e+07  6.21540710e+06  2.15e+01 5.91e-12  1.27e+03     0s
   4   1.73973721e+07  1.55092285e+07  4.48e+00 7.39e-13  2.00e+02     0s

Barrier performed 4 iterations in 0.19 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with primal simplex
Solved in 5369 iterations and 0.19 seconds
Optimal objective  1.718063102e+07
INFO:pypsa.linopf:Optimization successful. Objective value: 1.72e+07
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


load


add_BESS_load
300


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 2.8s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-1vz7qcwu.lp
Reading time = 0.28 seconds
obj: 154248 rows, 73489 columns, 258595 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 154248 rows, 73489 columns and 258595 nonzeros
Model fingerprint: 0x883db75e
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [2e+00, 2e+01]
  RHS range        [5e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 142320 rows and 33071 columns
Presolve time: 0.13s
Presolved: 11928 rows, 40418 columns, 83023 nonzeros

Ordering time: 0.31s

Barrier statistics:
 AA' NZ     : 4.940e+04
 Factor NZ  : 7.082e+05 (roughly 27 MBytes of memory)
 Factor Ops : 1.222e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.74055307e+12 -2.04340297e+12  5.31e+04 1.11e+04  9.30e+08     1s
   1   3.86020456e+11 -1.20296613e+12  5.78e+03 3.04e+02  1.11e+08     1s
   2   3.31905096e+10 -3.70663701e+11  4.20e+02 1.75e-10  1.09e+07     1s
   3   9.02966916e+09 -4.37958989e+10  4.65e+01 5.82e-10  1.22e+06     1s
   4   6.00377973e+09 -1.64977548e+10  1.86e+01 4.66e-10  4.58e+05     1s
   5   3.62547372e+09 -8.23623134e+09  1.16e+01 1.59e-10  2.37e+05     1s
   6   8.94332758e+08 -2.52502285e+09  3.19e+00 1.88e-10  5.83e+04     1s
   7   3.63373217e+07 -7.89135601e+08  3.52e-02 1.85e-10  1.03e+04     1s
   8   2.92047538e+07 -3.72090920e+08  2.24e-02 1.30e-10  5.00e+03     1s
   9   2.04351406e+07 -1.67881921e+08  1.13e-02 1.30e-10  2.34e+03     1s
  10   1.36012222e+07 -7.47488147e+07  5.28e-03 1.30e-10  1.10e+03     1s
  11   7.87199513e+06 -2.63303088e+07  1.85e-03 1.01e-10  4.24e+02     1s
  12   5.64608271e+06 -9.95141108e+06  1.00e-03 5.70e-11  1.93e+02     1s
  13   4.29419986e+06 -4.03484978e+06  5.62e-04 3.51e-11  1.03e+02     1s
  14   3.76481058e+06 -1.77136813e+06  4.09e-04 2.06e-11  6.85e+01     1s
  15   3.24786765e+06 -3.52354854e+05  2.73e-04 1.69e-11  4.45e+01     1s
  16   3.01671487e+06  9.99613356e+05  2.14e-04 2.91e-11  2.50e+01     1s
  17   2.57013826e+06  1.52702322e+06  1.08e-04 1.46e-11  1.29e+01     1s
  18   2.38193707e+06  1.73703135e+06  7.07e-05 1.46e-11  7.98e+00     1s
  19   2.25885443e+06  1.88656526e+06  4.18e-05 2.91e-11  4.61e+00     1s
  20   2.21114945e+06  1.96942895e+06  3.11e-05 1.46e-11  2.99e+00     1s
  21   2.17982940e+06  1.99804916e+06  2.43e-05 1.46e-11  2.25e+00     1s
  22   2.15793859e+06  2.01951102e+06  1.95e-05 1.46e-11  1.71e+00     1s
  23   2.14009854e+06  2.03167044e+06  1.56e-05 1.46e-11  1.34e+00     1s
  24   2.12722540e+06  2.04450867e+06  1.29e-05 1.46e-11  1.02e+00     1s
  25   2.11262323e+06  2.05199661e+06  9.80e-06 1.46e-11  7.50e-01     1s
  26   2.09014844e+06  2.05791804e+06  5.17e-06 1.46e-11  3.99e-01     1s
  27   2.07835254e+06  2.06142901e+06  2.77e-06 2.18e-11  2.09e-01     1s
  28   2.07554581e+06  2.06261249e+06  2.22e-06 2.91e-11  1.60e-01     1s
  29   2.07309811e+06  2.06332670e+06  1.74e-06 2.91e-11  1.21e-01     1s
  30   2.06867441e+06  2.06355975e+06  8.75e-07 2.91e-11  6.33e-02     1s
  31   2.06592732e+06  2.06388797e+06  3.43e-07 2.91e-11  2.52e-02     1s
  32   2.06473003e+06  2.06405396e+06  1.15e-07 5.82e-11  8.36e-03     1s
  33   2.06470988e+06  2.06406851e+06  1.11e-07 5.82e-11  7.93e-03     2s
  34   2.06461270e+06  2.06407940e+06  9.52e-08 5.82e-11  6.60e-03     2s
  35   2.06456188e+06  2.06408207e+06  8.63e-08 5.82e-11  5.94e-03     2s
  36   2.06416244e+06  2.06411063e+06  3.24e-08 5.82e-11  6.41e-04     2s
  37   2.06412052e+06  2.06411833e+06  1.90e-08 5.82e-11  2.71e-05     2s
  38   2.06411974e+06  2.06411958e+06  2.37e-08 5.82e-11  2.00e-06     2s
  39   2.06411963e+06  2.06411962e+06  1.76e-09 5.82e-11  1.77e-07     2s
  40   2.06411963e+06  2.06411962e+06  1.33e-09 5.82e-11  3.88e-08     2s
  41   2.06411962e+06  2.06411962e+06  4.85e-09 5.82e-11  1.11e-08     2s
  42   2.06411962e+06  2.06411962e+06  2.12e-07 5.82e-11  1.82e-09     2s

Barrier solved model in 42 iterations and 1.81 seconds
Optimal objective 2.06411962e+06

Crossover log...

    1707 DPushes remaining with DInf 0.0000000e+00                 2s
       0 DPushes remaining with DInf 0.0000000e+00                 2s

     443 PPushes remaining with PInf 8.1092550e-06                 2s
       0 PPushes remaining with PInf 1.8000000e-05                 2s

  Push phase complete: Pinf 1.8000000e-05, Dinf 8.3605148e-10      2s

Iteration    Objective       Primal Inf.    Dual Inf.      Time
    2153    2.0641196e+06   1.800000e-05   0.000000e+00      2s

Solved with dual simplex
Solved in 11335 iterations and 2.40 seconds
Optimal objective  2.064119622e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 2.06e+06
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.75s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-7nfub_te.lp
Reading time = 0.11 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0xad027c9c
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [2e+00, 1e+01]
  RHS range        [4e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57051 rows and 22038 columns
Presolve time: 0.05s
Presolved: 3933 rows, 4819 columns, 23590 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.832e+04
 Factor NZ  : 6.468e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.207e+06 (less than 1 second per iteration)
 Threads    : 30

Barrier performed 0 iterations in 0.27 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with primal simplex
Solved in 5488 iterations and 0.27 seconds
Optimal objective  2.482551742e+07
INFO:pypsa.linopf:Optimization successful. Objective value: 2.48e+07
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


load


add_BESS_load
300


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 2.81s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-nk1o23co.lp
Reading time = 0.28 seconds
obj: 154248 rows, 73489 columns, 258595 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 154248 rows, 73489 columns and 258595 nonzeros
Model fingerprint: 0xda133b39
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [2e+00, 1e+01]
  RHS range        [4e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 142323 rows and 33062 columns
Presolve time: 0.14s
Presolved: 11925 rows, 40427 columns, 83029 nonzeros

Ordering time: 0.24s

Barrier statistics:
 AA' NZ     : 4.939e+04
 Factor NZ  : 7.270e+05 (roughly 27 MBytes of memory)
 Factor Ops : 1.310e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.72605078e+12 -2.00770900e+12  5.68e+04 2.33e-11  9.65e+08     1s
   1   3.70150587e+11 -1.24230493e+12  5.57e+03 2.11e-10  1.06e+08     1s
   2   3.44907625e+10 -3.75160734e+11  4.23e+02 2.04e-10  1.09e+07     1s
   3   9.94021556e+09 -5.38233797e+10  3.84e+01 5.06e-09  1.24e+06     1s
   4   6.65830203e+09 -1.90229426e+10  1.08e+01 1.40e-09  4.15e+05     1s
   5   2.63872865e+09 -7.42084574e+09  4.50e+00 9.31e-10  1.54e+05     1s
   6   4.50427981e+08 -2.88093728e+09  9.30e-01 1.05e-09  4.50e+04     1s
   7   1.89811813e+08 -7.99991571e+08  3.90e-01 3.20e-10  1.30e+04     1s
   8   5.15665665e+07 -3.63271839e+08  7.05e-02 1.46e-10  5.22e+03     1s
   9   3.16685518e+07 -1.74773105e+08  3.34e-02 1.59e-10  2.58e+03     1s
  10   2.57103740e+07 -8.56457071e+07  2.46e-02 1.01e-10  1.39e+03     1s
  11   1.74913363e+07 -4.04920036e+07  1.38e-02 1.01e-10  7.23e+02     1s
  12   1.27894517e+07 -1.94244318e+07  8.76e-03 1.30e-10  4.01e+02     1s
  13   6.37689463e+06 -7.88006359e+06  2.37e-03 1.01e-10  1.77e+02     1s
  14   4.94330947e+06 -2.75517636e+06  1.32e-03 7.15e-11  9.54e+01     1s
  15   3.84066495e+06 -2.85482444e+05  5.82e-04 5.82e-11  5.11e+01     1s
  16   3.47085882e+06  1.00115272e+06  3.60e-04 5.82e-11  3.06e+01     1s
  17   3.11363313e+06  1.74707111e+06  1.61e-04 2.91e-11  1.69e+01     1s
  18   2.95529499e+06  2.36036785e+06  7.89e-05 2.91e-11  7.36e+00     1s
  19   2.87135425e+06  2.55718541e+06  3.94e-05 2.91e-11  3.89e+00     1s
  20   2.83680154e+06  2.63310517e+06  2.43e-05 2.91e-11  2.52e+00     1s
  21   2.81042517e+06  2.69441775e+06  1.33e-05 2.91e-11  1.43e+00     1s
  22   2.78911540e+06  2.71611034e+06  5.06e-06 2.91e-11  9.03e-01     1s
  23   2.78622793e+06  2.74295807e+06  4.05e-06 2.91e-11  5.35e-01     1s
  24   2.77841261e+06  2.75268436e+06  1.43e-06 5.82e-11  3.18e-01     1s
  25   2.77605055e+06  2.76379060e+06  7.43e-07 2.91e-11  1.52e-01     1s
  26   2.77433863e+06  2.76915586e+06  3.08e-07 2.91e-11  6.41e-02     1s
  27   2.77378407e+06  2.77123917e+06  1.79e-07 5.82e-11  3.15e-02     1s
  28   2.77318389e+06  2.77228988e+06  4.93e-08 2.91e-11  1.11e-02     1s
  29   2.77303152e+06  2.77264097e+06  2.01e-08 5.82e-11  4.83e-03     1s
  30   2.77295770e+06  2.77282797e+06  1.10e-08 5.82e-11  1.60e-03     1s
  31   2.77293572e+06  2.77289168e+06  9.53e-09 5.82e-11  5.45e-04     1s
  32   2.77292336e+06  2.77291576e+06  1.53e-08 8.73e-11  9.41e-05     1s
  33   2.77292265e+06  2.77292095e+06  2.05e-09 5.82e-11  2.10e-05     1s
  34   2.77292250e+06  2.77292244e+06  8.02e-09 5.82e-11  7.49e-07     2s
  35   2.77292248e+06  2.77292248e+06  4.37e-10 5.82e-11  4.73e-08     2s
  36   2.77292248e+06  2.77292248e+06  3.42e-09 8.73e-11  1.04e-08     2s
  37   2.77292248e+06  2.77292248e+06  9.38e-10 8.73e-11  2.67e-09     2s

Barrier solved model in 37 iterations and 1.61 seconds
Optimal objective 2.77292248e+06

Crossover log...

    1815 DPushes remaining with DInf 0.0000000e+00                 2s
       0 DPushes remaining with DInf 0.0000000e+00                 2s

     293 PPushes remaining with PInf 7.0000000e-06                 2s
       0 PPushes remaining with PInf 7.0000000e-06                 2s

  Push phase complete: Pinf 7.0000000e-06, Dinf 3.8452519e-10      2s

Iteration    Objective       Primal Inf.    Dual Inf.      Time
    2111    2.7729225e+06   1.000000e-06   0.000000e+00      2s
Extra simplex iterations after uncrush: 23
    2135    2.7729225e+06   0.000000e+00   0.000000e+00      2s

Solved with barrier
Solved in 2135 iterations and 2.17 seconds
Optimal objective  2.772922479e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 2.77e+06
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.78s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-kzew52__.lp
Reading time = 0.11 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0x46c03c90
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [2e+00, 1e+01]
  RHS range        [4e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57048 rows and 22034 columns
Presolve time: 0.05s
Presolved: 3936 rows, 4823 columns, 23597 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.833e+04
 Factor NZ  : 6.453e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.199e+06 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   4.83416065e+07 -1.97648205e+09  2.01e+04 4.95e+00  8.57e+05     0s
   1   2.70857859e+07 -9.28773195e+08  2.31e+03 3.41e-13  1.47e+05     0s
   2   2.30563216e+07 -1.34258110e+08  2.45e+02 6.65e-12  1.84e+04     0s
   3   2.19476237e+07  1.08192489e+07  3.13e+01 4.55e-13  1.26e+03     0s
   4   2.15391594e+07  1.82084966e+07  6.06e+00 3.98e-13  3.54e+02     0s
   5   2.14225976e+07  1.98711959e+07  3.12e+00 4.26e-13  1.63e+02     0s
   6   2.13544882e+07  2.05997646e+07  2.08e+00 1.99e-13  7.91e+01     0s
   7   2.13102417e+07  2.07911187e+07  1.59e+00 1.28e-13  5.43e+01     0s
   8   2.11816657e+07  2.09961785e+07  2.28e-01 5.68e-14  1.93e+01     0s
   9   2.11575883e+07  2.10739473e+07  8.18e-02 5.68e-14  8.69e+00     0s
  10   2.11428984e+07  2.11245344e+07  5.58e-03 5.68e-14  1.90e+00     0s
  11   2.11412531e+07  2.11379973e+07  1.08e-03 5.68e-14  3.38e-01     0s
  12   2.11407861e+07  2.11407220e+07  1.60e-06 5.68e-14  6.64e-03     0s
  13   2.11407796e+07  2.11407796e+07  3.64e-12 1.14e-13  6.66e-06     0s

Barrier performed 13 iterations in 0.20 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with primal simplex
Solved in 5340 iterations and 0.20 seconds
Optimal objective  2.114077964e+07
INFO:pypsa.linopf:Optimization successful. Objective value: 2.11e+07
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


load


add_BESS_load
300


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 2.79s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-n6wlds52.lp
Reading time = 0.29 seconds
obj: 154248 rows, 73489 columns, 258595 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 154248 rows, 73489 columns and 258595 nonzeros
Model fingerprint: 0x47db31dd
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [2e+00, 1e+01]
  RHS range        [1e-06, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 142325 rows and 32778 columns
Presolve time: 0.15s
Presolved: 11923 rows, 40711 columns, 83311 nonzeros

Ordering time: 0.31s

Barrier statistics:
 AA' NZ     : 4.939e+04
 Factor NZ  : 7.197e+05 (roughly 27 MBytes of memory)
 Factor Ops : 1.256e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.73081050e+12 -2.01496103e+12  5.67e+04 1.13e+04  9.27e+08     1s
   1   3.83921875e+11 -1.20456089e+12  6.07e+03 2.17e-10  1.09e+08     1s
   2   3.41021843e+10 -3.71927899e+11  4.43e+02 1.88e-10  1.08e+07     1s
   3   9.89650041e+09 -4.59175793e+10  5.13e+01 3.49e-10  1.25e+06     1s
   4   4.88752815e+09 -1.65380003e+10  1.67e+01 1.59e-10  4.08e+05     1s
   5   2.13508252e+09 -5.61122883e+09  7.63e+00 9.60e-10  1.41e+05     1s
   6   3.97270791e+08 -2.23265770e+09  1.57e+00 3.06e-10  3.84e+04     1s
   7   2.17773402e+08 -6.50352768e+08  7.96e-01 1.59e-10  1.23e+04     1s
   8   1.20272664e+08 -3.64699530e+08  4.06e-01 1.88e-10  6.56e+03     1s
   9   5.48745708e+07 -1.70674764e+08  1.60e-01 1.30e-10  2.94e+03     1s
  10   3.34540310e+07 -1.15223851e+08  8.62e-02 1.01e-10  1.90e+03     1s
  11   1.28239948e+07 -4.80102174e+07  1.83e-02 1.30e-10  7.58e+02     1s
  12   8.55891008e+06 -2.66694085e+07  8.93e-03 1.01e-10  4.37e+02     1s
  13   5.92252899e+06 -7.91953116e+06  4.09e-03 1.01e-10  1.71e+02     1s
  14   4.31185327e+06 -2.23378377e+06  1.70e-03 8.61e-11  8.06e+01     1s
  15   3.36785672e+06  9.97646594e+05  5.05e-04 4.24e-11  2.91e+01     1s
  16   3.09708247e+06  2.05810722e+06  2.22e-04 2.79e-11  1.28e+01     1s
  17   2.94455523e+06  2.51492041e+06  8.54e-05 2.18e-11  5.28e+00     1s
  18   2.85059735e+06  2.71406510e+06  1.38e-05 2.18e-11  1.68e+00     1s
  19   2.82990894e+06  2.80055315e+06  3.58e-06 2.91e-11  3.61e-01     1s
  20   2.82398967e+06  2.81174339e+06  1.61e-06 1.46e-11  1.50e-01     1s
  21   2.82132949e+06  2.81564225e+06  8.17e-07 2.91e-11  6.99e-02     1s
  22   2.81976876e+06  2.81720452e+06  3.72e-07 5.82e-11  3.15e-02     1s
  23   2.81895579e+06  2.81789415e+06  1.47e-07 2.91e-11  1.30e-02     2s
  24   2.81852914e+06  2.81814514e+06  3.21e-08 5.82e-11  4.72e-03     2s
  25   2.81844967e+06  2.81831980e+06  1.13e-08 5.82e-11  1.60e-03     2s
  26   2.81841098e+06  2.81839316e+06  3.07e-09 8.73e-11  2.19e-04     2s
  27   2.81840228e+06  2.81839853e+06  6.40e-10 5.82e-11  4.60e-05     2s
  28   2.81840000e+06  2.81839969e+06  1.64e-09 5.82e-11  3.73e-06     2s
  29   2.81839987e+06  2.81839986e+06  1.68e-09 5.82e-11  1.40e-07     2s
  30   2.81839987e+06  2.81839986e+06  9.96e-09 5.82e-11  1.65e-08     2s
  31   2.81839986e+06  2.81839986e+06  1.87e-07 5.82e-11  4.40e-09     2s

Barrier solved model in 31 iterations and 1.81 seconds
Optimal objective 2.81839986e+06

Crossover log...

    1448 DPushes remaining with DInf 0.0000000e+00                 2s
       0 DPushes remaining with DInf 0.0000000e+00                 2s

     161 PPushes remaining with PInf 5.0000000e-06                 2s
       0 PPushes remaining with PInf 6.0000000e-06                 2s

  Push phase complete: Pinf 6.0000000e-06, Dinf 4.0036101e-10      2s

Iteration    Objective       Primal Inf.    Dual Inf.      Time
    1612    2.8183999e+06   4.000000e-06   0.000000e+00      2s
Extra simplex iterations after uncrush: 9
    1623    2.8183999e+06   0.000000e+00   0.000000e+00      2s

Solved with barrier
Solved in 1623 iterations and 2.20 seconds
Optimal objective  2.818399864e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 2.82e+06
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.78s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-u84wepz2.lp
Reading time = 0.11 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0x35f06e70
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [2e+00, 1e+01]
  RHS range        [4e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57050 rows and 22031 columns
Presolve time: 0.05s
Presolved: 3934 rows, 4826 columns, 23598 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.832e+04
 Factor NZ  : 6.450e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.199e+06 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   4.74154886e+07 -1.98700481e+09  2.10e+04 1.14e-13  8.89e+05     0s
   1   2.53782182e+07 -9.59174134e+08  2.62e+03 2.84e-13  1.57e+05     0s
   2   2.10460483e+07 -1.40351212e+08  2.20e+02 2.27e-13  1.87e+04     0s
   3   1.99925255e+07  6.03923738e+06  2.39e+01 8.53e-13  1.53e+03     0s
   4   1.96205100e+07  1.64813127e+07  4.26e+00 5.68e-13  3.30e+02     0s
   5   1.94667117e+07  1.85301773e+07  1.28e+00 2.84e-13  9.77e+01     0s
   6   1.94152594e+07  1.91328765e+07  5.98e-01 1.14e-13  2.94e+01     0s
   7   1.93854290e+07  1.93106478e+07  2.23e-01 5.68e-14  7.79e+00     0s
   8   1.93713189e+07  1.93599268e+07  2.29e-02 1.14e-13  1.18e+00     0s
   9   1.93699088e+07  1.93690600e+07  5.93e-03 5.68e-14  8.89e-02     0s
  10   1.93694068e+07  1.93694032e+07  9.32e-11 5.68e-14  3.78e-04     0s
  11   1.93694061e+07  1.93694061e+07  1.60e-10 5.80e-14  2.74e-09     0s

Barrier solved model in 11 iterations and 0.18 seconds
Optimal objective 1.93694061e+07

Crossover log...

       1 DPushes remaining with DInf 0.0000000e+00                 0s
       0 DPushes remaining with DInf 0.0000000e+00                 0s

     340 PPushes remaining with PInf 0.0000000e+00                 0s

Solved with primal simplex
Solved in 5403 iterations and 0.20 seconds
Optimal objective  1.936940606e+07
INFO:pypsa.linopf:Optimization successful. Objective value: 1.94e+07
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


load


add_BESS_load
300


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 2.79s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-jl5j46x9.lp
Reading time = 0.28 seconds
obj: 154248 rows, 73489 columns, 258595 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 154248 rows, 73489 columns and 258595 nonzeros
Model fingerprint: 0x23a297df
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [2e+00, 1e+01]
  RHS range        [4e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 142326 rows and 32976 columns
Presolve time: 0.14s
Presolved: 11922 rows, 40513 columns, 83112 nonzeros

Ordering time: 0.26s

Barrier statistics:
 AA' NZ     : 4.939e+04
 Factor NZ  : 7.072e+05 (roughly 27 MBytes of memory)
 Factor Ops : 1.208e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.24669085e+12 -2.01005801e+12  4.01e+04 9.34e+03  6.64e+08     1s
   1   2.90547801e+11 -1.12314679e+12  4.76e+03 3.93e+03  8.72e+07     1s
   2   3.26653260e+10 -2.84560130e+11  4.26e+02 2.04e-10  9.39e+06     1s
   3   9.38560673e+09 -3.87605047e+10  3.99e+01 6.98e-10  1.03e+06     1s
   4   3.98921635e+09 -1.39925896e+10  8.84e+00 3.49e-10  2.96e+05     1s
   5   1.40044214e+09 -5.31636750e+09  3.56e+00 3.78e-10  1.03e+05     1s
   6   3.25084530e+08 -2.11591358e+09  8.44e-01 1.59e-10  3.29e+04     1s
   7   1.80964416e+08 -8.72868923e+08  4.40e-01 1.59e-10  1.38e+04     1s
   8   1.00604414e+08 -3.94334583e+08  2.15e-01 1.30e-10  6.38e+03     1s
   9   5.65041826e+07 -1.59242454e+08  9.97e-02 1.30e-10  2.75e+03     1s
  10   4.19935401e+07 -8.92441795e+07  6.66e-02 1.30e-10  1.67e+03     1s
  11   2.23696873e+07 -5.27779699e+07  2.51e-02 1.01e-10  9.41e+02     1s
  12   1.89517990e+07 -2.59089350e+07  1.94e-02 1.30e-10  5.61e+02     1s
  13   1.47942017e+07 -1.23645009e+07  1.29e-02 1.01e-10  3.39e+02     1s
  14   1.36212666e+07 -5.38866032e+06  1.11e-02 7.15e-11  2.37e+02     1s
  15   1.06406831e+07  1.30624598e+05  6.94e-03 1.01e-10  1.31e+02     1s
  16   9.01876878e+06  1.73131426e+06  4.74e-03 7.15e-11  9.05e+01     1s
  17   7.78492892e+06  3.43133491e+06  3.12e-03 4.24e-11  5.40e+01     1s
  18   6.52198052e+06  4.21738101e+06  1.47e-03 2.91e-11  2.85e+01     1s
  19   6.04481601e+06  4.54783265e+06  8.99e-04 2.91e-11  1.85e+01     1s
  20   5.90649757e+06  4.75038929e+06  7.24e-04 1.46e-11  1.43e+01     1s
  21   5.71727549e+06  4.93052842e+06  4.90e-04 1.46e-11  9.72e+00     1s
  22   5.61422116e+06  5.03297537e+06  3.65e-04 1.46e-11  7.18e+00     1s
  23   5.48870679e+06  5.16573532e+06  2.15e-04 1.46e-11  3.99e+00     1s
  24   5.39618251e+06  5.21804477e+06  1.07e-04 2.91e-11  2.20e+00     1s
  25   5.35770728e+06  5.24458687e+06  6.42e-05 2.91e-11  1.40e+00     1s
  26   5.34109441e+06  5.26188362e+06  4.56e-05 2.91e-11  9.78e-01     1s
  27   5.32729525e+06  5.27314262e+06  3.05e-05 1.46e-11  6.69e-01     1s
  28   5.31502132e+06  5.28669951e+06  1.77e-05 1.46e-11  3.50e-01     1s
  29   5.30798974e+06  5.29313708e+06  1.03e-05 2.91e-11  1.83e-01     1s
  30   5.30285282e+06  5.29572778e+06  5.03e-06 2.18e-11  8.80e-02     1s
  31   5.30081564e+06  5.29637486e+06  2.92e-06 1.46e-11  5.48e-02     1s
  32   5.29934977e+06  5.29732570e+06  1.49e-06 2.91e-11  2.50e-02     1s
  33   5.29903962e+06  5.29761897e+06  1.18e-06 1.46e-11  1.75e-02     1s
  34   5.29848016e+06  5.29772428e+06  6.22e-07 1.46e-11  9.33e-03     2s
  35   5.29816007e+06  5.29779098e+06  2.91e-07 2.91e-11  4.56e-03     2s
  36   5.29797336e+06  5.29784499e+06  1.69e-07 2.91e-11  1.58e-03     2s
  37   5.29789693e+06  5.29786942e+06  4.25e-08 8.73e-11  3.40e-04     2s
  38   5.29787475e+06  5.29787187e+06  8.64e-08 5.82e-11  3.56e-05     2s
  39   5.29787296e+06  5.29787261e+06  8.34e-09 8.73e-11  4.37e-06     2s
  40   5.29787278e+06  5.29787274e+06  1.16e-09 5.82e-11  4.36e-07     2s
  41   5.29787276e+06  5.29787275e+06  3.77e-10 5.82e-11  1.39e-07     2s
  42   5.29787275e+06  5.29787275e+06  2.86e-09 5.82e-11  1.38e-08     2s
  43   5.29787275e+06  5.29787275e+06  5.71e-09 5.82e-11  2.98e-09     2s

Barrier solved model in 43 iterations and 1.82 seconds
Optimal objective 5.29787275e+06

Crossover log...

     776 DPushes remaining with DInf 0.0000000e+00                 2s
       0 DPushes remaining with DInf 0.0000000e+00                 2s

     157 PPushes remaining with PInf 6.0000000e-06                 2s
       0 PPushes remaining with PInf 6.0000000e-06                 2s

  Push phase complete: Pinf 6.0000000e-06, Dinf 4.4761251e-10      2s

Iteration    Objective       Primal Inf.    Dual Inf.      Time
     936    5.2978727e+06   6.000000e-06   0.000000e+00      2s
Extra simplex iterations after uncrush: 49
     988    5.2978727e+06   0.000000e+00   0.000000e+00      2s

Solved with barrier
Solved in 988 iterations and 2.32 seconds
Optimal objective  5.297872746e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 5.30e+06
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.78s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-5hw8lcyl.lp
Reading time = 0.11 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0x6120f054
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [2e+00, 2e+01]
  RHS range        [5e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57048 rows and 22035 columns
Presolve time: 0.05s
Presolved: 3936 rows, 4822 columns, 23596 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.833e+04
 Factor NZ  : 6.453e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.199e+06 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   4.10032220e+07 -2.03286322e+09  2.13e+04 1.14e-13  9.19e+05     0s
   1   2.30648103e+07 -9.90148504e+08  2.44e+03 2.84e-13  1.58e+05     0s
   2   2.02303683e+07 -1.26161522e+08  2.22e+02 1.88e-12  1.71e+04     0s
   3   1.91717809e+07  8.19764870e+06  2.45e+01 5.68e-13  1.22e+03     0s
   4   1.87583609e+07  1.42944743e+07  3.68e+00 2.27e-13  4.69e+02     0s
   5   1.86406686e+07  1.69148662e+07  1.60e+00 1.71e-13  1.80e+02     0s
   6   1.85356367e+07  1.79106377e+07  5.55e-01 2.27e-13  6.50e+01     0s
   7   1.84728669e+07  1.82234288e+07  1.72e-01 9.95e-14  2.59e+01     0s
   8   1.84393939e+07  1.83717774e+07  2.28e-02 4.93e-14  7.02e+00     0s
   9   1.84323904e+07  1.84151656e+07  4.34e-03 5.68e-14  1.79e+00     0s
  10   1.84303786e+07  1.84296936e+07  1.44e-04 5.68e-14  7.10e-02     0s
  11   1.84302493e+07  1.84302456e+07  9.35e-07 5.68e-14  3.85e-04     0s
  12   1.84302480e+07  1.84302480e+07  4.32e-12 5.68e-14  3.85e-07     0s
  13   1.84302480e+07  1.84302480e+07  2.73e-12 5.68e-14  3.85e-10     0s

Barrier solved model in 13 iterations and 0.19 seconds
Optimal objective 1.84302480e+07

Crossover log...


Solved with primal simplex
Solved in 4897 iterations and 0.21 seconds
Optimal objective  1.843024802e+07
INFO:pypsa.linopf:Optimization successful. Objective value: 1.84e+07
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


load


add_BESS_load
300


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 2.8s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-r38xop7r.lp
Reading time = 0.29 seconds
obj: 154248 rows, 73489 columns, 258595 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 154248 rows, 73489 columns and 258595 nonzeros
Model fingerprint: 0x801531bd
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [2e+00, 2e+01]
  RHS range        [5e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 142321 rows and 32721 columns
Presolve time: 0.14s
Presolved: 11927 rows, 40768 columns, 83372 nonzeros

Ordering time: 0.30s

Barrier statistics:
 AA' NZ     : 4.940e+04
 Factor NZ  : 7.346e+05 (roughly 27 MBytes of memory)
 Factor Ops : 1.332e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.24505258e+12 -2.00569972e+12  4.01e+04 1.11e+04  6.63e+08     1s
   1   2.92132786e+11 -1.12615526e+12  4.75e+03 5.35e+03  8.71e+07     1s
   2   3.29763265e+10 -2.83232429e+11  4.32e+02 2.33e-10  9.44e+06     1s
   3   9.14324763e+09 -4.04889649e+10  4.33e+01 4.66e-10  1.09e+06     1s
   4   4.34778309e+09 -1.44726117e+10  1.34e+01 4.07e-10  3.43e+05     1s
   5   1.45601389e+09 -4.48088445e+09  4.49e+00 1.75e-10  9.65e+04     1s
   6   3.70720149e+08 -1.29077643e+09  1.20e+00 1.59e-10  2.38e+04     1s
   7   7.15259175e+07 -5.61836133e+08  1.64e-01 1.30e-10  8.06e+03     1s
   8   4.43973429e+07 -2.38916825e+08  8.25e-02 1.30e-10  3.56e+03     1s
   9   2.00035265e+07 -8.89397307e+07  2.31e-02 1.59e-10  1.35e+03     1s
  10   1.10744357e+07 -3.93942439e+07  9.10e-03 1.01e-10  6.23e+02     1s
  11   6.14377237e+06 -1.78894402e+07  3.25e-03 1.01e-10  2.96e+02     1s
  12   4.18643998e+06 -6.87572681e+06  1.41e-03 7.15e-11  1.36e+02     1s
  13   2.84586218e+06 -1.08448166e+06  3.65e-04 4.16e-11  4.82e+01     1s
  14   2.61321875e+06  4.03653036e+05  2.32e-04 2.91e-11  2.71e+01     1s
  15   2.26491687e+06  1.25573082e+06  4.80e-05 2.91e-11  1.24e+01     1s
  16   2.21239330e+06  1.80379983e+06  2.71e-05 2.18e-11  5.01e+00     1s
  17   2.14876937e+06  2.04264946e+06  5.40e-06 1.46e-11  1.30e+00     1s
  18   2.12877066e+06  2.10302039e+06  1.39e-06 2.91e-11  3.16e-01     1s
  19   2.12206348e+06  2.11424897e+06  4.17e-07 2.91e-11  9.58e-02     1s
  20   2.11983297e+06  2.11637116e+06  1.62e-07 1.46e-11  4.25e-02     1s
  21   2.11893890e+06  2.11742724e+06  6.42e-08 1.46e-11  1.85e-02     1s
  22   2.11863922e+06  2.11783339e+06  3.29e-08 2.91e-11  9.88e-03     1s
  23   2.11848127e+06  2.11807003e+06  2.85e-08 1.46e-11  5.04e-03     1s
  24   2.11839356e+06  2.11825166e+06  2.00e-08 2.91e-11  1.74e-03     1s
  25   2.11835291e+06  2.11828491e+06  3.69e-08 2.91e-11  8.34e-04     1s
  26   2.11833167e+06  2.11830912e+06  4.67e-08 2.91e-11  2.77e-04     1s
  27   2.11832317e+06  2.11831336e+06  3.36e-07 2.91e-11  1.20e-04     1s
  28   2.11831773e+06  2.11831567e+06  6.21e-07 5.82e-11  2.52e-05     1s
  29   2.11831633e+06  2.11831602e+06  3.71e-06 5.82e-11  3.69e-06     1s
  30   2.11831619e+06  2.11831619e+06  1.41e-07 5.82e-11  8.36e-08     1s
  31   2.11831619e+06  2.11831619e+06  1.81e-08 5.82e-11  7.75e-09     2s

Barrier solved model in 31 iterations and 1.51 seconds
Optimal objective 2.11831619e+06

Crossover log...

    2280 DPushes remaining with DInf 0.0000000e+00                 2s
       0 DPushes remaining with DInf 0.0000000e+00                 2s

     447 PPushes remaining with PInf 1.0000000e-06                 2s
       0 PPushes remaining with PInf 1.0000000e-06                 2s

  Push phase complete: Pinf 1.0000000e-06, Dinf 5.5558105e-10      2s

Iteration    Objective       Primal Inf.    Dual Inf.      Time
    2730    2.1183162e+06   0.000000e+00   0.000000e+00      2s
Extra simplex iterations after uncrush: 4
    2734    2.1183162e+06   0.000000e+00   0.000000e+00      2s

Solved with barrier
Solved in 2734 iterations and 1.95 seconds
Optimal objective  2.118316190e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 2.12e+06
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.74s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-ihugbhve.lp
Reading time = 0.11 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0x98acce2b
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [3e+00, 2e+01]
  RHS range        [5e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57049 rows and 22010 columns
Presolve time: 0.05s
Presolved: 3935 rows, 4847 columns, 23620 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.832e+04
 Factor NZ  : 6.452e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.199e+06 (less than 1 second per iteration)
 Threads    : 30

Barrier performed 0 iterations in 0.19 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with dual simplex
Solved in 2728 iterations and 0.19 seconds
Optimal objective  9.493437546e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 9.49e+06
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


load


add_BESS_load
300


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 2.68s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-hgwiav62.lp
Reading time = 0.27 seconds
obj: 154248 rows, 73489 columns, 258595 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 154248 rows, 73489 columns and 258595 nonzeros
Model fingerprint: 0xf5628c9b
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [3e+00, 2e+01]
  RHS range        [5e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 142323 rows and 33883 columns
Presolve time: 0.14s
Presolved: 11925 rows, 39606 columns, 82208 nonzeros

Ordering time: 0.41s

Barrier statistics:
 AA' NZ     : 4.939e+04
 Factor NZ  : 7.248e+05 (roughly 27 MBytes of memory)
 Factor Ops : 1.291e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.25124838e+12 -2.02996166e+12  3.38e+04 1.37e+04  6.64e+08     1s
   1   2.82233105e+11 -1.14050589e+12  3.96e+03 5.94e+03  8.68e+07     1s
   2   2.99238138e+10 -2.86569366e+11  3.35e+02 2.04e-10  9.09e+06     1s
   3   9.05383435e+09 -4.27088638e+10  4.35e+01 4.07e-10  1.20e+06     1s
   4   4.35587844e+09 -1.59777872e+10  1.40e+01 1.60e-10  3.92e+05     1s
   5   1.52812800e+09 -5.04383368e+09  4.74e+00 2.33e-10  1.14e+05     1s
   6   2.31671743e+08 -1.13568233e+09  7.28e-01 1.47e-10  1.98e+04     1s
   7   1.03183400e+08 -5.12929900e+08  2.78e-01 1.27e-10  8.37e+03     1s
   8   7.30381397e+07 -2.64148487e+08  1.81e-01 9.81e-11  4.52e+03     1s
   9   4.39690576e+07 -1.20805264e+08  9.58e-02 1.27e-10  2.18e+03     1s
  10   2.91393353e+07 -7.67099084e+07  5.80e-02 1.07e-10  1.38e+03     1s
  11   1.64104030e+07 -3.84458538e+07  2.68e-02 9.81e-11  7.09e+02     1s
  12   1.23278367e+07 -2.05577503e+07  1.81e-02 7.79e-11  4.23e+02     1s
  13   8.23093382e+06 -8.09813516e+06  9.76e-03 6.90e-11  2.09e+02     1s
  14   6.67846689e+06 -4.05585668e+06  6.85e-03 6.90e-11  1.37e+02     1s
  15   4.50270953e+06 -5.85739474e+05  2.92e-03 4.88e-11  6.46e+01     1s
  16   3.81444053e+06  1.15384800e+06  1.75e-03 4.88e-11  3.37e+01     1s
  17   3.24440733e+06  1.92582708e+06  8.13e-04 2.91e-11  1.67e+01     1s
  18   2.96739744e+06  2.49665065e+06  3.80e-04 4.37e-11  5.95e+00     1s
  19   2.88186748e+06  2.65133804e+06  2.56e-04 4.37e-11  2.91e+00     1s
  20   2.80412356e+06  2.67128726e+06  1.47e-04 4.37e-11  1.68e+00     1s
  21   2.77114742e+06  2.68213946e+06  1.01e-04 1.46e-11  1.12e+00     1s
  22   2.73850339e+06  2.68707956e+06  5.62e-05 1.46e-11  6.49e-01     1s
  23   2.72717901e+06  2.68975912e+06  4.07e-05 1.46e-11  4.73e-01     1s
  24   2.71458836e+06  2.69219647e+06  2.37e-05 1.46e-11  2.83e-01     1s
  25   2.70328842e+06  2.69389346e+06  8.67e-06 1.46e-11  1.19e-01     1s
  26   2.70106190e+06  2.69530986e+06  6.15e-06 1.46e-11  7.26e-02     1s
  27   2.70073876e+06  2.69544916e+06  5.73e-06 1.46e-11  6.68e-02     1s
  28   2.69912479e+06  2.69600963e+06  3.64e-06 1.46e-11  3.93e-02     1s
  29   2.69879020e+06  2.69605099e+06  3.19e-06 1.46e-11  3.46e-02     1s
  30   2.69851373e+06  2.69619205e+06  2.88e-06 2.91e-11  2.93e-02     1s
  31   2.69837189e+06  2.69623682e+06  2.69e-06 1.46e-11  2.70e-02     2s
  32   2.69776931e+06  2.69631719e+06  1.88e-06 2.91e-11  1.83e-02     2s
  33   2.69757294e+06  2.69633580e+06  1.61e-06 2.91e-11  1.56e-02     2s
  34   2.69745496e+06  2.69633969e+06  1.44e-06 2.91e-11  1.41e-02     2s
  35   2.69731157e+06  2.69634663e+06  1.28e-06 2.91e-11  1.22e-02     2s
  36   2.69702877e+06  2.69635168e+06  9.09e-07 2.91e-11  8.55e-03     2s
  37   2.69682439e+06  2.69636480e+06  6.93e-07 5.82e-11  5.80e-03     2s
  38   2.69643977e+06  2.69637468e+06  1.22e-07 5.82e-11  8.22e-04     2s
  39   2.69639430e+06  2.69638183e+06  6.82e-08 5.82e-11  1.57e-04     2s
  40   2.69638613e+06  2.69638392e+06  1.18e-08 5.82e-11  2.79e-05     2s
  41   2.69638450e+06  2.69638428e+06  1.90e-08 8.73e-11  2.78e-06     2s
  42   2.69638433e+06  2.69638433e+06  3.67e-10 5.82e-11  5.26e-08     2s
  43   2.69638433e+06  2.69638433e+06  6.52e-10 5.82e-11  1.03e-08     2s
  44   2.69638433e+06  2.69638433e+06  1.34e-09 8.73e-11  5.92e-10     2s

Barrier solved model in 44 iterations and 1.88 seconds
Optimal objective 2.69638433e+06

Crossover log...

    1647 DPushes remaining with DInf 0.0000000e+00                 2s
       0 DPushes remaining with DInf 0.0000000e+00                 2s

     801 PPushes remaining with PInf 0.0000000e+00                 2s
       0 PPushes remaining with PInf 2.0000000e-06                 2s

  Push phase complete: Pinf 2.0000000e-06, Dinf 2.2714570e-10      2s

Iteration    Objective       Primal Inf.    Dual Inf.      Time
    2451    2.6963843e+06   1.000000e-06   0.000000e+00      2s
Extra simplex iterations after uncrush: 25
    2478    2.6963843e+06   0.000000e+00   0.000000e+00      2s

Solved with barrier
Solved in 2478 iterations and 2.51 seconds
Optimal objective  2.696384330e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 2.70e+06
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.78s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-lgj4sq56.lp
Reading time = 0.11 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0x37e640e9
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [4e+00, 3e+01]
  RHS range        [7e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57050 rows and 22015 columns
Presolve time: 0.05s
Presolved: 3934 rows, 4842 columns, 23614 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.832e+04
 Factor NZ  : 6.450e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.199e+06 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   3.65300243e+07 -1.16420358e+09  2.12e+04 5.68e-14  5.74e+05     0s
   1   1.44762254e+07 -6.02979351e+08  2.16e+03 1.71e-13  9.46e+04     0s
   2   1.11444508e+07 -9.64431724e+07  2.12e+02 1.14e-13  1.24e+04     0s
   3   1.00394522e+07  4.60386530e+05  1.68e+01 5.68e-13  1.03e+03     0s
   4   9.72649534e+06  7.84413982e+06  2.51e+00 3.13e-13  1.96e+02     0s
   5   9.63022018e+06  8.94685170e+06  7.38e-01 1.21e-13  7.08e+01     0s
   6   9.58931723e+06  9.33806040e+06  1.83e-01 5.68e-14  2.60e+01     0s
   7   9.57962465e+06  9.47789090e+06  8.74e-02 3.15e-14  1.05e+01     0s
   8   9.57028142e+06  9.54055840e+06  1.65e-02 3.11e-14  3.07e+00     0s
   9   9.56775109e+06  9.55874094e+06  5.45e-03 3.71e-14  9.31e-01     0s
  10   9.56659453e+06  9.56550237e+06  4.16e-05 2.84e-14  1.13e-01     0s
  11   9.56657317e+06  9.56656826e+06  8.96e-11 5.68e-14  5.07e-04     0s

Barrier performed 11 iterations in 0.20 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with primal simplex
Solved in 5121 iterations and 0.20 seconds
Optimal objective  9.566572662e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 9.57e+06
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


load


add_BESS_load
300


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 2.79s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-voyhr9sg.lp
Reading time = 0.28 seconds
obj: 154248 rows, 73489 columns, 258595 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 154248 rows, 73489 columns and 258595 nonzeros
Model fingerprint: 0xfaea3f14
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [4e+00, 3e+01]
  RHS range        [7e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 142325 rows and 33355 columns
Presolve time: 0.14s
Presolved: 11923 rows, 40134 columns, 82734 nonzeros

Ordering time: 0.27s

Barrier statistics:
 AA' NZ     : 4.939e+04
 Factor NZ  : 7.146e+05 (roughly 27 MBytes of memory)
 Factor Ops : 1.271e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.24997580e+12 -2.06977245e+12  4.11e+04 2.83e-11  6.91e+08     1s
   1   2.97613821e+11 -1.16952854e+12  4.69e+03 4.76e+03  8.87e+07     1s
   2   3.19431741e+10 -2.91853721e+11  4.27e+02 2.33e-10  9.66e+06     1s
   3   8.11219906e+09 -4.57547872e+10  4.21e+01 2.33e-10  1.14e+06     1s
   4   4.83620192e+09 -1.74251567e+10  1.01e+01 1.75e-10  3.61e+05     1s
   5   1.86766870e+09 -6.87944725e+09  4.03e+00 2.91e-10  1.31e+05     1s
   6   1.06751178e+08 -8.38528949e+08  3.10e-01 2.69e-10  1.25e+04     1s
   7   2.89525792e+07 -3.03808268e+08  2.63e-02 1.18e-10  4.18e+03     1s
   8   2.07370121e+07 -1.00889716e+08  1.32e-02 1.18e-10  1.52e+03     1s
   9   1.10445200e+07 -6.61539669e+07  5.01e-03 8.84e-11  9.64e+02     1s
  10   6.60250039e+06 -3.64868832e+07  2.30e-03 4.88e-11  5.37e+02     1s
  11   3.65598531e+06 -1.91534633e+07  8.56e-04 4.48e-11  2.84e+02     1s
  12   2.60313840e+06 -1.14133075e+07  4.55e-04 3.02e-11  1.75e+02     1s
  13   1.64943483e+06 -7.65015020e+06  1.40e-04 2.91e-11  1.16e+02     1s
  14   1.35397265e+06 -3.49899383e+06  7.23e-05 2.91e-11  6.05e+01     1s
  15   1.12192631e+06 -4.11997845e+05  2.65e-05 2.91e-11  1.91e+01     1s
  16   9.84760344e+05  3.71576767e+05  8.91e-06 2.91e-11  7.64e+00     1s
  17   9.30730411e+05  7.32220783e+05  3.04e-06 5.82e-11  2.47e+00     1s
  18   9.00388920e+05  8.43737050e+05  5.64e-07 2.91e-11  7.06e-01     1s
  19   8.94666597e+05  8.74382955e+05  2.57e-07 2.91e-11  2.53e-01     1s
  20   8.93446065e+05  8.74729320e+05  2.04e-07 2.91e-11  2.33e-01     1s
  21   8.90649368e+05  8.82190605e+05  8.60e-08 5.82e-11  1.05e-01     1s
  22   8.89092124e+05  8.84988681e+05  2.96e-08 5.82e-11  5.11e-02     1s
  23   8.88550567e+05  8.86960981e+05  1.22e-08 5.82e-11  1.98e-02     1s
  24   8.88274059e+05  8.87730128e+05  8.05e-09 5.82e-11  6.78e-03     1s
  25   8.88145912e+05  8.87946112e+05  3.04e-08 5.82e-11  2.49e-03     1s
  26   8.88091998e+05  8.88046046e+05  2.46e-08 5.82e-11  5.72e-04     1s
  27   8.88085646e+05  8.88072401e+05  3.26e-08 5.82e-11  1.65e-04     1s
  28   8.88083141e+05  8.88081018e+05  7.49e-09 5.82e-11  2.65e-05     1s
  29   8.88082545e+05  8.88082060e+05  2.26e-09 5.82e-11  6.04e-06     1s
  30   8.88082335e+05  8.88082260e+05  2.46e-09 5.82e-11  9.32e-07     1s
  31   8.88082288e+05  8.88082271e+05  7.14e-10 2.91e-11  2.10e-07     1s
  32   8.88082277e+05  8.88082274e+05  2.66e-09 5.82e-11  3.34e-08     1s
  33   8.88082275e+05  8.88082274e+05  3.03e-09 8.73e-11  6.62e-09     1s

Barrier solved model in 33 iterations and 1.42 seconds
Optimal objective 8.88082275e+05

Crossover log...

     765 DPushes remaining with DInf 0.0000000e+00                 1s
       0 DPushes remaining with DInf 0.0000000e+00                 2s

     828 PPushes remaining with PInf 4.4229942e-06                 2s
       0 PPushes remaining with PInf 4.0000000e-06                 2s

  Push phase complete: Pinf 4.0000000e-06, Dinf 1.1452583e-10      2s

Iteration    Objective       Primal Inf.    Dual Inf.      Time
    1596    8.8808227e+05   3.000000e-06   0.000000e+00      2s
Extra simplex iterations after uncrush: 16
    1615    8.8808227e+05   0.000000e+00   0.000000e+00      2s

Solved with barrier
Solved in 1615 iterations and 2.00 seconds
Optimal objective  8.880822743e+05
INFO:pypsa.linopf:Optimization successful. Objective value: 8.88e+05
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.78s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-7_msrr28.lp
Reading time = 0.11 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0xcaebb58b
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [6e+00, 5e+01]
  RHS range        [1e-02, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57050 rows and 22011 columns
Presolve time: 0.05s
Presolved: 3934 rows, 4846 columns, 23618 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.832e+04
 Factor NZ  : 6.454e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.200e+06 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   3.72180162e+07 -1.16457744e+09  1.86e+04 5.68e-14  5.19e+05     0s
   1   1.59113728e+07 -5.61085075e+08  1.95e+03 1.42e-13  8.63e+04     0s
   2   1.28731564e+07 -8.39721696e+07  2.01e+02 7.28e-12  1.11e+04     0s
   3   1.18308535e+07 -7.16258226e+04  1.99e+01 6.82e-13  1.27e+03     0s
   4   1.14990844e+07  9.15844272e+06  2.62e+00 2.96e-12  2.43e+02     0s
   5   1.13876825e+07  1.06765763e+07  8.07e-01 8.95e-13  7.36e+01     0s
   6   1.13388696e+07  1.10977689e+07  2.11e-01 3.23e-13  2.49e+01     0s
   7   1.13250214e+07  1.12339551e+07  5.41e-02 1.35e-13  9.40e+00     0s
   8   1.13209391e+07  1.13145979e+07  6.94e-03 4.92e-14  6.55e-01     0s
   9   1.13202159e+07  1.13201411e+07  1.02e-04 4.73e-14  7.73e-03     0s
  10   1.13202049e+07  1.13202048e+07  1.47e-10 4.22e-14  7.73e-06     0s
  11   1.13202049e+07  1.13202049e+07  1.81e-10 5.68e-14  8.94e-12     0s

Barrier solved model in 11 iterations and 0.18 seconds
Optimal objective 1.13202049e+07

Crossover log...

      44 DPushes remaining with DInf 0.0000000e+00                 0s

Solved with primal simplex
Solved in 5415 iterations and 0.21 seconds
Optimal objective  1.132020490e+07
INFO:pypsa.linopf:Optimization successful. Objective value: 1.13e+07
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


load


add_BESS_load
300


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 2.78s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-vfdbussp.lp
Reading time = 0.28 seconds
obj: 154248 rows, 73489 columns, 258595 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 154248 rows, 73489 columns and 258595 nonzeros
Model fingerprint: 0xa1e6151f
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [6e+00, 5e+01]
  RHS range        [1e-02, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 142324 rows and 33329 columns
Presolve time: 0.15s
Presolved: 11924 rows, 40160 columns, 82761 nonzeros

Ordering time: 0.20s

Barrier statistics:
 AA' NZ     : 4.939e+04
 Factor NZ  : 7.228e+05 (roughly 27 MBytes of memory)
 Factor Ops : 1.288e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.25141342e+12 -2.08396823e+12  3.74e+04 2.33e-11  6.91e+08     0s
   1   2.64192498e+11 -1.16710466e+12  4.72e+03 4.86e+03  9.55e+07     1s
   2   2.36105183e+10 -2.98637574e+11  3.42e+02 1.75e-10  8.98e+06     1s
   3   6.14550537e+09 -3.88274778e+10  2.71e+01 1.37e-08  8.92e+05     1s
   4   3.19315403e+09 -1.22884044e+10  8.89e+00 3.00e-09  2.70e+05     1s
   5   5.64317417e+08 -3.81300661e+09  1.75e+00 6.11e-10  6.36e+04     1s
   6   2.95821962e+07 -7.92310144e+08  1.61e-02 1.88e-10  1.03e+04     1s
   7   2.28490053e+07 -2.76423494e+08  6.61e-03 1.01e-10  3.73e+03     1s
   8   1.49645024e+07 -9.75719579e+07  2.79e-03 7.79e-11  1.40e+03     1s
   9   7.71046242e+06 -3.71685271e+07  7.12e-04 5.70e-11  5.59e+02     1s
  10   4.41490811e+06 -1.49852440e+07  2.83e-04 2.91e-11  2.42e+02     1s
  11   3.12710637e+06 -2.61498863e+06  1.46e-04 2.91e-11  7.15e+01     1s
  12   2.18632849e+06 -8.49919668e+05  6.03e-05 2.91e-11  3.78e+01     1s
  13   1.75385415e+06  6.06642004e+05  2.40e-05 5.82e-11  1.43e+01     1s
  14   1.57267811e+06  1.11477894e+06  1.04e-05 5.82e-11  5.70e+00     1s
  15   1.46816317e+06  1.29350085e+06  3.57e-06 2.91e-11  2.17e+00     1s
  16   1.43684756e+06  1.36392981e+06  1.64e-06 2.91e-11  9.08e-01     1s
  17   1.41782698e+06  1.39228996e+06  5.42e-07 5.82e-11  3.18e-01     1s
  18   1.41054428e+06  1.40428364e+06  1.65e-07 5.82e-11  7.79e-02     1s
  19   1.40823474e+06  1.40586826e+06  6.24e-08 2.91e-11  2.95e-02     1s
  20   1.40744711e+06  1.40644158e+06  2.83e-08 2.91e-11  1.25e-02     1s
  21   1.40707637e+06  1.40664916e+06  1.54e-08 5.82e-11  5.32e-03     1s
  22   1.40685607e+06  1.40673459e+06  1.07e-08 5.82e-11  1.51e-03     1s
  23   1.40680791e+06  1.40676876e+06  1.95e-08 5.82e-11  4.87e-04     1s
  24   1.40678598e+06  1.40677947e+06  5.22e-08 5.82e-11  8.11e-05     1s
  25   1.40678198e+06  1.40678030e+06  4.94e-08 5.82e-11  2.08e-05     1s
  26   1.40678064e+06  1.40678057e+06  1.12e-09 5.82e-11  9.32e-07     1s
  27   1.40678061e+06  1.40678060e+06  8.12e-10 5.82e-11  1.83e-07     1s
  28   1.40678060e+06  1.40678060e+06  3.26e-07 5.82e-11  1.08e-07     1s

Barrier solved model in 28 iterations and 1.27 seconds
Optimal objective 1.40678060e+06

Crossover log...

    1688 DPushes remaining with DInf 0.0000000e+00                 1s
       0 DPushes remaining with DInf 0.0000000e+00                 2s

    2352 PPushes remaining with PInf 5.8000000e-05                 2s
       0 PPushes remaining with PInf 6.4000000e-05                 2s

  Push phase complete: Pinf 6.4000000e-05, Dinf 3.6649754e-10      2s

Iteration    Objective       Primal Inf.    Dual Inf.      Time
    4043    1.4067806e+06   5.400000e-05   0.000000e+00      2s
Extra simplex iterations after uncrush: 57
    4121    1.4067806e+06   0.000000e+00   0.000000e+00      2s

Solved with barrier
Solved in 4121 iterations and 1.90 seconds
Optimal objective  1.406780595e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 1.41e+06
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.79s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-pdhewuqq.lp
Reading time = 0.11 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0x9f5f4ba5
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [9e+00, 8e+01]
  RHS range        [2e-02, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57051 rows and 22020 columns
Presolve time: 0.06s
Presolved: 3933 rows, 4837 columns, 23608 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.832e+04
 Factor NZ  : 6.468e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.207e+06 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   3.55898502e+07 -1.05577094e+09  1.90e+04 5.68e-14  4.80e+05     0s
   1   1.58338308e+07 -5.14093156e+08  1.86e+03 1.42e-13  7.82e+04     0s
   2   1.32315382e+07 -6.89071712e+07  1.96e+02 3.41e-13  9.49e+03     0s
   3   1.23016398e+07  1.98851633e+06  1.79e+01 7.96e-13  1.10e+03     0s
   4   1.19896351e+07  1.01340182e+07  2.68e+00 8.38e-13  1.94e+02     0s
   5   1.18923826e+07  1.13703170e+07  9.91e-01 1.95e-13  5.42e+01     0s
   6   1.18513421e+07  1.16744696e+07  3.57e-01 9.95e-14  1.83e+01     0s
   7   1.18370526e+07  1.17583467e+07  1.48e-01 8.53e-14  8.16e+00     0s
   8   1.18273258e+07  1.18149659e+07  6.91e-03 4.27e-14  1.28e+00     0s
   9   1.18267326e+07  1.18261227e+07  4.53e-04 5.68e-14  6.31e-02     0s
  10   1.18266640e+07  1.18266634e+07  5.46e-10 4.04e-14  6.35e-05     0s
  11   1.18266639e+07  1.18266639e+07  5.23e-10 4.61e-14  6.52e-11     0s

Barrier solved model in 11 iterations and 0.20 seconds
Optimal objective 1.18266639e+07

Crossover log...


Solved with primal simplex
Solved in 5382 iterations and 0.21 seconds
Optimal objective  1.182666395e+07
INFO:pypsa.linopf:Optimization successful. Objective value: 1.18e+07
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


load


add_BESS_load
300


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 2.76s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-stzk0lbc.lp
Reading time = 0.28 seconds
obj: 154248 rows, 73489 columns, 258595 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 154248 rows, 73489 columns and 258595 nonzeros
Model fingerprint: 0x4c0628b8
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [9e+00, 8e+01]
  RHS range        [2e-02, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 142377 rows and 33266 columns
Presolve time: 0.15s
Presolved: 11871 rows, 40223 columns, 82771 nonzeros

Ordering time: 0.31s

Barrier statistics:
 AA' NZ     : 4.934e+04
 Factor NZ  : 7.406e+05 (roughly 27 MBytes of memory)
 Factor Ops : 1.345e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.74337796e+12 -2.03746170e+12  5.31e+04 1.17e+04  9.30e+08     1s
   1   3.88056092e+11 -1.19643267e+12  5.92e+03 2.04e-10  1.13e+08     1s
   2   3.12601012e+10 -3.72367618e+11  4.11e+02 2.33e-10  1.08e+07     1s
   3   8.21169240e+09 -4.49703442e+10  4.97e+01 5.88e-09  1.26e+06     1s
   4   4.90985369e+09 -1.70340260e+10  1.58e+01 1.59e-09  4.22e+05     1s
   5   1.99061699e+09 -7.01769303e+09  6.78e+00 4.37e-10  1.60e+05     1s
   6   1.04983524e+08 -1.27559480e+09  4.31e-01 1.65e-10  1.86e+04     1s
   7   6.78756628e+07 -5.67968506e+08  2.45e-01 1.31e-10  8.34e+03     1s
   8   4.90348886e+07 -2.34517546e+08  1.60e-01 9.81e-11  3.67e+03     1s
   9   1.43997426e+07 -5.45178356e+07  2.33e-02 1.27e-10  8.66e+02     1s
  10   8.12014689e+06 -2.62612762e+07  1.11e-02 9.81e-11  4.30e+02     1s
  11   5.12540340e+06 -1.31039869e+07  6.12e-03 5.44e-11  2.27e+02     1s
  12   3.65120846e+06 -5.84104556e+06  3.95e-03 3.26e-11  1.18e+02     1s
  13   2.34321517e+06 -2.94705146e+06  2.19e-03 1.80e-11  6.58e+01     1s
  14   1.80030099e+06 -1.77897500e+06  1.48e-03 1.46e-11  4.45e+01     1s
  15   1.55187480e+06 -9.54900418e+05  1.16e-03 1.46e-11  3.12e+01     1s
  16   1.32610856e+06 -7.57121131e+05  8.82e-04 1.46e-11  2.59e+01     1s
  17   1.18157719e+06 -2.37494613e+05  7.19e-04 1.46e-11  1.76e+01     1s
  18   9.98124207e+05 -2.05447902e+04  5.06e-04 1.46e-11  1.27e+01     1s
  19   9.15399964e+05  1.21560806e+05  4.13e-04 1.46e-11  9.87e+00     1s
  20   8.92828859e+05  2.66556227e+05  3.86e-04 1.46e-11  7.79e+00     1s
  21   7.74466461e+05  3.12078605e+05  2.48e-04 1.46e-11  5.75e+00     1s
  22   7.04618120e+05  4.24266695e+05  1.65e-04 1.46e-11  3.49e+00     1s
  23   6.95909929e+05  4.37816862e+05  1.55e-04 1.46e-11  3.21e+00     1s
  24   6.50804893e+05  5.17028404e+05  1.04e-04 2.18e-11  1.66e+00     1s
  25   6.20532570e+05  5.39762317e+05  7.03e-05 2.91e-11  1.00e+00     1s
  26   6.13765994e+05  5.40092848e+05  6.30e-05 2.91e-11  9.16e-01     1s
  27   5.98343378e+05  5.42543420e+05  4.63e-05 2.91e-11  6.94e-01     1s
  28   5.75854905e+05  5.50178909e+05  2.23e-05 2.91e-11  3.19e-01     1s
  29   5.74698509e+05  5.51713761e+05  2.12e-05 2.91e-11  2.86e-01     1s
  30   5.65319964e+05  5.52753979e+05  1.14e-05 5.82e-11  1.56e-01     1s
  31   5.61635745e+05  5.53349803e+05  7.58e-06 5.82e-11  1.03e-01     1s
  32   5.59300215e+05  5.53622030e+05  5.16e-06 5.82e-11  7.06e-02     1s
  33   5.56799602e+05  5.53947680e+05  2.58e-06 5.82e-11  3.55e-02     1s
  34   5.56088562e+05  5.54009683e+05  1.86e-06 5.82e-11  2.58e-02     2s
  35   5.55403032e+05  5.54048515e+05  1.16e-06 5.82e-11  1.68e-02     2s
  36   5.54893827e+05  5.54105301e+05  6.45e-07 5.82e-11  9.80e-03     2s
  37   5.54551460e+05  5.54198538e+05  3.04e-07 8.73e-11  4.39e-03     2s
  38   5.54496811e+05  5.54210048e+05  4.08e-07 8.73e-11  3.57e-03     2s
  39   5.54351933e+05  5.54222418e+05  2.77e-07 2.91e-11  1.61e-03     2s
  40   5.54280367e+05  5.54232454e+05  1.15e-07 5.82e-11  5.96e-04     2s
  41   5.54254235e+05  5.54237885e+05  7.13e-08 5.82e-11  2.03e-04     2s
  42   5.54243261e+05  5.54239270e+05  1.99e-08 5.82e-11  4.96e-05     2s
  43   5.54239781e+05  5.54239633e+05  5.10e-10 5.82e-11  1.85e-06     2s
  44   5.54239690e+05  5.54239672e+05  3.89e-10 5.82e-11  2.27e-07     2s
  45   5.54239678e+05  5.54239673e+05  3.16e-09 8.73e-11  6.04e-08     2s
  46   5.54239676e+05  5.54239673e+05  1.43e-07 5.82e-11  3.67e-08     2s

Barrier solved model in 46 iterations and 1.79 seconds
Optimal objective 5.54239676e+05

Crossover log...

    1204 DPushes remaining with DInf 0.0000000e+00                 2s
       0 DPushes remaining with DInf 0.0000000e+00                 2s

     892 PPushes remaining with PInf 2.3000000e-05                 2s

Solved with dual simplex
Solved in 11651 iterations and 2.45 seconds
Optimal objective  5.542396732e+05
INFO:pypsa.linopf:Optimization successful. Objective value: 5.54e+05
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.79s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-jq2dkrwl.lp
Reading time = 0.11 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0x426916df
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [1e+01, 8e+01]
  RHS range        [2e-02, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57054 rows and 22011 columns
Presolve time: 0.05s
Presolved: 3930 rows, 4846 columns, 23614 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.832e+04
 Factor NZ  : 6.464e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.206e+06 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   3.04514874e+07 -9.58191170e+08  1.57e+04 5.68e-14  4.15e+05     0s
   1   1.12672004e+07 -4.53292675e+08  1.72e+03 1.71e-13  6.98e+04     0s
   2   8.72390851e+06 -6.14332988e+07  1.73e+02 1.42e-13  8.14e+03     0s
   3   7.94601170e+06  6.21437559e+05  1.40e+01 3.35e-12  7.84e+02     0s
   4   7.69982743e+06  3.55199211e+06  1.85e+00 1.99e-12  4.30e+02     0s
   5   7.59586780e+06  6.02647140e+06  4.24e-01 8.67e-13  1.62e+02     0s
   6   7.54799733e+06  6.85309409e+06  1.60e-01 3.59e-13  7.17e+01     0s
   7   7.52220555e+06  7.13193959e+06  5.91e-02 2.13e-13  4.03e+01     0s
   8   7.50759720e+06  7.30548780e+06  1.60e-02 1.17e-13  2.09e+01     0s
   9   7.49995366e+06  7.40261566e+06  4.56e-03 5.77e-14  1.00e+01     0s
  10   7.49604303e+06  7.44649171e+06  6.02e-04 3.42e-14  5.11e+00     0s
  11   7.49473086e+06  7.47318247e+06  1.06e-04 3.40e-14  2.22e+00     0s
  12   7.49416858e+06  7.48674054e+06  1.10e-05 2.84e-14  7.66e-01     0s
  13   7.49402683e+06  7.49344955e+06  1.24e-06 5.68e-14  5.96e-02     0s
  14   7.49399420e+06  7.49397317e+06  1.85e-08 3.53e-14  2.17e-03     0s

Barrier performed 14 iterations in 0.21 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with primal simplex
Solved in 5320 iterations and 0.21 seconds
Optimal objective  7.493991182e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 7.49e+06
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


load


add_BESS_load
300


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 2.81s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-38_z3izq.lp
Reading time = 0.29 seconds
obj: 154248 rows, 73489 columns, 258595 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 154248 rows, 73489 columns and 258595 nonzeros
Model fingerprint: 0x0c9946d1
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [1e+01, 8e+01]
  RHS range        [2e-02, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 142352 rows and 34234 columns
Presolve time: 0.16s
Presolved: 11896 rows, 39255 columns, 81828 nonzeros

Ordering time: 0.24s

Barrier statistics:
 AA' NZ     : 4.936e+04
 Factor NZ  : 7.390e+05 (roughly 27 MBytes of memory)
 Factor Ops : 1.330e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.74281594e+12 -2.06603297e+12  5.31e+04 1.37e+04  9.28e+08     1s
   1   3.77223623e+11 -1.19911692e+12  6.03e+03 2.10e-10  1.15e+08     1s
   2   2.99652308e+10 -3.79115354e+11  4.14e+02 1.75e-10  1.10e+07     1s
   3   8.13088136e+09 -4.77803094e+10  5.68e+01 9.60e-10  1.39e+06     1s
   4   4.46026263e+09 -1.81524341e+10  1.45e+01 1.75e-10  4.27e+05     1s
   5   1.55965263e+09 -7.09755064e+09  5.23e+00 1.76e-10  1.47e+05     1s
   6   7.16868666e+07 -1.21059734e+09  2.05e-01 2.23e-10  1.70e+04     1s
   7   5.08563754e+07 -5.43388182e+08  1.22e-01 1.24e-10  7.77e+03     1s
   8   2.76390489e+07 -2.01214895e+08  4.28e-02 8.84e-11  2.95e+03     1s
   9   1.46313334e+07 -8.42800936e+07  1.27e-02 8.84e-11  1.26e+03     1s
  10   1.02671336e+07 -4.36967172e+07  6.29e-03 5.10e-11  6.89e+02     1s
  11   7.33460375e+06 -1.36876264e+07  2.94e-03 4.48e-11  2.68e+02     1s
  12   6.18196478e+06 -7.23243932e+06  1.86e-03 2.91e-11  1.71e+02     1s
  13   5.40973640e+06 -1.12752512e+06  1.21e-03 2.91e-11  8.33e+01     1s
  14   4.62299130e+06  1.12735200e+06  6.34e-04 1.46e-11  4.45e+01     1s
  15   3.94553829e+06  2.64984224e+06  1.77e-04 1.46e-11  1.65e+01     1s
  16   3.78476875e+06  3.22000822e+06  8.28e-05 1.46e-11  7.19e+00     1s
  17   3.68745701e+06  3.51575019e+06  3.17e-05 2.18e-11  2.19e+00     1s
  18   3.63773147e+06  3.59144206e+06  8.81e-06 2.91e-11  5.90e-01     1s
  19   3.62323658e+06  3.60675816e+06  2.92e-06 5.82e-11  2.10e-01     1s
  20   3.61947068e+06  3.61170999e+06  1.53e-06 5.82e-11  9.89e-02     1s
  21   3.61750430e+06  3.61292632e+06  8.32e-07 2.91e-11  5.83e-02     1s
  22   3.61633854e+06  3.61417600e+06  4.32e-07 2.91e-11  2.75e-02     1s
  23   3.61586213e+06  3.61455982e+06  2.74e-07 2.91e-11  1.66e-02     1s
  24   3.61522461e+06  3.61483893e+06  6.72e-08 5.82e-11  4.91e-03     1s
  25   3.61508375e+06  3.61494895e+06  2.29e-08 5.82e-11  1.72e-03     1s
  26   3.61503405e+06  3.61499628e+06  1.83e-08 5.82e-11  4.81e-04     1s
  27   3.61501612e+06  3.61500147e+06  8.46e-08 5.82e-11  1.87e-04     1s
  28   3.61500919e+06  3.61500285e+06  4.62e-08 2.91e-11  8.08e-05     1s
  29   3.61500522e+06  3.61500415e+06  6.63e-08 5.82e-11  1.35e-05     1s
  30   3.61500460e+06  3.61500454e+06  9.15e-08 5.82e-11  7.36e-07     1s
  31   3.61500459e+06  3.61500457e+06  2.43e-08 5.82e-11  2.97e-07     1s
  32   3.61500459e+06  3.61500459e+06  2.39e-09 8.73e-11  2.00e-08     1s
  33   3.61500459e+06  3.61500459e+06  1.94e-10 5.82e-11  1.56e-09     1s

Barrier solved model in 33 iterations and 1.30 seconds
Optimal objective 3.61500459e+06

Crossover log...

     886 DPushes remaining with DInf 0.0000000e+00                 1s
       0 DPushes remaining with DInf 0.0000000e+00                 2s

     541 PPushes remaining with PInf 2.0000000e-05                 2s
       0 PPushes remaining with PInf 2.2000000e-05                 2s

  Push phase complete: Pinf 2.2000000e-05, Dinf 3.5343259e-10      2s

Iteration    Objective       Primal Inf.    Dual Inf.      Time
    1430    3.6150046e+06   1.900000e-05   0.000000e+00      2s
Extra simplex iterations after uncrush: 26
    1470    3.6150046e+06   0.000000e+00   0.000000e+00      2s

Solved with barrier
Solved in 1470 iterations and 2.12 seconds
Optimal objective  3.615004592e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 3.62e+06
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.78s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-v_68zl9y.lp
Reading time = 0.11 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0xeb311df8
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [1e+01, 8e+01]
  RHS range        [2e-02, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57051 rows and 22011 columns
Presolve time: 0.06s
Presolved: 3933 rows, 4846 columns, 23617 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.832e+04
 Factor NZ  : 6.449e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.199e+06 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   3.66371100e+07 -1.15821748e+09  1.92e+04 5.68e-14  5.28e+05     0s
   1   1.47657462e+07 -5.69570770e+08  2.21e+03 1.71e-13  9.08e+04     0s
   2   1.13312451e+07 -9.38710694e+07  2.20e+02 6.25e-13  1.22e+04     0s
   3   1.02364245e+07  2.74922875e+06  1.75e+01 2.77e-13  8.10e+02     0s
   4   9.93887928e+06  7.66548533e+06  2.81e+00 7.67e-13  2.37e+02     0s
   5   9.85742570e+06  8.49664417e+06  1.09e+00 3.98e-13  1.41e+02     0s

Barrier performed 5 iterations in 0.21 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with primal simplex
Solved in 5243 iterations and 0.21 seconds
Optimal objective  9.767839080e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 9.77e+06
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


load


add_BESS_load
300


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 2.79s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-p1m2_sfv.lp
Reading time = 0.28 seconds
obj: 154248 rows, 73489 columns, 258595 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 154248 rows, 73489 columns and 258595 nonzeros
Model fingerprint: 0x358b1de3
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [1e+01, 8e+01]
  RHS range        [2e-02, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 142339 rows and 34888 columns
Presolve time: 0.16s
Presolved: 11909 rows, 38601 columns, 81187 nonzeros

Ordering time: 0.23s

Barrier statistics:
 AA' NZ     : 4.938e+04
 Factor NZ  : 7.300e+05 (roughly 26 MBytes of memory)
 Factor Ops : 1.329e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.74511345e+12 -2.06803204e+12  5.31e+04 1.37e+04  9.29e+08     1s
   1   3.69199871e+11 -1.19805884e+12  6.03e+03 2.11e-10  1.15e+08     1s
   2   2.97760958e+10 -3.78314573e+11  4.16e+02 2.04e-10  1.11e+07     1s
   3   8.54178455e+09 -4.56528644e+10  6.14e+01 3.23e-09  1.42e+06     1s
   4   4.69184484e+09 -1.70667780e+10  1.69e+01 9.75e-10  4.41e+05     1s
   5   1.56149281e+09 -6.41866364e+09  5.93e+00 2.33e-10  1.44e+05     1s
   6   7.48094218e+07 -1.05081430e+09  3.21e-01 2.33e-10  1.56e+04     1s
   7   3.73506107e+07 -4.55024276e+08  1.03e-01 1.07e-10  6.55e+03     1s
   8   1.93467708e+07 -1.46654521e+08  3.16e-02 7.79e-11  2.17e+03     1s
   9   1.16967565e+07 -4.25343934e+07  1.45e-02 1.07e-10  7.06e+02     1s
  10   7.65831226e+06 -2.97261962e+07  7.51e-03 4.88e-11  4.86e+02     1s
  11   5.30190812e+06 -9.15870818e+06  3.91e-03 3.75e-11  1.88e+02     1s
  12   3.93665280e+06 -3.59879329e+06  2.04e-03 2.36e-11  9.77e+01     1s
  13   3.16723307e+06  2.01071306e+05  1.11e-03 2.18e-11  3.84e+01     1s
  14   2.76905241e+06  9.81205079e+05  6.54e-04 2.91e-11  2.32e+01     1s
  15   2.52764372e+06  1.62022272e+06  3.95e-04 1.46e-11  1.18e+01     1s
  16   2.36315381e+06  1.81732009e+06  2.22e-04 1.46e-11  7.07e+00     1s
  17   2.25528756e+06  1.92858630e+06  1.12e-04 1.46e-11  4.23e+00     1s
  18   2.18125310e+06  2.02676501e+06  4.05e-05 1.46e-11  2.00e+00     1s
  19   2.16682234e+06  2.07422114e+06  2.77e-05 2.91e-11  1.20e+00     1s
  20   2.15594817e+06  2.10190907e+06  1.83e-05 2.18e-11  7.00e-01     1s
  21   2.14736205e+06  2.11948347e+06  1.12e-05 1.46e-11  3.61e-01     1s
  22   2.14292850e+06  2.12486971e+06  7.71e-06 1.46e-11  2.34e-01     1s
  23   2.13792415e+06  2.12771122e+06  3.91e-06 1.46e-11  1.32e-01     1s
  24   2.13710261e+06  2.12814289e+06  3.31e-06 2.18e-11  1.16e-01     1s
  25   2.13607140e+06  2.13075819e+06  2.56e-06 5.82e-11  6.88e-02     1s
  26   2.13470530e+06  2.13133684e+06  1.58e-06 2.91e-11  4.36e-02     1s
  27   2.13435139e+06  2.13142336e+06  1.33e-06 2.91e-11  3.79e-02     1s
  28   2.13371771e+06  2.13188577e+06  8.93e-07 2.91e-11  2.37e-02     1s
  29   2.13310001e+06  2.13205948e+06  4.65e-07 2.91e-11  1.35e-02     1s
  30   2.13278361e+06  2.13230188e+06  2.58e-07 5.82e-11  6.24e-03     1s
  31   2.13252305e+06  2.13236484e+06  8.03e-08 5.82e-11  2.05e-03     1s
  32   2.13242832e+06  2.13239325e+06  1.78e-08 2.91e-11  4.54e-04     1s
  33   2.13241161e+06  2.13239955e+06  2.28e-08 5.82e-11  1.56e-04     1s
  34   2.13240414e+06  2.13240159e+06  7.53e-08 5.82e-11  3.30e-05     1s
  35   2.13240217e+06  2.13240213e+06  3.47e-08 8.73e-11  6.09e-07     2s
  36   2.13240217e+06  2.13240217e+06  4.71e-09 2.91e-11  1.21e-08     2s
  37   2.13240217e+06  2.13240217e+06  1.54e-09 5.82e-11  2.92e-09     2s

Barrier solved model in 37 iterations and 1.59 seconds
Optimal objective 2.13240217e+06

Crossover log...

     877 DPushes remaining with DInf 0.0000000e+00                 2s
       0 DPushes remaining with DInf 0.0000000e+00                 2s

     713 PPushes remaining with PInf 8.0000000e-06                 2s
       0 PPushes remaining with PInf 1.0083333e-05                 2s

  Push phase complete: Pinf 1.0083333e-05, Dinf 3.8791702e-10      2s

Iteration    Objective       Primal Inf.    Dual Inf.      Time
    1593    2.1324022e+06   1.008333e-05   0.000000e+00      2s
Extra simplex iterations after uncrush: 23
    1625    2.1324022e+06   0.000000e+00   0.000000e+00      2s

Solved with barrier
Solved in 1625 iterations and 2.15 seconds
Optimal objective  2.132402168e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 2.13e+06
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.78s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-fei_dhoo.lp
Reading time = 0.11 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0x5f2a1b51
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [1e+01, 8e+01]
  RHS range        [2e-02, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57048 rows and 22025 columns
Presolve time: 0.07s
Presolved: 3936 rows, 4832 columns, 23606 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.833e+04
 Factor NZ  : 6.453e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.199e+06 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   3.70635823e+07 -1.07143457e+09  2.10e+04 5.68e-14  4.81e+05     0s
   1   1.89425728e+07 -5.14623853e+08  2.49e+03 1.71e-13  8.33e+04     0s
   2   1.59636096e+07 -7.09804111e+07  2.36e+02 5.12e-12  1.01e+04     0s
   3   1.50063664e+07  3.68226187e+06  2.81e+01 8.10e-13  1.23e+03     0s

Barrier performed 3 iterations in 0.20 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with primal simplex
Solved in 5094 iterations and 0.21 seconds
Optimal objective  1.452736518e+07
INFO:pypsa.linopf:Optimization successful. Objective value: 1.45e+07
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


load


add_BESS_load
300


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 2.77s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-e7pgiv00.lp
Reading time = 0.28 seconds
obj: 154248 rows, 73489 columns, 258595 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 154248 rows, 73489 columns and 258595 nonzeros
Model fingerprint: 0xecc6ff2e
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [1e+01, 8e+01]
  RHS range        [2e-02, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 142325 rows and 34714 columns
Presolve time: 0.15s
Presolved: 11923 rows, 38775 columns, 81375 nonzeros

Ordering time: 0.25s

Barrier statistics:
 AA' NZ     : 4.939e+04
 Factor NZ  : 7.450e+05 (roughly 26 MBytes of memory)
 Factor Ops : 1.353e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.74272634e+12 -2.01342971e+12  4.95e+04 1.13e+04  9.32e+08     1s
   1   3.69679845e+11 -1.19808133e+12  5.57e+03 2.46e-10  1.15e+08     1s
   2   3.12187238e+10 -3.80056345e+11  3.94e+02 2.33e-10  1.12e+07     1s
   3   8.90065885e+09 -4.28816766e+10  4.93e+01 4.80e-09  1.29e+06     1s
   4   5.48545434e+09 -1.63435410e+10  1.77e+01 1.63e-09  4.61e+05     1s
   5   2.30895241e+09 -6.77796710e+09  7.90e+00 4.15e-10  1.79e+05     1s
   6   1.18981678e+08 -1.59072106e+09  5.79e-01 1.63e-10  2.45e+04     1s
   7   2.60857601e+07 -6.51111131e+08  1.86e-02 1.15e-10  8.77e+03     1s
   8   2.22498465e+07 -3.04512904e+08  1.25e-02 7.15e-11  4.23e+03     1s
   9   1.50524607e+07 -6.59030162e+07  5.18e-03 7.15e-11  1.05e+03     1s
  10   9.33165067e+06 -2.26196803e+07  2.48e-03 5.70e-11  4.12e+02     1s
  11   5.28972144e+06 -8.18046256e+06  9.00e-04 2.91e-11  1.74e+02     1s
  12   3.68250182e+06 -4.49621373e+06  4.26e-04 2.18e-11  1.05e+02     1s
  13   2.74015481e+06 -9.59747579e+05  1.77e-04 2.18e-11  4.77e+01     1s
  14   2.37727874e+06  4.57891868e+05  9.15e-05 1.46e-11  2.48e+01     1s
  15   2.20188595e+06  9.50522999e+05  5.27e-05 1.46e-11  1.61e+01     1s
  16   2.10774687e+06  1.28968977e+06  3.34e-05 1.46e-11  1.05e+01     1s
  17   2.05749423e+06  1.68371409e+06  2.37e-05 1.46e-11  4.82e+00     1s
  18   1.95275132e+06  1.82871022e+06  5.00e-06 1.46e-11  1.60e+00     1s
  19   1.92753239e+06  1.88453257e+06  1.26e-06 2.91e-11  5.54e-01     1s
  20   1.92148955e+06  1.90385816e+06  5.71e-07 1.46e-11  2.27e-01     1s
  21   1.91858360e+06  1.91112018e+06  2.77e-07 2.91e-11  9.62e-02     1s
  22   1.91831297e+06  1.91243827e+06  2.50e-07 1.46e-11  7.58e-02     1s
  23   1.91751136e+06  1.91391101e+06  1.76e-07 2.91e-11  4.64e-02     1s
  24   1.91690301e+06  1.91444373e+06  1.22e-07 2.91e-11  3.17e-02     1s
  25   1.91663873e+06  1.91446169e+06  9.82e-08 2.91e-11  2.81e-02     1s
  26   1.91632752e+06  1.91515669e+06  7.05e-08 5.82e-11  1.51e-02     1s
  27   1.91616056e+06  1.91522070e+06  5.63e-08 5.82e-11  1.21e-02     1s
  28   1.91593352e+06  1.91523858e+06  4.20e-08 2.91e-11  8.96e-03     1s
  29   1.91585184e+06  1.91545312e+06  3.52e-08 5.82e-11  5.14e-03     1s
  30   1.91571742e+06  1.91546617e+06  4.77e-08 5.82e-11  3.24e-03     1s
  31   1.91569940e+06  1.91547647e+06  4.57e-08 2.91e-11  2.87e-03     1s
  32   1.91568041e+06  1.91549283e+06  4.72e-08 2.91e-11  2.42e-03     1s
  33   1.91565380e+06  1.91550161e+06  4.55e-08 2.91e-11  1.96e-03     1s
  34   1.91561623e+06  1.91550656e+06  5.00e-08 2.91e-11  1.41e-03     1s
  35   1.91559651e+06  1.91551150e+06  6.53e-08 2.91e-11  1.10e-03     1s
  36   1.91556354e+06  1.91551418e+06  1.67e-07 2.91e-11  6.37e-04     1s
  37   1.91555559e+06  1.91551613e+06  1.35e-07 2.91e-11  5.09e-04     1s
  38   1.91555187e+06  1.91551709e+06  1.20e-07 2.91e-11  4.48e-04     1s
  39   1.91553736e+06  1.91551823e+06  1.34e-07 5.82e-11  2.47e-04     1s
  40   1.91553373e+06  1.91551932e+06  1.04e-07 2.91e-11  1.86e-04     1s
  41   1.91552632e+06  1.91552043e+06  5.27e-08 5.82e-11  7.60e-05     1s
  42   1.91552590e+06  1.91552075e+06  2.58e-07 5.82e-11  6.65e-05     2s
  43   1.91552126e+06  1.91552082e+06  3.24e-06 5.82e-11  5.61e-06     2s
  44   1.91552102e+06  1.91552092e+06  9.98e-07 5.82e-11  1.24e-06     2s
  45   1.91552094e+06  1.91552093e+06  1.29e-07 8.73e-11  1.33e-07     2s
  46   1.91552094e+06  1.91552093e+06  1.40e-08 5.82e-11  1.52e-08     2s
  47   1.91552094e+06  1.91552093e+06  5.65e-09 5.82e-11  6.20e-09     2s

Barrier solved model in 47 iterations and 1.59 seconds
Optimal objective 1.91552094e+06

Crossover log...

    1415 DPushes remaining with DInf 0.0000000e+00                 2s
       0 DPushes remaining with DInf 0.0000000e+00                 2s

    1288 PPushes remaining with PInf 6.0000000e-06                 2s

Solved with dual simplex
Solved in 11654 iterations and 2.00 seconds
Optimal objective  1.915520935e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 1.92e+06
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.74s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-5myw0wde.lp
Reading time = 0.11 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0xa0eea359
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [1e+01, 8e+01]
  RHS range        [2e-02, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57048 rows and 22034 columns
Presolve time: 0.05s
Presolved: 3936 rows, 4823 columns, 23597 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.833e+04
 Factor NZ  : 6.453e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.199e+06 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   3.33627656e+07 -1.06944893e+09  1.91e+04 5.68e-14  4.48e+05     0s
   1   1.90027234e+07 -4.86588224e+08  2.33e+03 1.42e-13  7.80e+04     0s
   2   1.65576688e+07 -5.81537590e+07  2.02e+02 1.71e-13  8.65e+03     0s
   3   1.57414051e+07  4.76836298e+06  2.87e+01 1.14e-13  1.20e+03     0s
   4   1.54982514e+07  1.07380427e+07  7.98e+00 1.14e-13  5.03e+02     0s
   5   1.54166978e+07  1.28922538e+07  3.97e+00 1.14e-13  2.65e+02     0s
   6   1.53327881e+07  1.44610705e+07  1.18e+00 2.27e-13  9.08e+01     0s
   7   1.52873209e+07  1.49499629e+07  2.87e-01 5.68e-14  3.50e+01     0s
   8   1.52754651e+07  1.52380628e+07  1.90e-02 7.50e-14  3.88e+00     0s
   9   1.52740742e+07  1.52728051e+07  2.22e-04 5.68e-14  1.32e-01     0s
  10   1.52740246e+07  1.52740234e+07  8.75e-11 4.71e-14  1.32e-04     0s
  11   1.52740246e+07  1.52740246e+07  6.53e-11 5.68e-14  1.32e-10     0s

Barrier solved model in 11 iterations and 0.37 seconds
Optimal objective 1.52740246e+07

Crossover log...

      23 DPushes remaining with DInf 0.0000000e+00                 0s
       0 DPushes remaining with DInf 0.0000000e+00                 0s

     384 PPushes remaining with PInf 0.0000000e+00                 0s
       0 PPushes remaining with PInf 0.0000000e+00                 0s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.4909141e-10      0s

Iteration    Objective       Primal Inf.    Dual Inf.      Time
     410    1.5274025e+07   0.000000e+00   0.000000e+00      1s

Solved with barrier
Solved in 410 iterations and 0.65 seconds
Optimal objective  1.527402460e+07
INFO:pypsa.linopf:Optimization successful. Objective value: 1.53e+07
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


load


add_BESS_load
300


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 2.68s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-6_5lh78u.lp
Reading time = 0.28 seconds
obj: 154248 rows, 73489 columns, 258595 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 154248 rows, 73489 columns and 258595 nonzeros
Model fingerprint: 0x58dd18ff
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [1e+01, 8e+01]
  RHS range        [2e-02, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 142320 rows and 34376 columns
Presolve time: 0.13s
Presolved: 11928 rows, 39113 columns, 81718 nonzeros

Ordering time: 0.53s

Barrier statistics:
 AA' NZ     : 4.940e+04
 Factor NZ  : 7.082e+05 (roughly 26 MBytes of memory)
 Factor Ops : 1.222e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.74053155e+12 -2.04785916e+12  5.31e+04 1.14e+04  9.29e+08     1s
   1   3.74430491e+11 -1.19804222e+12  6.00e+03 2.14e-10  1.15e+08     1s
   2   3.12415987e+10 -3.78634991e+11  4.20e+02 2.04e-10  1.11e+07     1s
   3   8.66486685e+09 -4.47825726e+10  4.92e+01 4.07e-10  1.27e+06     1s
   4   5.61658485e+09 -1.67035798e+10  1.84e+01 2.91e-10  4.59e+05     1s
   5   3.11173510e+09 -7.91054245e+09  1.06e+01 4.37e-10  2.20e+05     1s
   6   4.55324358e+08 -2.37986459e+09  1.85e+00 1.59e-10  4.48e+04     1s
   7   2.60684513e+07 -8.22101488e+08  3.20e-03 1.30e-10  1.09e+04     1s
   8   2.16626441e+07 -3.62461696e+08  1.83e-03 8.61e-11  4.91e+03     1s
   9   1.63036638e+07 -7.42017778e+07  9.41e-04 7.15e-11  1.16e+03     1s
  10   9.72471398e+06 -2.77557701e+07  4.29e-04 5.70e-11  4.79e+02     1s
  11   4.00683834e+06 -9.57525637e+06  1.15e-04 2.42e-11  1.74e+02     1s
  12   2.71028594e+06 -4.41741643e+06  6.42e-05 2.91e-11  9.11e+01     1s
  13   1.79928613e+06 -1.97018086e+06  3.30e-05 2.91e-11  4.82e+01     1s
  14   1.44783109e+06 -7.92913468e+05  2.13e-05 2.18e-11  2.86e+01     1s
  15   1.09494735e+06  2.19848999e+05  1.02e-05 4.37e-11  1.12e+01     1s
  16   9.62936163e+05  4.99293513e+05  6.34e-06 1.46e-11  5.93e+00     1s
  17   8.66855691e+05  5.98162929e+05  3.77e-06 1.46e-11  3.43e+00     1s
  18   8.08670098e+05  6.64178995e+05  2.22e-06 2.91e-11  1.85e+00     1s
  19   7.51440036e+05  6.96457273e+05  7.61e-07 2.91e-11  7.03e-01     1s
  20   7.35303271e+05  7.09130069e+05  3.67e-07 1.46e-11  3.35e-01     1s
  21   7.26870885e+05  7.14989487e+05  1.69e-07 1.46e-11  1.52e-01     1s
  22   7.22713324e+05  7.17859654e+05  7.44e-08 2.91e-11  6.20e-02     1s
  23   7.21223461e+05  7.18651828e+05  4.15e-08 2.91e-11  3.29e-02     2s
  24   7.20518984e+05  7.19008051e+05  2.66e-08 5.82e-11  1.93e-02     2s
  25   7.19964331e+05  7.19122794e+05  5.39e-08 5.82e-11  1.08e-02     2s
  26   7.19618217e+05  7.19185486e+05  2.06e-07 2.91e-11  5.53e-03     2s
  27   7.19531977e+05  7.19210111e+05  1.76e-07 5.82e-11  4.11e-03     2s
  28   7.19395948e+05  7.19225036e+05  3.70e-07 2.91e-11  2.18e-03     2s
  29   7.19338103e+05  7.19228174e+05  3.99e-07 2.91e-11  1.41e-03     2s
  30   7.19298118e+05  7.19234505e+05  6.58e-07 5.82e-11  8.13e-04     2s
  31   7.19268138e+05  7.19237351e+05  3.39e-07 2.91e-11  3.94e-04     2s
  32   7.19265683e+05  7.19238917e+05  5.35e-07 5.82e-11  3.42e-04     2s
  33   7.19251881e+05  7.19239886e+05  8.25e-07 5.82e-11  1.53e-04     2s
  34   7.19243985e+05  7.19239971e+05  2.54e-07 5.82e-11  5.13e-05     2s
  35   7.19240869e+05  7.19240042e+05  1.56e-06 5.82e-11  1.06e-05     2s
  36   7.19240261e+05  7.19240233e+05  5.26e-08 5.82e-11  3.61e-07     2s
  37   7.19240244e+05  7.19240238e+05  1.26e-08 5.82e-11  7.82e-08     2s
  38   7.19240240e+05  7.19240239e+05  5.67e-09 5.82e-11  1.74e-08     2s
  39   7.19240239e+05  7.19240239e+05  3.11e-09 2.91e-11  6.98e-10     2s

Barrier solved model in 39 iterations and 1.89 seconds
Optimal objective 7.19240239e+05

Crossover log...

     805 DPushes remaining with DInf 0.0000000e+00                 2s
       0 DPushes remaining with DInf 0.0000000e+00                 2s

     882 PPushes remaining with PInf 1.2000000e-05                 2s

Solved with dual simplex
Solved in 11233 iterations and 2.07 seconds
Optimal objective  7.192402392e+05
INFO:pypsa.linopf:Optimization successful. Objective value: 7.19e+05
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.78s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-ljhy8384.lp
Reading time = 0.11 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0xa8b190c5
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [1e+01, 7e+01]
  RHS range        [2e-02, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57050 rows and 22005 columns
Presolve time: 0.05s
Presolved: 3934 rows, 4852 columns, 23624 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.832e+04
 Factor NZ  : 6.454e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.200e+06 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   4.26053452e+07 -8.93351775e+08  2.26e+04 5.68e-14  4.63e+05     0s
   1   1.54567270e+07 -4.76562742e+08  2.40e+03 1.56e-13  7.74e+04     0s
   2   1.13142046e+07 -8.61313611e+07  2.09e+02 9.95e-14  1.11e+04     0s
   3   1.02212798e+07 -6.46877784e+06  2.24e+01 1.14e-13  1.77e+03     0s
   4   1.00649732e+07  3.83938435e+06  1.16e+01 1.14e-13  6.54e+02     0s
   5   9.86605033e+06  8.02466894e+06  3.36e+00 8.53e-14  1.91e+02     0s
   6   9.75821973e+06  9.01606767e+06  1.19e+00 1.99e-13  7.68e+01     0s

Barrier performed 6 iterations in 0.19 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with primal simplex
Solved in 5113 iterations and 0.20 seconds
Optimal objective  9.655804231e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 9.66e+06
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


load


add_BESS_load
300


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 2.77s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-8pi742vu.lp
Reading time = 0.29 seconds
obj: 154248 rows, 73489 columns, 258595 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 154248 rows, 73489 columns and 258595 nonzeros
Model fingerprint: 0xbd6593c4
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [1e+01, 7e+01]
  RHS range        [2e-02, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 142322 rows and 33781 columns
Presolve time: 0.15s
Presolved: 11926 rows, 39708 columns, 82311 nonzeros

Ordering time: 0.35s

Barrier statistics:
 AA' NZ     : 4.940e+04
 Factor NZ  : 7.439e+05 (roughly 27 MBytes of memory)
 Factor Ops : 1.346e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.73352043e+12 -1.99424795e+12  5.32e+04 1.37e+04  9.29e+08     1s
   1   3.81378451e+11 -1.19799363e+12  6.04e+03 2.70e+02  1.15e+08     1s
   2   3.09954724e+10 -3.80444275e+11  4.19e+02 1.75e-10  1.11e+07     1s
   3   8.49219555e+09 -4.61177088e+10  5.32e+01 2.33e-10  1.32e+06     1s
   4   4.93232602e+09 -1.74431401e+10  1.62e+01 2.91e-10  4.34e+05     1s
   5   1.76878723e+09 -7.22139191e+09  6.18e+00 2.62e-10  1.57e+05     1s
   6   9.86154340e+07 -1.38730937e+09  3.82e-01 2.04e-10  2.00e+04     1s
   7   6.31081833e+07 -6.02991892e+08  2.01e-01 1.36e-10  8.75e+03     1s
   8   4.66001694e+07 -2.57641311e+08  1.30e-01 1.18e-10  3.96e+03     1s
   9   2.40899633e+07 -8.83594962e+07  4.99e-02 1.18e-10  1.44e+03     1s
  10   1.46165944e+07 -4.58710166e+07  2.45e-02 8.84e-11  7.69e+02     1s
  11   9.36970392e+06 -2.30672738e+07  1.23e-02 5.93e-11  4.11e+02     1s
  12   7.05582427e+06 -1.23136456e+07  7.57e-03 4.48e-11  2.45e+02     1s
  13   5.70001060e+06 -3.36180130e+06  4.99e-03 4.48e-11  1.14e+02     1s
  14   4.69589724e+06 -1.48878882e+06  3.24e-03 2.91e-11  7.80e+01     1s
  15   3.94982264e+06  2.25995724e+05  2.01e-03 3.02e-11  4.69e+01     1s
  16   3.52977061e+06  1.25727686e+06  1.32e-03 1.57e-11  2.86e+01     1s
  17   3.22282153e+06  1.71566225e+06  8.41e-04 1.46e-11  1.90e+01     1s
  18   2.89156015e+06  2.12312448e+06  3.28e-04 1.46e-11  9.68e+00     1s
  19   2.80832672e+06  2.38889798e+06  2.08e-04 2.18e-11  5.28e+00     1s
  20   2.75091873e+06  2.52713933e+06  1.29e-04 1.46e-11  2.82e+00     1s
  21   2.70522364e+06  2.61119932e+06  6.98e-05 2.91e-11  1.18e+00     1s
  22   2.67197443e+06  2.63154381e+06  2.95e-05 2.18e-11  5.09e-01     1s
  23   2.65829011e+06  2.63678718e+06  1.31e-05 1.46e-11  2.71e-01     1s
  24   2.65224995e+06  2.64354169e+06  6.31e-06 1.46e-11  1.10e-01     1s
  25   2.64963389e+06  2.64477781e+06  3.50e-06 1.46e-11  6.12e-02     1s
  26   2.64739600e+06  2.64558877e+06  1.17e-06 2.91e-11  2.28e-02     1s
  27   2.64673794e+06  2.64589245e+06  5.08e-07 2.91e-11  1.06e-02     1s
  28   2.64630030e+06  2.64612783e+06  7.26e-08 5.82e-11  2.17e-03     1s
  29   2.64625347e+06  2.64616543e+06  5.06e-08 2.91e-11  1.11e-03     1s
  30   2.64621946e+06  2.64620362e+06  4.17e-08 5.82e-11  2.00e-04     2s
  31   2.64621417e+06  2.64620860e+06  6.24e-08 5.82e-11  7.02e-05     2s
  32   2.64621211e+06  2.64621096e+06  1.36e-06 5.82e-11  1.45e-05     2s
  33   2.64621127e+06  2.64621112e+06  1.81e-07 5.82e-11  1.90e-06     2s
  34   2.64621115e+06  2.64621114e+06  1.46e-08 5.82e-11  1.00e-07     2s
  35   2.64621114e+06  2.64621114e+06  1.46e-09 8.73e-11  9.55e-09     2s

Barrier solved model in 35 iterations and 1.77 seconds
Optimal objective 2.64621114e+06

Crossover log...

    1781 DPushes remaining with DInf 0.0000000e+00                 2s
       0 DPushes remaining with DInf 0.0000000e+00                 2s

     626 PPushes remaining with PInf 1.1000000e-05                 2s
       0 PPushes remaining with PInf 4.7000000e-05                 2s

  Push phase complete: Pinf 4.7000000e-05, Dinf 2.4877213e-10      2s

Iteration    Objective       Primal Inf.    Dual Inf.      Time
    2410    2.6462111e+06   4.900000e-05   0.000000e+00      2s
Extra simplex iterations after uncrush: 71
    2505    2.6462111e+06   0.000000e+00   0.000000e+00      3s

Solved with barrier
Solved in 2505 iterations and 2.51 seconds
Optimal objective  2.646211143e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 2.65e+06
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.78s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-q_iqgaly.lp
Reading time = 0.11 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0x7824a36f
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [7e+00, 6e+01]
  RHS range        [1e-02, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57055 rows and 22028 columns
Presolve time: 0.07s
Presolved: 3929 rows, 4829 columns, 23596 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.832e+04
 Factor NZ  : 6.445e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.198e+06 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   2.93293373e+07 -1.09157107e+09  2.13e+04 5.68e-14  5.39e+05     0s
   1   1.16540547e+07 -5.65750036e+08  2.15e+03 1.42e-13  8.85e+04     0s
   2   8.79254805e+06 -8.77578957e+07  2.07e+02 1.14e-13  1.11e+04     0s
   3   7.93506215e+06  7.51264162e+05  1.65e+01 8.30e-12  7.77e+02     0s
   4   7.69840702e+06  6.04036545e+06  2.83e+00 4.38e-12  1.74e+02     0s
   5   7.62255833e+06  6.95032059e+06  1.01e+00 1.71e-12  7.00e+01     0s
   6   7.59353401e+06  7.35042431e+06  5.03e-01 5.68e-13  2.53e+01     0s
   7   7.56800514e+06  7.46559501e+06  1.50e-01 2.15e-13  1.06e+01     0s
   8   7.55797307e+06  7.52857383e+06  2.23e-02 5.91e-14  3.05e+00     0s
   9   7.55668813e+06  7.54634213e+06  1.03e-02 2.84e-14  1.07e+00     0s
  10   7.55580523e+06  7.55512439e+06  1.08e-03 2.88e-14  7.06e-02     0s
  11   7.55569111e+06  7.55565201e+06  7.68e-05 3.09e-14  4.06e-03     0s
  12   7.55568216e+06  7.55568212e+06  3.20e-09 2.84e-14  4.06e-06     0s
  13   7.55568215e+06  7.55568215e+06  7.10e-09 5.68e-14  4.06e-09     0s

Barrier solved model in 13 iterations and 0.20 seconds
Optimal objective 7.55568215e+06

Crossover log...


Solved with primal simplex
Solved in 5261 iterations and 0.21 seconds
Optimal objective  7.555682149e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 7.56e+06
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


load


add_BESS_load
300


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 2.81s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-0cz3er3u.lp
Reading time = 0.29 seconds
obj: 154248 rows, 73489 columns, 258595 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 154248 rows, 73489 columns and 258595 nonzeros
Model fingerprint: 0x3d32df1c
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [7e+00, 6e+01]
  RHS range        [1e-02, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 142336 rows and 33529 columns
Presolve time: 0.15s
Presolved: 11912 rows, 39960 columns, 82549 nonzeros

Ordering time: 0.31s

Barrier statistics:
 AA' NZ     : 4.938e+04
 Factor NZ  : 7.349e+05 (roughly 27 MBytes of memory)
 Factor Ops : 1.329e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.25293834e+12 -2.03191822e+12  3.75e+04 1.37e+04  6.64e+08     1s
   1   2.86523181e+11 -1.13558027e+12  4.43e+03 6.09e+03  8.73e+07     1s
   2   3.31721860e+10 -3.16542447e+11  4.31e+02 2.04e-10  1.03e+07     1s
   3   8.67965647e+09 -4.59337909e+10  5.94e+01 2.04e-10  1.40e+06     1s
   4   4.97862845e+09 -1.75433426e+10  1.77e+01 2.33e-10  4.52e+05     1s
   5   2.83351871e+09 -8.19891442e+09  1.03e+01 1.46e-10  2.14e+05     1s
   6   4.30812831e+08 -3.01143712e+09  1.72e+00 1.36e-10  5.17e+04     1s
   7   2.71392983e+07 -9.77393304e+08  1.39e-03 1.18e-10  1.26e+04     1s
   8   2.44792829e+07 -4.14129751e+08  9.95e-04 1.07e-10  5.49e+03     1s
   9   1.82184909e+07 -1.25360625e+08  4.35e-04 8.19e-11  1.80e+03     1s
  10   1.38608070e+07 -5.52127722e+07  2.48e-04 5.93e-11  8.64e+02     1s
  11   8.70658233e+06 -2.87111475e+07  8.83e-05 5.28e-11  4.68e+02     1s
  12   7.06961790e+06 -1.33787909e+07  5.69e-05 3.09e-11  2.56e+02     1s
  13   5.74997132e+06 -5.14551834e+06  3.64e-05 2.00e-11  1.36e+02     1s
  14   5.02869743e+06 -2.60897914e+06  2.62e-05 1.64e-11  9.56e+01     1s
  15   4.68893120e+06 -4.15740971e+05  2.19e-05 2.91e-11  6.39e+01     1s
  16   4.20692465e+06  5.57658204e+05  1.55e-05 2.91e-11  4.57e+01     1s
  17   3.99396283e+06  1.43539968e+06  1.31e-05 2.91e-11  3.20e+01     1s
  18   3.58415057e+06  1.92380520e+06  7.72e-06 1.46e-11  2.08e+01     1s
  19   3.50400779e+06  2.26800465e+06  6.87e-06 1.46e-11  1.55e+01     1s
  20   3.37174461e+06  2.36335904e+06  5.19e-06 1.46e-11  1.26e+01     1s
  21   3.28542031e+06  2.62342708e+06  4.13e-06 1.46e-11  8.28e+00     1s
  22   3.21677811e+06  2.72277904e+06  3.25e-06 1.46e-11  6.18e+00     1s
  23   3.13326314e+06  2.78184859e+06  2.30e-06 1.46e-11  4.40e+00     1s
  24   3.12664244e+06  2.83227809e+06  2.21e-06 2.91e-11  3.68e+00     1s
  25   3.02181106e+06  2.86507699e+06  1.05e-06 1.46e-11  1.96e+00     1s
  26   2.98680575e+06  2.89922891e+06  6.14e-07 1.46e-11  1.10e+00     1s
  27   2.96636141e+06  2.92270613e+06  3.71e-07 1.46e-11  5.46e-01     1s
  28   2.95707040e+06  2.92643959e+06  2.62e-07 1.46e-11  3.83e-01     1s
  29   2.94891315e+06  2.92960016e+06  1.67e-07 2.18e-11  2.42e-01     1s
  30   2.94400036e+06  2.93097579e+06  1.11e-07 1.46e-11  1.63e-01     1s
  31   2.94235074e+06  2.93194056e+06  9.30e-08 1.46e-11  1.30e-01     1s
  32   2.93915963e+06  2.93275313e+06  5.72e-08 1.46e-11  8.02e-02     1s
  33   2.93716785e+06  2.93314045e+06  3.59e-08 1.46e-11  5.04e-02     1s
  34   2.93501758e+06  2.93342535e+06  1.58e-08 2.91e-11  1.99e-02     1s
  35   2.93431645e+06  2.93366451e+06  7.31e-08 2.91e-11  8.16e-03     1s
  36   2.93404319e+06  2.93385612e+06  2.16e-08 1.46e-11  2.34e-03     1s
  37   2.93398784e+06  2.93388058e+06  2.01e-07 1.46e-11  1.34e-03     2s
  38   2.93393562e+06  2.93390567e+06  4.95e-08 5.82e-11  3.75e-04     2s
  39   2.93391611e+06  2.93391301e+06  3.13e-08 5.82e-11  3.89e-05     2s
  40   2.93391461e+06  2.93391391e+06  3.40e-08 2.91e-11  8.77e-06     2s
  41   2.93391430e+06  2.93391413e+06  8.44e-09 5.82e-11  2.14e-06     2s
  42   2.93391422e+06  2.93391417e+06  2.67e-09 5.82e-11  6.04e-07     2s
  43   2.93391418e+06  2.93391418e+06  1.69e-09 5.82e-11  1.10e-07     2s
  44   2.93391418e+06  2.93391418e+06  4.74e-09 5.82e-11  1.27e-08     2s
  45   2.93391418e+06  2.93391418e+06  1.59e-07 2.91e-11  4.23e-09     2s

Barrier solved model in 45 iterations and 1.79 seconds
Optimal objective 2.93391418e+06

Crossover log...

    1517 DPushes remaining with DInf 0.0000000e+00                 2s
       0 DPushes remaining with DInf 0.0000000e+00                 2s

     682 PPushes remaining with PInf 5.5000000e-05                 2s
       0 PPushes remaining with PInf 5.9000000e-05                 2s

  Push phase complete: Pinf 5.9000000e-05, Dinf 3.8492215e-10      2s

Iteration    Objective       Primal Inf.    Dual Inf.      Time
    2202    2.9339142e+06   4.700000e-05   0.000000e+00      2s
Extra simplex iterations after uncrush: 78
    2303    2.9339142e+06   0.000000e+00   0.000000e+00      2s

Solved with barrier
Solved in 2303 iterations and 2.39 seconds
Optimal objective  2.933914177e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 2.93e+06
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.79s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-fujpvwpw.lp
Reading time = 0.11 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0xc9319f98
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [3e+00, 4e+01]
  RHS range        [7e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57049 rows and 22023 columns
Presolve time: 0.08s
Presolved: 3935 rows, 4834 columns, 23607 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.832e+04
 Factor NZ  : 6.452e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.199e+06 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   3.83535854e+07 -1.05658426e+09  1.91e+04 5.68e-14  4.82e+05     0s
   1   1.92049639e+07 -5.14475991e+08  2.28e+03 1.42e-13  8.40e+04     0s
   2   1.60970311e+07 -7.10410155e+07  2.09e+02 1.28e-13  1.01e+04     0s
   3   1.51211598e+07  3.02048898e+06  2.44e+01 3.41e-13  1.31e+03     0s
   4   1.47978318e+07  1.13790790e+07  3.17e+00 5.12e-13  3.57e+02     0s

Barrier performed 4 iterations in 0.21 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with primal simplex
Solved in 5186 iterations and 0.22 seconds
Optimal objective  1.458351228e+07
INFO:pypsa.linopf:Optimization successful. Objective value: 1.46e+07
solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


load


add_BESS_load
300


INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 2.69s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-ji5n9orc.lp
Reading time = 0.27 seconds
obj: 154248 rows, 73489 columns, 258595 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 154248 rows, 73489 columns and 258595 nonzeros
Model fingerprint: 0x0c7b6680
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e+00, 8e+03]
  Bounds range     [3e+00, 4e+01]
  RHS range        [7e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 142322 rows and 33702 columns
Presolve time: 0.15s
Presolved: 11926 rows, 39787 columns, 82390 nonzeros

Ordering time: 0.59s

Barrier statistics:
 AA' NZ     : 4.940e+04
 Factor NZ  : 7.257e+05 (roughly 27 MBytes of memory)
 Factor Ops : 1.275e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.73894263e+12 -2.02025048e+12  5.31e+04 1.26e+04  9.29e+08     1s
   1   3.77138080e+11 -1.19587428e+12  5.81e+03 5.77e+02  1.11e+08     1s
   2   3.13323672e+10 -3.68314170e+11  4.13e+02 2.04e-10  1.08e+07     1s
   3   8.61446908e+09 -4.32262331e+10  5.32e+01 5.82e-10  1.30e+06     1s
   4   5.22512987e+09 -1.64757100e+10  1.74e+01 5.53e-10  4.44e+05     1s
   5   2.24009406e+09 -6.96796430e+09  7.81e+00 3.49e-10  1.76e+05     1s
   6   1.38141502e+08 -1.46912611e+09  6.14e-01 2.17e-10  2.28e+04     2s
   7   7.43052602e+07 -6.32362414e+08  2.83e-01 1.30e-10  9.53e+03     2s
   8   5.25763446e+07 -2.57772238e+08  1.83e-01 1.01e-10  4.14e+03     2s
   9   1.37576418e+07 -8.20836186e+07  2.11e-02 1.30e-10  1.22e+03     2s
  10   9.13591935e+06 -3.13130656e+07  1.08e-02 1.01e-10  5.13e+02     2s
  11   5.17449037e+06 -1.01090712e+07  4.14e-03 1.30e-10  1.93e+02     2s
  12   3.69554411e+06 -3.92409349e+06  2.20e-03 5.70e-11  9.60e+01     2s
  13   2.59190805e+06 -1.77071292e+05  9.51e-04 3.51e-11  3.48e+01     2s
  14   2.11540303e+06  5.26903194e+05  4.53e-04 1.69e-11  2.00e+01     2s
  15   1.88195822e+06  1.11092647e+06  2.25e-04 1.46e-11  9.69e+00     2s
  16   1.76277479e+06  1.32296276e+06  1.17e-04 1.46e-11  5.53e+00     2s
  17   1.69541785e+06  1.47754207e+06  5.90e-05 1.46e-11  2.74e+00     2s
  18   1.65088493e+06  1.54599563e+06  2.44e-05 1.46e-11  1.32e+00     2s
  19   1.63089432e+06  1.57959460e+06  1.00e-05 1.46e-11  6.45e-01     2s
  20   1.62183722e+06  1.59884452e+06  4.27e-06 1.46e-11  2.89e-01     2s
  21   1.61733202e+06  1.60747006e+06  1.73e-06 1.46e-11  1.24e-01     2s
  22   1.61544359e+06  1.61099775e+06  7.80e-07 2.18e-11  5.59e-02     2s
  23   1.61449880e+06  1.61258776e+06  3.30e-07 1.46e-11  2.40e-02     2s
  24   1.61384347e+06  1.61348241e+06  4.72e-08 5.82e-11  4.54e-03     2s
  25   1.61376973e+06  1.61366114e+06  1.49e-08 2.91e-11  1.36e-03     2s
  26   1.61374350e+06  1.61371872e+06  2.62e-08 5.82e-11  3.11e-04     2s
  27   1.61373762e+06  1.61372877e+06  5.26e-08 2.91e-11  1.11e-04     3s
  28   1.61373638e+06  1.61373380e+06  1.39e-08 2.91e-11  3.25e-05     3s
  29   1.61373600e+06  1.61373508e+06  6.15e-07 2.91e-11  1.16e-05     3s
  30   1.61373591e+06  1.61373590e+06  3.75e-08 5.82e-11  1.29e-07     3s
  31   1.61373591e+06  1.61373591e+06  1.44e-08 5.82e-11  3.67e-08     3s
  32   1.61373591e+06  1.61373591e+06  2.92e-09 5.82e-11  6.05e-09     3s

Barrier solved model in 32 iterations and 2.74 seconds
Optimal objective 1.61373591e+06

Crossover log...

    1805 DPushes remaining with DInf 0.0000000e+00                 3s
       0 DPushes remaining with DInf 0.0000000e+00                 3s

     612 PPushes remaining with PInf 1.8000000e-05                 3s
       0 PPushes remaining with PInf 4.3000000e-05                 3s

  Push phase complete: Pinf 4.3000000e-05, Dinf 6.7766728e-10      3s

Iteration    Objective       Primal Inf.    Dual Inf.      Time
    2420    1.6137359e+06   3.200000e-05   0.000000e+00      3s
Extra simplex iterations after uncrush: 26
    2457    1.6137359e+06   0.000000e+00   0.000000e+00      3s

Solved with barrier
Solved in 2457 iterations and 3.40 seconds
Optimal objective  1.613735908e+06
INFO:pypsa.linopf:Optimization successful. Objective value: 1.61e+06
INFO:pypsa.io:Exported network elec_s300_200_ec_lcopt_1H-noex_bat_load.nc has lines, carriers, generators, stores, buses, links, storage_units, loads
carrier
CCGT          18120.910000
OCGT           8044.269704
biomass         839.020000
coal          28069.379795
lignite       20833.500000
nuclear       15788.438693
offwind-ac     1125.369769
offwind-dc     3359.069844
oil            3696.400000
onwind        47837.387673
ror            2907.579410
solar         43394.372511
Name: p_nom, dtype: float64
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 0.78s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
Read LP format model from file /scratch/169895071.tmpdir/pypsa-problem-swjqi5h6.lp
Reading time = 0.11 seconds
obj: 60984 rows, 26857 columns, 109299 nonzeros
Gurobi Optimizer version 9.1.1 build v9.1.1rc0 (linux64)
Thread count: 128 physical cores, 128 logical processors, using up to 32 threads
Optimize a model with 60984 rows, 26857 columns and 109299 nonzeros
Model fingerprint: 0x8a0005e1
Coefficient statistics:
  Matrix range     [3e-01, 5e+01]
  Objective range  [1e-02, 1e+02]
  Bounds range     [2e+00, 1e+01]
  RHS range        [4e-03, 2e+05]

Concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Presolve removed 57098 rows and 22090 columns
Presolve time: 0.05s
Presolved: 3886 rows, 4767 columns, 23491 nonzeros

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.828e+04
 Factor NZ  : 6.435e+04 (roughly 4 MBytes of memory)
 Factor Ops : 1.205e+06 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   3.69142037e+07 -1.95162591e+09  1.25e+04 1.54e+00  6.07e+05     0s

Barrier performed 0 iterations in 0.19 seconds
Barrier solve interrupted - model solved by another algorithm


Solved with dual simplex
Solved in 2756 iterations and 0.21 seconds
Optimal objective  2.143996066e+07
INFO:pypsa.linopf:Optimization successful. Objective value: 2.14e+07
solve_redispatch_network.py:711: DeprecationWarning:

The default dtype for empty Series will be 'object' instead of 'float64' in a future version. Specify a dtype explicitly to silence this warning.

solve_redispatch_network_with_bat
300


build_redispatch_network_with_bat
300


300


supply


Traceback (most recent call last):
  File "solve_redispatch_network.py", line 799, in <module>
    main()
  File "solve_redispatch_network.py", line 797, in main
    solve_redispatch_workflow()
  File "solve_redispatch_network.py", line 785, in solve_redispatch_workflow
    n_d_bat_supply, n_rd_bat_supply = redispatch_workflow(network = n, network_optim = n_optim, storage_ops= "supply", flex_potential = flex_potential,
  File "solve_redispatch_network.py", line 707, in redispatch_workflow
    n_redispatch = solve_redispatch_network_with_bat(network = n_24, network_dispatch = n_dispatch, network_year = network_year,
  File "solve_redispatch_network.py", line 583, in solve_redispatch_network_with_bat
    network_redispatch_bat = build_redispatch_network_with_bat(network = network, network_dispatch = network_dispatch,
  File "solve_redispatch_network.py", line 565, in build_redispatch_network_with_bat
    add_BESS_supply(network_redispatch_bat, network_year, start_hour=start_hour, start_hour_0=start_hour_0,
TypeError: add_BESS_supply() missing 1 required positional argument: 'lcos'
